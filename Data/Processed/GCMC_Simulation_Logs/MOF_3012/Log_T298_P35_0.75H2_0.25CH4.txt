LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 75.0% H₂ / 25.0% CH₄ at 35 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (18.6051 18.6051 37.384)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  512 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.504631 4.008000  # Al
pair_coeff 2 2 0.104924 3.431000  # C
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.304777 3.695000  # P

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
512 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.939543
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.939543 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -1.6e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.24279831
  grid = 12 12 20
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0024755013
  estimated relative force accuracy = 7.4548985e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2964 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.69 | 6.695 | 6.706 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            49899122       453.91179      0              0              12940.462    
      5000   306.18992      49899103       466.38664      8              6              12940.462    
     10000   309.80149      49899107       471.88775      12             8              12940.462    
     15000   314.64344      49899107       479.26297      18             14             12940.462    
     20000   322.75219      49899101       491.61417      28             17             12940.462    
     25000   325.28518      49899086       495.47242      31             18             12940.462    
     30000   326.67512      49899089       497.58956      31             20             12940.462    
     35000   330.69987      49899084       503.72003      38             20             12940.462    
     40000   333.5395       49899090       508.04534      40             23             12940.462    
     45000   335.2896       49899077       510.71108      41             25             12940.462    
     50000   337.418        49899071       513.95305      46             27             12940.462    
     55000   338.96314      49899072       516.3066       49             27             12940.462    
     60000   340.67329      49899065       518.91149      49             29             12940.462    
     65000   344.50272      49899065       524.74445      53             31             12940.462    
     70000   348.3884       49899060       530.6631       58             35             12940.462    
     75000   350.49772      49899055       533.876        59             36             12940.462    
     80000   350.15205      49899051       533.34949      60             35             12940.462    
     85000   351.69882      49899048       535.70551      62             37             12940.462    
     90000   353.27516      49899053       538.10659      66             37             12940.462    
     95000   352.89781      49899047       537.53181      66             36             12940.462    
    100000   357.1391       49899057       543.99211      72             36             12940.462    
Loop time of 52.0407 on 8 procs for 100000 steps with 620 atoms

Performance: 166.024 ns/day, 0.145 hours/ns, 1921.572 timesteps/s, 1.191 Matom-step/s
88.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 17.895     | 19.834     | 21.059     |  23.6 | 38.11
Bond    | 0.0041069  | 0.0043767  | 0.0047376  |   0.3 |  0.01
Kspace  | 16.736     | 17.84      | 19.868     |  24.8 | 34.28
Neigh   | 0.072366   | 0.076608   | 0.080084   |   1.0 |  0.15
Comm    | 10.427     | 10.737     | 11.012     |   5.3 | 20.63
Output  | 0.00069461 | 0.00075638 | 0.0010683  |   0.0 |  0.00
Modify  | 2.1529     | 2.1538     | 2.1545     |   0.0 |  4.14
Other   |            | 1.395      |            |       |  2.68

Nlocal:           77.5 ave          80 max          73 min
Histogram: 1 0 2 0 0 0 0 0 3 2
Nghost:           3015 ave        3019 max        3013 min
Histogram: 3 2 0 0 0 0 2 0 0 1
Neighs:        21064.5 ave       22984 max       19935 min
Histogram: 1 2 2 0 0 1 1 0 0 1

Total # of neighbors = 168516
Ave neighs/atom = 271.8
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.24279815
  grid = 12 12 20
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0022495922
  estimated relative force accuracy = 6.7745801e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2964 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.822 | 6.826 | 6.837 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   294.82727      49899057       543.99211      72             36             12940.462    
    105000   295.05365      49899050       544.4098       72             36             12940.462    
    110000   297.63609      49899049       549.17473      74             37             12940.462    
    115000   298.35276      49899050       550.49708      75             37             12940.462    
    120000   300.93539      49899054       555.26233      77             38             12940.462    
    125000   302.64578      49899065       558.41821      81             39             12940.462    
    130000   303.64561      49899066       560.26302      82             40             12940.462    
    135000   303.38061      49899063       559.77406      82             40             12940.462    
    140000   304.44109      49899057       561.73077      83             41             12940.462    
    145000   304.79001      49899057       562.37457      85             41             12940.462    
    150000   305.21571      49899061       563.16004      86             41             12940.462    
    155000   305.21571      49899061       563.16004      86             41             12940.462    
    160000   306.41613      49899058       565.37496      87             42             12940.462    
    165000   306.98754      49899057       566.42929      88             43             12940.462    
    170000   309.38951      49899069       570.86122      93             44             12940.462    
    175000   310.74396      49899066       573.36034      96             44             12940.462    
    180000   310.96699      49899065       573.77185      96             44             12940.462    
    185000   310.27521      49899054       572.49544      94             44             12940.462    
    190000   310.5655       49899055       573.03105      95             44             12940.462    
    195000   310.2548       49899051       572.45777      95             44             12940.462    
    200000   311.04218      49899056       573.91058      97             44             12940.462    
Loop time of 59.7936 on 8 procs for 100000 steps with 653 atoms

Performance: 144.497 ns/day, 0.166 hours/ns, 1672.419 timesteps/s, 1.092 Matom-step/s
89.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.739     | 25.54      | 27.438     |  22.2 | 42.71
Bond    | 0.0042126  | 0.0045943  | 0.0049686  |   0.4 |  0.01
Kspace  | 16.872     | 18.718     | 20.495     |  25.1 | 31.30
Neigh   | 0.090208   | 0.093843   | 0.097419   |   0.9 |  0.16
Comm    | 11.328     | 11.45      | 11.643     |   2.9 | 19.15
Output  | 0.00064127 | 0.00071298 | 0.0010333  |   0.0 |  0.00
Modify  | 2.5397     | 2.5407     | 2.5415     |   0.0 |  4.25
Other   |            | 1.447      |            |       |  2.42

Nlocal:         81.625 ave          86 max          78 min
Histogram: 1 1 1 1 0 1 1 1 0 1
Nghost:        3174.88 ave        3178 max        3171 min
Histogram: 1 0 2 0 0 2 0 1 0 2
Neighs:        23413.4 ave       25156 max       21763 min
Histogram: 1 1 1 0 1 1 1 0 0 2

Total # of neighbors = 187307
Ave neighs/atom = 286.84074
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 97
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 44
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:51
