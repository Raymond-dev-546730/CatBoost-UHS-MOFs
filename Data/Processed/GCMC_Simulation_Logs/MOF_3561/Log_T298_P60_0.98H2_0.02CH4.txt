LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (19.519 19.519 49.1068)
  2 by 1 by 4 MPI processor grid
  reading atoms ...
  436 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.012996 2.594000  # Fe
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.068956 3.261000  # N
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
436 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23873088
  grid = 12 12 24
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0017191874
  estimated relative force accuracy = 5.1772819e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2717 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 8
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.647 | 6.647 | 6.648 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            47461813       386.40241      0              0              18709.267    
      5000   306.74187      47461805       397.73758      8              5              18709.267    
     10000   315.81966      47461795       409.50831      17             12             18709.267    
     15000   317.51796      47461789       411.71041      20             15             18709.267    
     20000   331.43234      47461787       429.75253      31             23             18709.267    
     25000   337.57257      47461797       437.71428      37             27             18709.267    
     30000   343.57401      47461802       445.49606      44             29             18709.267    
     35000   353.12987      47461814       457.88668      51             30             18709.267    
     40000   359.5013       47461807       466.14821      59             33             18709.267    
     45000   361.36952      47461815       468.57064      62             36             18709.267    
     50000   364.82811      47461816       473.05523      65             39             18709.267    
     55000   371.13946      47461809       481.23886      70             44             18709.267    
     60000   372.7967       47461814       483.38772      73             46             18709.267    
     65000   379.8582       47461809       492.54404      79             47             18709.267    
     70000   386.77362      47461803       501.51093      83             53             18709.267    
     75000   389.75419      47461800       505.37569      88             53             18709.267    
     80000   393.40947      47461811       510.11533      92             55             18709.267    
     85000   397.54139      47461807       515.47299      95             59             18709.267    
     90000   398.03639      47461798       516.11483      94             61             18709.267    
     95000   398.561        47461795       516.79507      96             63             18709.267    
    100000   403.34185      47461780       522.99417      104            63             18709.267    
Loop time of 37.8596 on 8 procs for 100000 steps with 603 atoms

Performance: 228.212 ns/day, 0.105 hours/ns, 2641.339 timesteps/s, 1.593 Matom-step/s
91.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 8.5078     | 10.679     | 13.037     |  37.0 | 28.21
Bond    | 0.0036741  | 0.0042017  | 0.0050599  |   0.6 |  0.01
Kspace  | 15.77      | 17.983     | 20.021     |  26.8 | 47.50
Neigh   | 0.04143    | 0.04786    | 0.055872   |   2.0 |  0.13
Comm    | 6.5095     | 6.7168     | 7.0278     |   7.1 | 17.74
Output  | 0.0005898  | 0.0006395  | 0.00084343 |   0.0 |  0.00
Modify  | 1.5512     | 1.5549     | 1.5579     |   0.2 |  4.11
Other   |            | 0.8727     |            |       |  2.31

Nlocal:         75.375 ave          85 max          68 min
Histogram: 1 2 1 0 1 1 0 1 0 1
Nghost:        2276.25 ave        2298 max        2253 min
Histogram: 1 0 1 0 2 2 0 0 0 2
Neighs:        13617.5 ave       15704 max       12192 min
Histogram: 1 1 1 1 2 0 1 0 0 1

Total # of neighbors = 108940
Ave neighs/atom = 180.66335
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23015241
  grid = 12 12 20
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0026046994
  estimated relative force accuracy = 7.8439748e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2470 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.766 | 6.769 | 6.773 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   291.45134      47461780       522.99417      104            63             18709.267    
    105000   293.46867      47461788       526.61417      106            65             18709.267    
    110000   295.78455      47461788       530.7699       109            68             18709.267    
    115000   295.73541      47461789       530.68171      109            69             18709.267    
    120000   296.39467      47461785       531.86472      110            69             18709.267    
    125000   301.10472      47461783       540.31665      114            70             18709.267    
    130000   303.79713      47461794       545.14805      119            71             18709.267    
    135000   306.16547      47461790       549.39792      121            75             18709.267    
    140000   307.4218       47461788       551.65232      124            75             18709.267    
    145000   307.48398      47461784       551.76391      126            74             18709.267    
    150000   309.59299      47461792       555.54841      129            76             18709.267    
    155000   310.75418      47461792       557.63211      131            75             18709.267    
    160000   310.94262      47461780       557.97026      130            77             18709.267    
    165000   313.02857      47461784       561.71338      134            77             18709.267    
    170000   313.58406      47461781       562.71018      135            76             18709.267    
    175000   317.99111      47461777       570.6184       140            77             18709.267    
    180000   318.93686      47461788       572.31551      143            77             18709.267    
    185000   318.56874      47461783       571.65493      142            77             18709.267    
    190000   319.45898      47461776       573.25241      143            78             18709.267    
    195000   321.2864       47461777       576.53162      147            78             18709.267    
    200000   323.44686      47461775       580.40845      151            78             18709.267    
Loop time of 42.6947 on 8 procs for 100000 steps with 665 atoms

Performance: 202.367 ns/day, 0.119 hours/ns, 2342.210 timesteps/s, 1.558 Matom-step/s
91.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.962     | 16.268     | 18.251     |  29.4 | 38.10
Bond    | 0.0039385  | 0.0043881  | 0.0052386  |   0.6 |  0.01
Kspace  | 14.482     | 16.588     | 18.655     |  30.5 | 38.85
Neigh   | 0.061645   | 0.066171   | 0.070512   |   1.2 |  0.15
Comm    | 6.7512     | 6.9687     | 7.2421     |   6.6 | 16.32
Output  | 0.00057587 | 0.00063931 | 0.000849   |   0.0 |  0.00
Modify  | 1.8988     | 1.902      | 1.9049     |   0.2 |  4.45
Other   |            | 0.8977     |            |       |  2.10

Nlocal:         83.125 ave          90 max          77 min
Histogram: 2 2 0 0 0 1 0 0 0 3
Nghost:        2488.12 ave        2517 max        2447 min
Histogram: 1 0 1 0 1 0 1 1 2 1
Neighs:        16687.1 ave       17878 max       15136 min
Histogram: 1 0 1 1 1 0 1 0 1 2

Total # of neighbors = 133497
Ave neighs/atom = 200.74737
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 151
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 78
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:20
