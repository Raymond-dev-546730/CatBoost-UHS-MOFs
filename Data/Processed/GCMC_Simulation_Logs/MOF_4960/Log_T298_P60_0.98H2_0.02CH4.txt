LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (14.5154 21.629 39.356)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  600 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.179862 3.638000  # B
pair_coeff 2 2 0.104924 3.431000  # C
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
600 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -3.6e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23466148
  grid = 9 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0027206499
  estimated relative force accuracy = 8.1931562e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2080 324
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.681 | 6.684 | 6.688 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            45254328       532.08056      0              0              12355.957    
      5000   303.28754      45254314       541.52148      5              5              12355.957    
     10000   305.78995      45254317       545.98955      11             7              12355.957    
     15000   306.7738       45254308       547.74622      15             7              12355.957    
     20000   310.00726      45254312       553.51958      22             8              12355.957    
     25000   314.97539      45254310       562.3902       27             10             12355.957    
     30000   316.79717      45254291       565.643        27             12             12355.957    
     35000   318.96018      45254290       569.50507      29             14             12355.957    
     40000   322.48622      45254286       575.80083      31             18             12355.957    
     45000   322.48622      45254286       575.80083      31             18             12355.957    
     50000   323.81307      45254286       578.16993      33             22             12355.957    
     55000   327.16741      45254291       584.15912      39             23             12355.957    
     60000   328.4341       45254275       586.4208       38             26             12355.957    
     65000   332.48059      45254270       593.64583      40             27             12355.957    
     70000   335.25626      45254273       598.60179      45             29             12355.957    
     75000   337.34632      45254283       602.33361      51             29             12355.957    
     80000   339.39645      45254276       605.99413      54             29             12355.957    
     85000   342.6985       45254274       611.88995      57             31             12355.957    
     90000   345.30373      45254275       616.54161      62             31             12355.957    
     95000   345.30373      45254275       616.54161      62             31             12355.957    
    100000   346.21975      45254275       618.17717      63             32             12355.957    
Loop time of 58.6459 on 8 procs for 100000 steps with 695 atoms

Performance: 147.325 ns/day, 0.163 hours/ns, 1705.150 timesteps/s, 1.185 Matom-step/s
90.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 24.64      | 27.971     | 30.805     |  32.4 | 47.69
Bond    | 0.0039601  | 0.0044009  | 0.0049836  |   0.5 |  0.01
Kspace  | 13.274     | 15.844     | 18.748     |  39.6 | 27.02
Neigh   | 0.081203   | 0.085137   | 0.08997    |   1.1 |  0.15
Comm    | 10.664     | 11.036     | 11.481     |   8.2 | 18.82
Output  | 0.00052989 | 0.0006115  | 0.0008041  |   0.0 |  0.00
Modify  | 2.3426     | 2.3436     | 2.3458     |   0.1 |  4.00
Other   |            | 1.36       |            |       |  2.32

Nlocal:         86.875 ave          91 max          85 min
Histogram: 2 2 0 2 0 1 0 0 0 1
Nghost:           3456 ave        3471 max        3441 min
Histogram: 1 1 1 0 0 1 2 1 0 1
Neighs:        28224.4 ave       30500 max       25506 min
Histogram: 1 0 0 2 0 2 1 0 0 2

Total # of neighbors = 225795
Ave neighs/atom = 324.88489
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23464135
  grid = 9 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0025288325
  estimated relative force accuracy = 7.6155038e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2080 324
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.812 | 6.815 | 6.819 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   298.82656      45254275       618.17717      63             32             12355.957    
    105000   299.75701      45254267       620.10198      64             32             12355.957    
    110000   301.4273       45254270       623.55728      66             32             12355.957    
    115000   302.04934      45254276       624.84409      67             32             12355.957    
    120000   301.90421      45254266       624.54386      67             31             12355.957    
    125000   302.98109      45254269       626.77157      67             33             12355.957    
    130000   302.98109      45254269       626.77157      67             33             12355.957    
    135000   304.0185       45254267       628.91766      68             34             12355.957    
    140000   306.10659      45254266       633.23725      69             35             12355.957    
    145000   306.31424      45254264       633.66682      69             35             12355.957    
    150000   307.21774      45254259       635.53586      71             35             12355.957    
    155000   306.52113      45254247       634.09479      69             35             12355.957    
    160000   307.25869      45254248       635.62058      70             35             12355.957    
    165000   307.78567      45254252       636.71072      71             35             12355.957    
    170000   308.04458      45254255       637.24633      72             35             12355.957    
    175000   309.191        45254254       639.61792      74             35             12355.957    
    180000   309.70942      45254248       640.69035      74             35             12355.957    
    185000   310.06289      45254248       641.42158      75             35             12355.957    
    190000   310.46167      45254241       642.24653      75             36             12355.957    
    195000   310.82094      45254235       642.98973      75             36             12355.957    
    200000   312.40273      45254238       646.26197      76             37             12355.957    
Loop time of 65.558 on 8 procs for 100000 steps with 713 atoms

Performance: 131.792 ns/day, 0.182 hours/ns, 1525.367 timesteps/s, 1.088 Matom-step/s
90.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 29.235     | 33.005     | 35.675     |  31.9 | 50.34
Bond    | 0.0040572  | 0.0046542  | 0.0052289  |   0.6 |  0.01
Kspace  | 13.921     | 17.06      | 21.356     |  52.7 | 26.02
Neigh   | 0.091789   | 0.098271   | 0.11026    |   1.6 |  0.15
Comm    | 10.757     | 11.353     | 11.915     |  12.2 | 17.32
Output  | 0.00058238 | 0.00062076 | 0.00078559 |   0.0 |  0.00
Modify  | 2.7077     | 2.7106     | 2.7155     |   0.2 |  4.13
Other   |            | 1.326      |            |       |  2.02

Nlocal:         89.125 ave          91 max          88 min
Histogram: 4 0 0 1 0 0 1 0 0 2
Nghost:        3541.12 ave        3558 max        3523 min
Histogram: 1 0 2 0 1 0 0 2 1 1
Neighs:        29680.8 ave       32753 max       26489 min
Histogram: 1 0 0 2 0 3 0 1 0 1

Total # of neighbors = 237446
Ave neighs/atom = 333.02384
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 76
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 37
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:02:04
