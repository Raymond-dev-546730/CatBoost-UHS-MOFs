LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (18.6051 18.6051 37.384)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  512 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.005 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.504631 4.008000  # Al
pair_coeff 2 2 0.104924 3.431000  # C
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.304777 3.695000  # P

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
512 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -2.3e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.24279831
  grid = 12 12 20
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0024782851
  estimated relative force accuracy = 7.4632819e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2964 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.69 | 6.695 | 6.706 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            49899093       453.91179      0              0              12940.462    
      5000   306.18992      49899074       466.38664      8              6              12940.462    
     10000   309.80149      49899078       471.88775      12             8              12940.462    
     15000   314.64344      49899078       479.26297      18             14             12940.462    
     20000   322.75219      49899072       491.61417      28             17             12940.462    
     25000   325.28518      49899057       495.47242      31             18             12940.462    
     30000   326.67512      49899060       497.58956      31             20             12940.462    
     35000   330.69987      49899055       503.72003      38             20             12940.462    
     40000   333.5395       49899061       508.04534      40             23             12940.462    
     45000   335.45901      49899052       510.96913      42             25             12940.462    
     50000   336.91626      49899042       513.1888       47             26             12940.462    
     55000   338.4614       49899042       515.54235      50             26             12940.462    
     60000   340.17155      49899036       518.14724      50             28             12940.462    
     65000   344.00097      49899036       523.98019      54             30             12940.462    
     70000   347.88666      49899030       529.89884      59             34             12940.462    
     75000   350.11062      49899032       533.28638      60             36             12940.462    
     80000   350.11062      49899032       533.28638      60             36             12940.462    
     85000   351.65739      49899029       535.6424       62             38             12940.462    
     90000   353.23373      49899034       538.04348      66             38             12940.462    
     95000   353.23373      49899034       538.04348      66             38             12940.462    
    100000   357.47501      49899039       544.50377      72             38             12940.462    
Loop time of 52.0742 on 8 procs for 100000 steps with 622 atoms

Performance: 165.917 ns/day, 0.145 hours/ns, 1920.338 timesteps/s, 1.194 Matom-step/s
87.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 17.827     | 19.761     | 21.102     |  23.1 | 37.95
Bond    | 0.0038053  | 0.0044271  | 0.0053026  |   0.8 |  0.01
Kspace  | 16.489     | 17.473     | 19.27      |  24.3 | 33.55
Neigh   | 0.073099   | 0.076017   | 0.07968    |   0.8 |  0.15
Comm    | 10.61      | 11.083     | 11.616     |   8.7 | 21.28
Output  | 0.00055228 | 0.00067352 | 0.00093993 |   0.0 |  0.00
Modify  | 2.1815     | 2.1831     | 2.1848     |   0.1 |  4.19
Other   |            | 1.493      |            |       |  2.87

Nlocal:          77.75 ave          80 max          72 min
Histogram: 1 0 0 0 0 2 0 0 2 3
Nghost:        3022.75 ave        3028 max        3021 min
Histogram: 4 1 0 0 2 0 0 0 0 1
Neighs:          21206 ave       23093 max       20062 min
Histogram: 2 1 0 2 1 0 0 1 0 1

Total # of neighbors = 169648
Ave neighs/atom = 272.74598
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.24279815
  grid = 12 12 20
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0022484984
  estimated relative force accuracy = 6.7712861e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2964 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.822 | 6.826 | 6.837 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   294.15416      49899039       544.50377      72             38             12940.462    
    105000   294.54038      49899032       545.21871      73             37             12940.462    
    110000   296.92145      49899020       549.62626      74             37             12940.462    
    115000   296.92145      49899020       549.62626      74             37             12940.462    
    120000   299.49576      49899024       554.39152      76             38             12940.462    
    125000   301.20064      49899035       557.54739      80             39             12940.462    
    130000   301.81934      49899029       558.69265      80             40             12940.462    
    135000   302.09169      49899031       559.19681      81             40             12940.462    
    140000   302.77084      49899020       560.45397      81             41             12940.462    
    145000   303.11864      49899020       561.09778      83             41             12940.462    
    150000   303.54297      49899025       561.88324      84             41             12940.462    
    155000   303.54297      49899025       561.88324      84             41             12940.462    
    160000   304.90957      49899028       564.41294      86             42             12940.462    
    165000   305.70413      49899021       565.88373      87             43             12940.462    
    170000   308.09837      49899032       570.31566      92             44             12940.462    
    175000   309.44845      49899029       572.81477      95             44             12940.462    
    180000   310.04867      49899033       573.92583      96             44             12940.462    
    185000   309.62434      49899029       573.14036      95             44             12940.462    
    190000   309.91369      49899029       573.67597      96             44             12940.462    
    195000   309.60399      49899025       573.10269      96             44             12940.462    
    200000   310.16259      49899026       574.13672      97             44             12940.462    
Loop time of 59.194 on 8 procs for 100000 steps with 653 atoms

Performance: 145.961 ns/day, 0.164 hours/ns, 1689.361 timesteps/s, 1.103 Matom-step/s
88.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.57      | 25.241     | 27.288     |  21.6 | 42.64
Bond    | 0.0042533  | 0.0047236  | 0.005418   |   0.6 |  0.01
Kspace  | 16.224     | 18.463     | 20.419     |  29.8 | 31.19
Neigh   | 0.085821   | 0.092394   | 0.09851    |   1.3 |  0.16
Comm    | 11.068     | 11.429     | 11.865     |   7.8 | 19.31
Output  | 0.0005733  | 0.00069003 | 0.00095883 |   0.0 |  0.00
Modify  | 2.526      | 2.5275     | 2.53       |   0.1 |  4.27
Other   |            | 1.435      |            |       |  2.42

Nlocal:         81.625 ave          86 max          77 min
Histogram: 1 0 2 0 1 0 2 0 1 1
Nghost:        3178.88 ave        3183 max        3175 min
Histogram: 1 1 1 1 0 1 0 1 1 1
Neighs:          23416 ave       25051 max       21750 min
Histogram: 2 0 0 1 1 1 1 0 0 2

Total # of neighbors = 187328
Ave neighs/atom = 286.87289
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 97
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 44
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:51
