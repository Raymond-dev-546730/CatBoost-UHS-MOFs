LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (17.2954 33.2059 33.2059)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  904 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.005 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
904 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 3.4e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22639821
  grid = 9 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.002178465
  estimated relative force accuracy = 6.5603827e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1859 320
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.756 | 6.763 | 6.768 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            5.5391328e+13  802.1181       0              0              19070.458    
      5000   301.05745      5.5391328e+13  810.34776      5              4              19070.458    
     10000   302.78442      5.5391328e+13  814.99618      9              7              19070.458    
     15000   303.35387      5.5391328e+13  816.52897      13             7              19070.458    
     20000   306.81229      5.5391328e+13  825.8379       18             9              19070.458    
     25000   309.67018      5.5391328e+13  833.53039      20             11             19070.458    
     30000   309.93995      5.5391328e+13  834.25654      22             11             19070.458    
     35000   311.73708      5.5391328e+13  839.09382      26             12             19070.458    
     40000   313.40603      5.5391328e+13  843.58607      29             18             19070.458    
     45000   315.00199      5.5391328e+13  847.88188      32             21             19070.458    
     50000   316.81583      5.5391328e+13  852.76413      35             22             19070.458    
     55000   318.47842      5.5391328e+13  857.23929      39             22             19070.458    
     60000   319.80649      5.5391328e+13  860.81401      44             21             19070.458    
     65000   322.95078      5.5391328e+13  869.27741      51             24             19070.458    
     70000   324.38948      5.5391328e+13  873.1499       55             28             19070.458    
     75000   325.66284      5.5391328e+13  876.57737      60             28             19070.458    
     80000   326.37358      5.5391328e+13  878.49045      62             28             19070.458    
     85000   328.32586      5.5391328e+13  883.74535      65             28             19070.458    
     90000   329.53293      5.5391328e+13  886.99439      67             31             19070.458    
     95000   330.25793      5.5391328e+13  888.94586      67             32             19070.458    
    100000   332.93477      5.5391328e+13  896.15102      73             32             19070.458    
Loop time of 75.1697 on 8 procs for 100000 steps with 1009 atoms

Performance: 114.940 ns/day, 0.209 hours/ns, 1330.323 timesteps/s, 1.342 Matom-step/s
91.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 38.094     | 39.405     | 40.29      |   9.9 | 52.42
Bond    | 0.0050468  | 0.0052237  | 0.0058022  |   0.3 |  0.01
Kspace  | 17.656     | 18.591     | 19.833     |  15.4 | 24.73
Neigh   | 0.15032    | 0.15356    | 0.15848    |   0.7 |  0.20
Comm    | 11.53      | 11.707     | 11.804     |   2.7 | 15.57
Output  | 0.00064818 | 0.00070877 | 0.00099928 |   0.0 |  0.00
Modify  | 3.6925     | 3.6935     | 3.695      |   0.0 |  4.91
Other   |            | 1.614      |            |       |  2.15

Nlocal:        126.125 ave         129 max         123 min
Histogram: 1 2 0 0 0 2 0 0 1 2
Nghost:        4178.88 ave        4197 max        4165 min
Histogram: 1 2 1 0 1 0 1 0 1 1
Neighs:        38179.8 ave       38983 max       37388 min
Histogram: 3 0 0 1 0 0 0 1 1 2

Total # of neighbors = 305438
Ave neighs/atom = 302.71358
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22639807
  grid = 9 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0020620077
  estimated relative force accuracy = 6.2096749e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1859 320
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.886 | 6.892 | 6.897 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   298.25406      5.5391328e+13  896.15102      73             32             19070.458    
    105000   298.25406      5.5391328e+13  896.15102      73             32             19070.458    
    110000   300.04607      5.5391328e+13  901.53538      75             32             19070.458    
    115000   298.80722      5.5391328e+13  897.81305      73             32             19070.458    
    120000   299.37694      5.5391328e+13  899.52487      75             32             19070.458    
    125000   300.59954      5.5391328e+13  903.19836      77             34             19070.458    
    130000   299.95353      5.5391328e+13  901.25733      77             34             19070.458    
    135000   300.18635      5.5391328e+13  901.95688      78             34             19070.458    
    140000   300.61787      5.5391328e+13  903.25345      79             35             19070.458    
    145000   300.38527      5.5391328e+13  902.55457      80             34             19070.458    
    150000   300.90931      5.5391328e+13  904.12913      81             35             19070.458    
    155000   301.16721      5.5391328e+13  904.90402      83             36             19070.458    
    160000   301.84281      5.5391328e+13  906.93396      85             36             19070.458    
    165000   302.40248      5.5391328e+13  908.61557      88             36             19070.458    
    170000   303.24327      5.5391328e+13  911.14187      89             37             19070.458    
    175000   303.84763      5.5391328e+13  912.95777      91             39             19070.458    
    180000   305.00837      5.5391328e+13  916.44538      94             39             19070.458    
    185000   305.00837      5.5391328e+13  916.44538      94             39             19070.458    
    190000   305.43688      5.5391328e+13  917.73291      96             40             19070.458    
    195000   305.43688      5.5391328e+13  917.73291      96             40             19070.458    
    200000   305.5932       5.5391328e+13  918.20259      96             41             19070.458    
Loop time of 81.4324 on 8 procs for 100000 steps with 1041 atoms

Performance: 106.100 ns/day, 0.226 hours/ns, 1228.012 timesteps/s, 1.278 Matom-step/s
92.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 43.855     | 45.512     | 46.781     |  14.5 | 55.89
Bond    | 0.0048854  | 0.0052308  | 0.0055857  |   0.4 |  0.01
Kspace  | 17.103     | 18.755     | 20.129     |  24.7 | 23.03
Neigh   | 0.164      | 0.17034    | 0.17644    |   1.0 |  0.21
Comm    | 11.083     | 11.452     | 11.785     |   6.5 | 14.06
Output  | 0.0006235  | 0.0006932  | 0.00097603 |   0.0 |  0.00
Modify  | 3.9608     | 3.9626     | 3.965      |   0.1 |  4.87
Other   |            | 1.575      |            |       |  1.93

Nlocal:        130.125 ave         132 max         128 min
Histogram: 1 0 1 0 0 3 0 2 0 1
Nghost:        4293.12 ave        4311 max        4279 min
Histogram: 2 0 2 0 0 2 0 0 1 1
Neighs:        40650.5 ave       41519 max       39765 min
Histogram: 1 1 0 2 0 0 1 1 1 1

Total # of neighbors = 325204
Ave neighs/atom = 312.39577
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 96
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 41
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:02:36
