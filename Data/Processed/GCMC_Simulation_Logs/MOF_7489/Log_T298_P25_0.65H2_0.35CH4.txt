LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 65.0% H₂ / 35.0% CH₄ at 25 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (19.196 19.196 36.569)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  464 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.504631 4.008000  # Al
pair_coeff 2 2 0.104924 3.431000  # C
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.060014 3.118000  # O

# Gas parameters
pair_coeff 5 5 0.072930 2.958000
pair_coeff 6 6 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:4
464 atoms in group framework
group h2 type 5
0 atoms in group h2
group ch4 type 6
0 atoms in group ch4
group gases type 5 6
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[5]
variable n_ch4 equal c_type_counts[6]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.653801
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 1.653801 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23878536
  grid = 12 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0028693447
  estimated relative force accuracy = 8.6409462e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2366 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.656 | 6.659 | 6.666 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            49113519       411.27429      0              0              13475.18     
      5000   306.33288      49113514       422.77461      7              5              13475.18     
     10000   308.59273      49113506       425.89347      11             8              13475.18     
     15000   312.6839       49113504       431.53976      17             11             13475.18     
     20000   320.36049      49113509       442.13433      24             13             13475.18     
     25000   327.52401      49113512       452.02082      28             14             13475.18     
     30000   331.22312      49113500       457.12601      32             15             13475.18     
     35000   336.2271       49113497       464.03208      35             18             13475.18     
     40000   340.46221      49113506       469.87702      42             22             13475.18     
     45000   340.92365      49113496       470.51386      41             24             13475.18     
     50000   342.95015      49113496       473.31066      43             26             13475.18     
     55000   342.98089      49113488       473.3531       44             26             13475.18     
     60000   341.73163      49113480       471.62896      45             25             13475.18     
     65000   343.46143      49113479       474.01629      51             25             13475.18     
     70000   345.72249      49113472       477.13681      54             29             13475.18     
     75000   348.0667       49113471       480.37209      58             30             13475.18     
     80000   353.30512      49113478       487.60171      62             31             13475.18     
     85000   359.23666      49113479       495.78792      67             32             13475.18     
     90000   359.9236       49113487       496.73597      71             33             13475.18     
     95000   361.84115      49113479       499.38241      73             33             13475.18     
    100000   367.79483      49113484       507.59918      77             34             13475.18     
Loop time of 42.8115 on 8 procs for 100000 steps with 575 atoms

Performance: 201.815 ns/day, 0.119 hours/ns, 2335.821 timesteps/s, 1.343 Matom-step/s
88.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.858     | 14.814     | 16.158     |  16.4 | 34.60
Bond    | 0.003714   | 0.0039284  | 0.0043399  |   0.3 |  0.01
Kspace  | 14.952     | 16.317     | 16.852     |  14.4 | 38.11
Neigh   | 0.053877   | 0.057828   | 0.062314   |   1.1 |  0.14
Comm    | 8.4946     | 8.7744     | 9.0852     |   6.4 | 20.50
Output  | 0.0005752  | 0.00061436 | 0.00079974 |   0.0 |  0.00
Modify  | 1.7119     | 1.7137     | 1.7157     |   0.1 |  4.00
Other   |            | 1.13       |            |       |  2.64

Nlocal:         71.875 ave          78 max          66 min
Histogram: 1 1 0 0 0 5 0 0 0 1
Nghost:         2739.5 ave        2762 max        2725 min
Histogram: 2 0 2 1 0 1 0 1 0 1
Neighs:        17327.9 ave       19761 max       15982 min
Histogram: 1 2 1 1 1 1 0 0 0 1

Total # of neighbors = 138623
Ave neighs/atom = 241.08348
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23875995
  grid = 12 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0025788507
  estimated relative force accuracy = 7.7661322e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2366 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.788 | 6.79 | 6.798 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   296.67074      49113484       507.59918      77             34             13475.18     
    105000   298.09567      49113477       510.03721      78             33             13475.18     
    110000   303.32817      49113488       518.98995      82             34             13475.18     
    115000   301.61184      49113487       516.05333      82             34             13475.18     
    120000   301.2038       49113479       515.35518      81             35             13475.18     
    125000   304.23228      49113484       520.53686      83             37             13475.18     
    130000   304.74826      49113480       521.4197       84             36             13475.18     
    135000   305.13556      49113478       522.08235      84             37             13475.18     
    140000   306.61759      49113476       524.61808      87             38             13475.18     
    145000   307.4387       49113477       526.023        89             38             13475.18     
    150000   309.415        49113478       529.40442      88             40             13475.18     
    155000   307.08037      49113460       525.4099       86             39             13475.18     
    160000   307.79929      49113461       526.63995      89             39             13475.18     
    165000   309.28684      49113460       529.18514      91             39             13475.18     
    170000   311.52932      49113459       533.02198      94             40             13475.18     
    175000   311.52932      49113459       533.02198      94             40             13475.18     
    180000   313.07045      49113458       535.65884      97             40             13475.18     
    185000   313.66756      49113451       536.68047      97             40             13475.18     
    190000   313.66756      49113451       536.68047      97             40             13475.18     
    195000   314.29364      49113457       537.75169      99             40             13475.18     
    200000   314.87379      49113456       538.74432      100            40             13475.18     
Loop time of 48.4395 on 8 procs for 100000 steps with 604 atoms

Performance: 178.367 ns/day, 0.135 hours/ns, 2064.429 timesteps/s, 1.247 Matom-step/s
89.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 18.62      | 19.4       | 21.676     |  21.1 | 40.05
Bond    | 0.0037791  | 0.0040903  | 0.0047632  |   0.4 |  0.01
Kspace  | 14.519     | 16.667     | 17.401     |  21.6 | 34.41
Neigh   | 0.066521   | 0.071678   | 0.078063   |   1.3 |  0.15
Comm    | 8.9342     | 9.1944     | 9.5515     |   6.5 | 18.98
Output  | 0.00049839 | 0.00053958 | 0.00069914 |   0.0 |  0.00
Modify  | 2.0122     | 2.0136     | 2.0154     |   0.1 |  4.16
Other   |            | 1.088      |            |       |  2.25

Nlocal:           75.5 ave          80 max          73 min
Histogram: 1 2 2 0 1 1 0 0 0 1
Nghost:        2877.38 ave        2881 max        2871 min
Histogram: 1 0 1 0 0 2 0 0 0 4
Neighs:        19180.2 ave       21058 max       18416 min
Histogram: 1 2 3 0 1 0 0 0 0 1

Total # of neighbors = 153442
Ave neighs/atom = 254.04305
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 100
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 40
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:31
