LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (9.9523 9.9523 36.798)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  154 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.598566 3.976000  # In
pair_coeff 4 4 0.060014 3.118000  # O

# Gas parameters
pair_coeff 5 5 0.072930 2.958000
pair_coeff 6 6 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:4
154 atoms in group framework
group h2 type 5
0 atoms in group h2
group ch4 type 6
0 atoms in group ch4
group gases type 5 6
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[5]
variable n_ch4 equal c_type_counts[6]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23256771
  grid = 6 6 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.001661519
  estimated relative force accuracy = 5.0036152e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1300 72
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 2 2 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.437 | 6.444 | 6.448 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            17132468       135.90705      0              0              3644.7784    
      5000   321.35968      17132459       146.56056      8              4              3644.7784    
     10000   324.74261      17132462       148.10339      10             6              3644.7784    
     15000   330.46754      17132456       150.71433      12             7              3644.7784    
     20000   343.25773      17132448       156.54747      15             8              3644.7784    
     25000   347.91037      17132449       158.66937      17             8              3644.7784    
     30000   355.29149      17132449       162.03564      21             8              3644.7784    
     35000   360.76942      17132453       164.53392      23             8              3644.7784    
     40000   363.62062      17132455       165.83425      24             9              3644.7784    
     45000   362.12951      17132440       165.15421      26             9              3644.7784    
     50000   363.30986      17132439       165.69253      28             9              3644.7784    
     55000   369.34035      17132449       168.44281      31             10             3644.7784    
     60000   367.99779      17132446       167.83052      32             9              3644.7784    
     65000   366.8528       17132440       167.30833      32             9              3644.7784    
     70000   371.42694      17132446       169.39443      35             9              3644.7784    
     75000   378.25565      17132447       172.50876      38             10             3644.7784    
     80000   383.94353      17132443       175.1028       41             10             3644.7784    
     85000   384.42694      17132444       175.32327      42             10             3644.7784    
     90000   385.18677      17132442       175.66979      42             10             3644.7784    
     95000   385.18677      17132442       175.66979      42             10             3644.7784    
    100000   391.40742      17132446       178.50681      45             10             3644.7784    
Loop time of 28.4866 on 8 procs for 100000 steps with 209 atoms

Performance: 303.301 ns/day, 0.079 hours/ns, 3510.428 timesteps/s, 733.679 katom-step/s
87.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.4794     | 6.7005     | 9.1098     |  63.7 | 23.52
Bond    | 0.0036683  | 0.0038463  | 0.0043815  |   0.4 |  0.01
Kspace  | 7.8765     | 10.226     | 12.119     |  48.3 | 35.90
Neigh   | 0.017185   | 0.025729   | 0.034019   |   3.4 |  0.09
Comm    | 9.1496     | 9.2631     | 9.4052     |   3.3 | 32.52
Output  | 0.00056051 | 0.00062243 | 0.00086383 |   0.0 |  0.00
Modify  | 1.1415     | 1.145      | 1.1504     |   0.3 |  4.02
Other   |            | 1.121      |            |       |  3.94

Nlocal:         26.125 ave          37 max          17 min
Histogram: 2 0 0 0 3 1 0 0 1 1
Nghost:        2628.38 ave        2654 max        2598 min
Histogram: 1 0 1 0 1 2 1 0 1 1
Neighs:           8709 ave       11801 max        6386 min
Histogram: 2 1 1 0 0 2 0 0 1 1

Total # of neighbors = 69672
Ave neighs/atom = 333.35885
Ave special neighs/atom = 0
Neighbor list builds = 1296
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23256246
  grid = 6 6 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0014263727
  estimated relative force accuracy = 4.295479e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1300 72
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.576 | 6.582 | 6.593 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   287.91027      17132446       178.50681      45             10             3644.7784    
    105000   287.91027      17132446       178.50681      45             10             3644.7784    
    110000   289.09838      17132445       179.24345      46             10             3644.7784    
    115000   294.61406      17132450       182.66322      48             10             3644.7784    
    120000   294.61406      17132447       182.66322      48             10             3644.7784    
    125000   296.18954      17132452       183.64003      49             10             3644.7784    
    130000   296.18954      17132452       183.64003      49             10             3644.7784    
    135000   297.34725      17132450       184.35782      49             10             3644.7784    
    140000   302.07095      17132452       187.28655      50             11             3644.7784    
    145000   300.24666      17132442       186.15548      48             11             3644.7784    
    150000   300.24666      17132442       186.15548      48             11             3644.7784    
    155000   304.56541      17132443       188.83314      49             11             3644.7784    
    160000   306.14089      17132444       189.80995      50             11             3644.7784    
    165000   307.32637      17132443       190.54496      51             11             3644.7784    
    170000   307.32637      17132443       190.54496      51             11             3644.7784    
    175000   307.32637      17132443       190.54496      51             11             3644.7784    
    180000   307.32637      17132443       190.54496      51             11             3644.7784    
    185000   307.32637      17132443       190.54496      51             11             3644.7784    
    190000   307.32637      17132443       190.54496      51             11             3644.7784    
    195000   307.32637      17132443       190.54496      51             11             3644.7784    
    200000   307.32637      17132443       190.54496      51             11             3644.7784    
Loop time of 33.5248 on 8 procs for 100000 steps with 216 atoms

Performance: 257.720 ns/day, 0.093 hours/ns, 2982.867 timesteps/s, 644.299 katom-step/s
88.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.2582     | 8.8938     | 12.226     |  72.2 | 26.53
Bond    | 0.0038285  | 0.0041366  | 0.0048928  |   0.5 |  0.01
Kspace  | 8.5663     | 11.902     | 14.574     |  61.9 | 35.50
Neigh   | 0.020263   | 0.032838   | 0.042485   |   3.7 |  0.10
Comm    | 9.8171     | 10.007     | 10.21      |   4.1 | 29.85
Output  | 0.00061619 | 0.00066714 | 0.00086634 |   0.0 |  0.00
Modify  | 1.3936     | 1.3968     | 1.4017     |   0.2 |  4.17
Other   |            | 1.288      |            |       |  3.84

Nlocal:             27 ave          38 max          16 min
Histogram: 1 1 0 0 2 2 0 0 1 1
Nghost:        2720.62 ave        2749 max        2693 min
Histogram: 2 0 0 1 2 0 0 1 1 1
Neighs:        9295.38 ave       12679 max        6179 min
Histogram: 1 0 2 1 0 1 0 1 1 1

Total # of neighbors = 74363
Ave neighs/atom = 344.27315
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 51
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 11
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:02
