LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 75.0% H₂ / 25.0% CH₄ at 35 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (9.9523 9.9523 36.798)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  154 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.003 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.598566 3.976000  # In
pair_coeff 4 4 0.060014 3.118000  # O

# Gas parameters
pair_coeff 5 5 0.072930 2.958000
pair_coeff 6 6 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:4
154 atoms in group framework
group h2 type 5
0 atoms in group h2
group ch4 type 6
0 atoms in group ch4
group gases type 5 6
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[5]
variable n_ch4 equal c_type_counts[6]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.939543
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 1.939543 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23256771
  grid = 6 6 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.001661519
  estimated relative force accuracy = 5.0036152e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1300 72
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 2 2 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.437 | 6.444 | 6.448 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            17132468       135.90705      0              0              3644.7784    
      5000   321.35968      17132459       146.56056      8              4              3644.7784    
     10000   324.74261      17132462       148.10339      10             6              3644.7784    
     15000   330.46754      17132456       150.71433      12             7              3644.7784    
     20000   343.25773      17132448       156.54747      15             8              3644.7784    
     25000   347.91037      17132449       158.66937      17             8              3644.7784    
     30000   355.29149      17132449       162.03564      21             8              3644.7784    
     35000   360.76942      17132453       164.53392      23             8              3644.7784    
     40000   363.62062      17132455       165.83425      24             9              3644.7784    
     45000   362.12951      17132440       165.15421      26             9              3644.7784    
     50000   363.30986      17132439       165.69253      28             9              3644.7784    
     55000   369.34035      17132449       168.44281      31             10             3644.7784    
     60000   367.99779      17132446       167.83052      32             9              3644.7784    
     65000   362.93573      17132435       165.5219       31             9              3644.7784    
     70000   367.50987      17132441       167.608        34             9              3644.7784    
     75000   374.33858      17132443       170.72233      37             10             3644.7784    
     80000   377.50568      17132434       172.16673      39             10             3644.7784    
     85000   377.98909      17132435       172.38719      40             10             3644.7784    
     90000   382.66598      17132437       174.52016      41             10             3644.7784    
     95000   382.66598      17132437       174.52016      41             10             3644.7784    
    100000   388.88664      17132441       177.35717      44             10             3644.7784    
Loop time of 29.4841 on 8 procs for 100000 steps with 208 atoms

Performance: 293.039 ns/day, 0.082 hours/ns, 3391.654 timesteps/s, 705.464 katom-step/s
87.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.6432     | 6.9239     | 9.4872     |  66.7 | 23.48
Bond    | 0.003783   | 0.0040992  | 0.0044373  |   0.3 |  0.01
Kspace  | 8.3473     | 10.828     | 12.966     |  50.8 | 36.73
Neigh   | 0.016536   | 0.026008   | 0.033731   |   3.4 |  0.09
Comm    | 9.1096     | 9.3539     | 9.5474     |   4.1 | 31.73
Output  | 0.00060666 | 0.00065291 | 0.00090792 |   0.0 |  0.00
Modify  | 1.1881     | 1.1912     | 1.1949     |   0.2 |  4.04
Other   |            | 1.156      |            |       |  3.92

Nlocal:             26 ave          37 max          16 min
Histogram: 2 0 0 0 3 1 0 0 1 1
Nghost:           2618 ave        2645 max        2586 min
Histogram: 1 0 1 0 1 2 1 0 1 1
Neighs:        8629.12 ave       11764 max        5877 min
Histogram: 1 2 0 1 0 1 1 0 1 1

Total # of neighbors = 69033
Ave neighs/atom = 331.88942
Ave special neighs/atom = 0
Neighbor list builds = 1296
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23256258
  grid = 6 6 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0014297942
  estimated relative force accuracy = 4.3057827e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1300 72
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.576 | 6.582 | 6.592 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   287.43795      17132441       177.35717      44             10             3644.7784    
    105000   287.43795      17132441       177.35717      44             10             3644.7784    
    110000   288.63181      17132440       178.09381      45             10             3644.7784    
    115000   290.71729      17132439       179.38062      46             10             3644.7784    
    120000   294.17413      17132442       181.51358      47             10             3644.7784    
    125000   294.17413      17132442       181.51358      47             10             3644.7784    
    130000   294.17413      17132442       181.51358      47             10             3644.7784    
    135000   296.95061      17132440       183.22675      47             10             3644.7784    
    140000   301.69713      17132442       186.15548      48             11             3644.7784    
    145000   302.88834      17132444       186.89049      49             11             3644.7784    
    150000   302.72568      17132437       186.79013      49             11             3644.7784    
    155000   307.06529      17132438       189.46779      50             11             3644.7784    
    160000   308.64838      17132439       190.4446       51             11             3644.7784    
    165000   309.83959      17132438       191.1796       52             11             3644.7784    
    170000   309.83959      17132438       191.1796       52             11             3644.7784    
    175000   309.83959      17132438       191.1796       52             11             3644.7784    
    180000   309.83959      17132438       191.1796       52             11             3644.7784    
    185000   309.83959      17132438       191.1796       52             11             3644.7784    
    190000   309.83959      17132438       191.1796       52             11             3644.7784    
    195000   309.83959      17132438       191.1796       52             11             3644.7784    
    200000   309.83959      17132438       191.1796       52             11             3644.7784    
Loop time of 33.4389 on 8 procs for 100000 steps with 217 atoms

Performance: 258.382 ns/day, 0.093 hours/ns, 2990.532 timesteps/s, 648.946 katom-step/s
88.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.9643     | 8.8319     | 12.223     |  73.7 | 26.41
Bond    | 0.0039408  | 0.0041685  | 0.0046555  |   0.3 |  0.01
Kspace  | 8.5725     | 11.892     | 14.726     |  62.4 | 35.56
Neigh   | 0.020161   | 0.032733   | 0.042258   |   3.7 |  0.10
Comm    | 9.8977     | 10.028     | 10.132     |   2.4 | 29.99
Output  | 0.00063487 | 0.00069254 | 0.00094503 |   0.0 |  0.00
Modify  | 1.3718     | 1.3764     | 1.381      |   0.3 |  4.12
Other   |            | 1.273      |            |       |  3.81

Nlocal:         27.125 ave          38 max          16 min
Histogram: 1 1 0 0 1 3 0 0 1 1
Nghost:        2732.12 ave        2758 max        2702 min
Histogram: 1 1 0 1 2 0 0 0 1 2
Neighs:           9377 ave       12679 max        6179 min
Histogram: 1 0 2 1 0 1 0 1 1 1

Total # of neighbors = 75016
Ave neighs/atom = 345.69585
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 52
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 11
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:02
