LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 75.0% H₂ / 25.0% CH₄ at 35 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (30.3978 30.3978 30.3978)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  840 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.005 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.060014 3.118000  # O
pair_coeff 4 4 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 5 5 0.072930 2.958000
pair_coeff 6 6 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:4
840 atoms in group framework
group h2 type 5
0 atoms in group h2
group ch4 type 6
0 atoms in group ch4
group gases type 5 6
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[5]
variable n_ch4 equal c_type_counts[6]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.939543
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 1.939543 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -8.7e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22927229
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0029458951
  estimated relative force accuracy = 8.8714755e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 512
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 5 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.683 | 6.693 | 6.699 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            67455997       745.26809      0              0              28088.365    
      5000   302.1829       67456000       755.72909      7              5              28088.365    
     10000   304.14995      67455987       760.64851      9              10             28088.365    
     15000   305.72715      67455988       764.59292      15             14             28088.365    
     20000   309.08421      67456000       772.98858      21             17             28088.365    
     25000   313.43966      67455993       783.88114      26             23             28088.365    
     30000   313.75216      67455985       784.66267      26             23             28088.365    
     35000   319.78489      67455983       799.74992      31             30             28088.365    
     40000   323.46825      67455978       808.96163      39             35             28088.365    
     45000   324.6892       67455969       812.0151       41             36             28088.365    
     50000   327.44816      67455967       818.91497      44             40             28088.365    
     55000   330.1952       67455975       825.78504      50             44             28088.365    
     60000   332.04383      67455972       830.40829      56             45             28088.365    
     65000   335.01345      67455969       837.83501      63             47             28088.365    
     70000   337.80058      67455966       844.80533      66             52             28088.365    
     75000   341.24198      67455977       853.41194      72             54             28088.365    
     80000   343.69971      67455970       859.55848      76             59             28088.365    
     85000   346.46185      67455970       866.46632      80             61             28088.365    
     90000   350.26861      67455971       875.98665      87             64             28088.365    
     95000   353.34989      67455975       883.69262      94             64             28088.365    
    100000   356.74912      67455972       892.19373      103            66             28088.365    
Loop time of 59.1565 on 8 procs for 100000 steps with 1009 atoms

Performance: 146.053 ns/day, 0.164 hours/ns, 1690.431 timesteps/s, 1.706 Matom-step/s
90.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.308     | 25.167     | 27.11      |  25.1 | 42.54
Bond    | 0.0043465  | 0.0045472  | 0.0047592  |   0.2 |  0.01
Kspace  | 19.445     | 20.972     | 22.769     |  26.0 | 35.45
Neigh   | 0.08026    | 0.087863   | 0.094929   |   1.7 |  0.15
Comm    | 8.9286     | 9.2611     | 9.4038     |   5.1 | 15.66
Output  | 0.00065276 | 0.00071365 | 0.0010353  |   0.0 |  0.00
Modify  | 2.4645     | 2.4664     | 2.4704     |   0.1 |  4.17
Other   |            | 1.197      |            |       |  2.02

Nlocal:        126.125 ave         137 max         120 min
Histogram: 1 2 2 1 0 0 0 1 0 1
Nghost:        2997.75 ave        3037 max        2966 min
Histogram: 1 2 0 1 1 0 0 2 0 1
Neighs:          26693 ave       28216 max       24131 min
Histogram: 1 1 0 0 0 0 1 2 2 1

Total # of neighbors = 213544
Ave neighs/atom = 211.63925
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22925641
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.002688638
  estimated relative force accuracy = 8.0967536e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 512
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.816 | 6.826 | 6.832 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   296.93701      67455972       892.19373      103            66             28088.365    
    105000   298.08965      67455961       895.65701      106            68             28088.365    
    110000   298.36869      67455959       896.49542      107            69             28088.365    
    115000   299.82825      67455955       900.88092      109            72             28088.365    
    120000   301.97918      67455957       907.34371      113            73             28088.365    
    125000   304.7896       67455967       915.78805      117            77             28088.365    
    130000   304.83047      67455969       915.91085      119            77             28088.365    
    135000   305.9237       67455972       919.19565      122            77             28088.365    
    140000   306.85082      67455976       921.98133      125            78             28088.365    
    145000   308.2514       67455977       926.18958      127            79             28088.365    
    150000   310.24144      67455978       932.16896      127            83             28088.365    
    155000   309.79725      67455971       930.83432      127            84             28088.365    
    160000   310.99877      67455980       934.44449      131            84             28088.365    
    165000   312.4393       67455984       938.77279      135            85             28088.365    
    170000   313.51891      67455971       942.01663      135            85             28088.365    
    175000   314.67148      67455969       945.47972      138            85             28088.365    
    180000   316.86083      67455980       952.05798      141            86             28088.365    
    185000   316.52025      67455983       951.03465      140            87             28088.365    
    190000   316.82466      67455981       951.94928      142            88             28088.365    
    195000   316.80098      67455977       951.87813      142            88             28088.365    
    200000   318.51135      67455971       957.01721      146            88             28088.365    
Loop time of 68.0518 on 8 procs for 100000 steps with 1074 atoms

Performance: 126.962 ns/day, 0.189 hours/ns, 1469.469 timesteps/s, 1.578 Matom-step/s
91.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 29.271     | 32.638     | 34.318     |  29.1 | 47.96
Bond    | 0.0042998  | 0.0047117  | 0.0058084  |   0.7 |  0.01
Kspace  | 20.157     | 21.374     | 24.365     |  32.8 | 31.41
Neigh   | 0.10308    | 0.11111    | 0.11654    |   1.6 |  0.16
Comm    | 9.2318     | 9.7057     | 9.9614     |   7.6 | 14.26
Output  | 0.00062384 | 0.00066803 | 0.0009024  |   0.0 |  0.00
Modify  | 2.9168     | 2.9186     | 2.9224     |   0.1 |  4.29
Other   |            | 1.299      |            |       |  1.91

Nlocal:         134.25 ave         145 max         126 min
Histogram: 1 1 0 2 1 1 1 0 0 1
Nghost:         3162.5 ave        3189 max        3142 min
Histogram: 3 0 1 0 0 0 2 0 1 1
Neighs:        30156.5 ave       32249 max       26590 min
Histogram: 1 0 1 0 1 0 0 1 2 2

Total # of neighbors = 241252
Ave neighs/atom = 224.62942
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 146
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 88
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:02:07
