LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (21.4934 21.4934 21.4934)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  488 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.504631 4.008000  # Al
pair_coeff 2 2 0.104924 3.431000  # C
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.068956 3.261000  # N
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
488 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -4.2e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.25185527
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0019881753
  estimated relative force accuracy = 5.9873309e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 512
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 4 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.569 | 6.578 | 6.584 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            35303984       432.59304      0              0              9929.2253    
      5000   302.14681      35303965       438.61278      3              5              9929.2253    
     10000   303.34951      35303961       440.35868      5              7              9929.2253    
     15000   306.02649      35303961       444.24473      8              9              9929.2253    
     20000   309.80504      35303957       449.72988      11             10             9929.2253    
     25000   315.16996      35303958       457.51789      13             11             9929.2253    
     30000   315.23313      35303957       457.60959      14             11             9929.2253    
     35000   318.59313      35303957       462.48716      15             13             9929.2253    
     40000   319.53848      35303956       463.85947      19             14             9929.2253    
     45000   320.21524      35303961       464.8419       22             14             9929.2253    
     50000   321.77542      35303960       467.10673      22             16             9929.2253    
     55000   320.84272      35303955       465.75278      20             17             9929.2253    
     60000   320.29577      35303953       464.95879      21             15             9929.2253    
     65000   320.74215      35303952       465.60678      22             15             9929.2253    
     70000   321.58498      35303941       466.83028      22             16             9929.2253    
     75000   322.65104      35303944       468.37783      24             16             9929.2253    
     80000   324.72288      35303938       471.38544      26             16             9929.2253    
     85000   325.06763      35303935       471.88588      26             17             9929.2253    
     90000   325.78239      35303931       472.92347      26             18             9929.2253    
     95000   326.56395      35303938       474.05803      28             18             9929.2253    
    100000   327.64814      35303929       475.63189      29             18             9929.2253    
Loop time of 56.1501 on 8 procs for 100000 steps with 535 atoms

Performance: 153.873 ns/day, 0.156 hours/ns, 1780.941 timesteps/s, 952.803 katom-step/s
88.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 19.324     | 21.037     | 22.962     |  24.4 | 37.47
Bond    | 0.0039256  | 0.0043532  | 0.0053214  |   0.6 |  0.01
Kspace  | 19.372     | 21.203     | 22.648     |  23.6 | 37.76
Neigh   | 0.060837   | 0.063764   | 0.067899   |   1.1 |  0.11
Comm    | 10.474     | 10.62      | 10.856     |   4.1 | 18.91
Output  | 0.00060786 | 0.00067006 | 0.00093505 |   0.0 |  0.00
Modify  | 2.0855     | 2.0867     | 2.0876     |   0.0 |  3.72
Other   |            | 1.135      |            |       |  2.02

Nlocal:         66.875 ave          71 max          64 min
Histogram: 2 0 2 0 2 0 0 0 1 1
Nghost:        2691.62 ave        2704 max        2683 min
Histogram: 2 1 0 2 0 1 0 0 1 1
Neighs:        20767.4 ave       23352 max       19445 min
Histogram: 2 1 1 1 2 0 0 0 0 1

Total # of neighbors = 166139
Ave neighs/atom = 310.54019
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.25185471
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0018988614
  estimated relative force accuracy = 5.7183647e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 512
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.698 | 6.707 | 6.713 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   298.81019      35303929       475.63189      29             18             9929.2253    
    105000   300.43068      35303927       478.21131      31             18             9929.2253    
    110000   300.51792      35303926       478.35017      31             19             9929.2253    
    115000   301.09449      35303924       479.26793      33             19             9929.2253    
    120000   303.20081      35303922       482.62066      35             20             9929.2253    
    125000   305.8131       35303928       486.77878      38             20             9929.2253    
    130000   305.8131       35303928       486.77878      38             20             9929.2253    
    135000   305.8131       35303928       486.77878      38             20             9929.2253    
    140000   308.10898      35303927       490.43325      40             20             9929.2253    
    145000   308.93315      35303927       491.74514      42             20             9929.2253    
    150000   309.46345      35303922       492.58924      42             21             9929.2253    
    155000   310.42785      35303922       494.12433      43             22             9929.2253    
    160000   310.42785      35303922       494.12433      43             22             9929.2253    
    165000   312.03655      35303925       496.68497      43             23             9929.2253    
    170000   312.65022      35303930       497.66178      44             23             9929.2253    
    175000   312.65022      35303930       497.66178      44             23             9929.2253    
    180000   313.81474      35303928       499.51541      45             23             9929.2253    
    185000   316.53034      35303930       503.83798      48             23             9929.2253    
    190000   316.66965      35303931       504.05972      49             23             9929.2253    
    195000   316.94168      35303934       504.49273      50             23             9929.2253    
    200000   317.17168      35303939       504.85884      51             23             9929.2253    
Loop time of 61.974 on 8 procs for 100000 steps with 562 atoms

Performance: 139.413 ns/day, 0.172 hours/ns, 1613.580 timesteps/s, 906.832 katom-step/s
88.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.18      | 24.415     | 27.956     |  35.1 | 39.40
Bond    | 0.0042641  | 0.004748   | 0.0054432  |   0.6 |  0.01
Kspace  | 19.223     | 22.698     | 24.891     |  35.8 | 36.62
Neigh   | 0.068429   | 0.072743   | 0.080153   |   1.3 |  0.12
Comm    | 11.164     | 11.297     | 11.46      |   2.8 | 18.23
Output  | 0.00063318 | 0.00067575 | 0.00087449 |   0.0 |  0.00
Modify  | 2.2959     | 2.2968     | 2.2979     |   0.0 |  3.71
Other   |            | 1.189      |            |       |  1.92

Nlocal:          70.25 ave          75 max          66 min
Histogram: 1 0 1 2 1 1 0 0 1 1
Nghost:        2866.62 ave        2888 max        2849 min
Histogram: 1 0 2 1 1 0 2 0 0 1
Neighs:        22907.2 ave       25648 max       21327 min
Histogram: 1 3 0 1 1 0 1 0 0 1

Total # of neighbors = 183258
Ave neighs/atom = 326.08185
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 51
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 23
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:58
