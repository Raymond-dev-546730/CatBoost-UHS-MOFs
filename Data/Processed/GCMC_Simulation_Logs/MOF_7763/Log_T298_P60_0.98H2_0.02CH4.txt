LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (19.182 19.182 36.534)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  464 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.003 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.504631 4.008000  # Al
pair_coeff 2 2 0.104924 3.431000  # C
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.060014 3.118000  # O

# Gas parameters
pair_coeff 5 5 0.072930 2.958000
pair_coeff 6 6 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:4
464 atoms in group framework
group h2 type 5
0 atoms in group h2
group ch4 type 6
0 atoms in group ch4
group gases type 5 6
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[5]
variable n_ch4 equal c_type_counts[6]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23884302
  grid = 12 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0028771763
  estimated relative force accuracy = 8.6645309e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2366 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.652 | 6.654 | 6.662 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            49054702       411.27429      0              0              13442.653    
      5000   306.33288      49054698       422.77461      7              5              13442.653    
     10000   308.59273      49054690       425.89347      11             8              13442.653    
     15000   311.64979      49054678       430.11257      16             10             13442.653    
     20000   318.91636      49054685       440.14126      22             13             13442.653    
     25000   325.19549      49054683       448.80719      26             13             13442.653    
     30000   328.8946       49054669       453.91239      30             14             13442.653    
     35000   333.89858      49054664       460.81845      33             17             13442.653    
     40000   338.13368      49054671       466.66339      40             21             13442.653    
     45000   339.32094      49054666       468.30194      42             22             13442.653    
     50000   341.34745      49054665       471.09875      44             24             13442.653    
     55000   342.11893      49054662       472.16349      45             25             13442.653    
     60000   342.16595      49054661       472.22838      46             25             13442.653    
     65000   343.89575      49054660       474.61571      52             25             13442.653    
     70000   346.15681      49054653       477.73622      55             29             13442.653    
     75000   348.50102      49054653       480.9715       59             30             13442.653    
     80000   353.73944      49054659       488.20112      63             31             13442.653    
     85000   359.37827      49054656       495.98337      68             31             13442.653    
     90000   359.91463      49054661       496.7236       72             31             13442.653    
     95000   363.33326      49054665       501.4417       75             32             13442.653    
    100000   369.34098      49054664       509.73304      80             32             13442.653    
Loop time of 41.8452 on 8 procs for 100000 steps with 576 atoms

Performance: 206.475 ns/day, 0.116 hours/ns, 2389.762 timesteps/s, 1.377 Matom-step/s
88.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.466     | 14.355     | 15.749     |  17.0 | 34.30
Bond    | 0.0034561  | 0.0038312  | 0.0041521  |   0.3 |  0.01
Kspace  | 14.794     | 16.23      | 17.173     |  16.0 | 38.79
Neigh   | 0.053928   | 0.056388   | 0.059852   |   0.8 |  0.13
Comm    | 7.8758     | 8.3834     | 8.9184     |  10.7 | 20.03
Output  | 0.00041996 | 0.00050695 | 0.00062603 |   0.0 |  0.00
Modify  | 1.7092     | 1.7117     | 1.7136     |   0.1 |  4.09
Other   |            | 1.104      |            |       |  2.64

Nlocal:             72 ave          78 max          66 min
Histogram: 1 1 0 0 1 2 2 0 0 1
Nghost:        2687.88 ave        2708 max        2669 min
Histogram: 1 0 1 1 2 1 0 0 1 1
Neighs:        17429.5 ave       19644 max       16213 min
Histogram: 2 1 2 0 1 1 0 0 0 1

Total # of neighbors = 139436
Ave neighs/atom = 242.07639
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23881771
  grid = 12 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0025836395
  estimated relative force accuracy = 7.7805536e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2366 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.783 | 6.786 | 6.793 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   297.39978      49054664       509.73304      80             32             13442.653    
    105000   299.13659      49054662       512.70989      81             32             13442.653    
    110000   304.36         49054669       521.66263      85             33             13442.653    
    115000   304.54366      49054675       521.97741      86             33             13442.653    
    120000   304.53209      49054666       521.95759      85             34             13442.653    
    125000   305.69219      49054666       523.94596      87             34             13442.653    
    130000   305.69219      49054666       523.94596      87             34             13442.653    
    135000   306.07881      49054664       524.60861      87             35             13442.653    
    140000   307.55827      49054664       527.14434      90             36             13442.653    
    145000   308.37796      49054665       528.54926      92             36             13442.653    
    150000   309.37984      49054662       530.26647      92             38             13442.653    
    155000   309.37984      49054662       530.26647      92             38             13442.653    
    160000   309.80337      49054663       530.99237      94             38             13442.653    
    165000   310.97583      49054662       533.00194      95             38             13442.653    
    170000   312.92027      49054657       536.33463      97             39             13442.653    
    175000   314.09274      49054662       538.3442       98             39             13442.653    
    180000   315.11732      49054655       540.10031      100            39             13442.653    
    185000   315.74897      49054649       541.18292      101            38             13442.653    
    190000   315.74897      49054649       541.18292      101            38             13442.653    
    195000   316.37396      49054655       542.25414      103            38             13442.653    
    200000   317.19646      49054656       543.66388      105            38             13442.653    
Loop time of 50.9206 on 8 procs for 100000 steps with 607 atoms

Performance: 169.676 ns/day, 0.141 hours/ns, 1963.840 timesteps/s, 1.192 Matom-step/s
89.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 18.424     | 19.452     | 21.827     |  22.5 | 38.20
Bond    | 0.0037238  | 0.00398    | 0.0042548  |   0.3 |  0.01
Kspace  | 15.706     | 18.636     | 19.724     |  28.2 | 36.60
Neigh   | 0.065645   | 0.070958   | 0.07924    |   1.7 |  0.14
Comm    | 8.7155     | 9.3899     | 10.087     |  14.2 | 18.44
Output  | 0.00048737 | 0.00057207 | 0.00078156 |   0.0 |  0.00
Modify  | 2.1008     | 2.1037     | 2.1064     |   0.1 |  4.13
Other   |            | 1.263      |            |       |  2.48

Nlocal:         75.875 ave          81 max          72 min
Histogram: 1 0 1 2 2 0 1 0 0 1
Nghost:         2835.5 ave        2842 max        2826 min
Histogram: 1 0 1 0 0 3 0 0 0 3
Neighs:        19415.6 ave       21263 max       18334 min
Histogram: 1 1 2 1 1 1 0 0 0 1

Total # of neighbors = 155325
Ave neighs/atom = 255.88962
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 105
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 38
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:32
