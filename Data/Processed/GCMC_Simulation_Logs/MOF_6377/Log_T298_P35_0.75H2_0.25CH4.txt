LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 75.0% H₂ / 25.0% CH₄ at 35 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (36.5743 36.5743 52.9725)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  3848 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.011 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.226839 3.516000  # Cl
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
3848 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.939543
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.939543 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 0.00031 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22718641
  grid = 18 18 24
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0031610445
  estimated relative force accuracy = 9.5193915e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 3332 972
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 6 6 8
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.928 | 7.451 | 8.798 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            3.5964926e+21  3417.2185      0              0              70860.223    
      5000   299.55464      3.5964926e+21  3435.0458      10             12             70860.223    
     10000   300.31114      3.5964926e+21  3443.7207      17             21             70860.223    
     15000   301.41106      3.5964926e+21  3456.3338      27             28             70860.223    
     20000   303.28765      3.5964926e+21  3477.8529      41             36             70860.223    
     25000   304.31466      3.5964926e+21  3489.6299      47             42             70860.223    
     30000   304.95411      3.5964926e+21  3496.9626      52             47             70860.223    
     35000   306.59643      3.5964926e+21  3515.7953      64             53             70860.223    
     40000   307.91772      3.5964926e+21  3530.9468      74             63             70860.223    
     45000   308.93912      3.5964926e+21  3542.6593      82             70             70860.223    
     50000   309.97463      3.5964926e+21  3554.5337      89             74             70860.223    
     55000   310.82858      3.5964926e+21  3564.3261      94             80             70860.223    
     60000   311.52393      3.5964926e+21  3572.2998      100            85             70860.223    
     65000   312.0867       3.5964926e+21  3578.7532      107            88             70860.223    
     70000   313.1836       3.5964926e+21  3591.3316      116            95             70860.223    
     75000   314.47792      3.5964926e+21  3606.1738      129            101            70860.223    
     80000   315.98626      3.5964926e+21  3623.4701      135            108            70860.223    
     85000   317.23593      3.5964926e+21  3637.8003      142            115            70860.223    
     90000   317.53833      3.5964926e+21  3641.268       146            121            70860.223    
     95000   318.57407      3.5964926e+21  3653.1451      154            126            70860.223    
    100000   320.1028       3.5964926e+21  3670.6752      168            134            70860.223    
Loop time of 763.474 on 8 procs for 100000 steps with 4150 atoms

Performance: 11.317 ns/day, 2.121 hours/ns, 130.980 timesteps/s, 543.568 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.918     | 230.27     | 657.51     |1225.5 | 30.16
Bond    | 0.0050545  | 0.0058832  | 0.0065984  |   0.8 |  0.00
Kspace  | 55.438     | 475.13     | 615.91     | 838.1 | 62.23
Neigh   | 0.27033    | 0.59446    | 1.3903     |  49.1 |  0.08
Comm    | 16.067     | 23.103     | 25.462     |  60.7 |  3.03
Output  | 0.00064654 | 0.00096636 | 0.001417   |   0.0 |  0.00
Modify  | 31.309     | 31.376     | 31.556     |   1.5 |  4.11
Other   |            | 2.995      |            |       |  0.39

Nlocal:         518.75 ave        1049 max         328 min
Histogram: 4 0 1 0 2 0 0 0 0 1
Nghost:        6224.25 ave        7329 max        4939 min
Histogram: 1 0 0 2 1 0 2 1 0 1
Neighs:         207567 ave      575740 max       82796 min
Histogram: 4 0 1 1 1 0 0 0 0 1

Total # of neighbors = 1660538
Ave neighs/atom = 400.12964
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22718322
  grid = 18 18 24
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0030440202
  estimated relative force accuracy = 9.1669763e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 3332 972
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 7.06 | 7.584 | 8.936 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   296.80296      3.5964926e+21  3670.6752      168            134            70860.223    
    105000   298.13174      3.5964926e+21  3687.1088      176            142            70860.223    
    110000   299.34168      3.5964926e+21  3702.0725      183            148            70860.223    
    115000   300.21801      3.5964926e+21  3712.9105      186            156            70860.223    
    120000   300.97431      3.5964926e+21  3722.2639      190            159            70860.223    
    125000   301.9432       3.5964926e+21  3734.2466      197            162            70860.223    
    130000   302.45216      3.5964926e+21  3740.5411      202            167            70860.223    
    135000   303.16471      3.5964926e+21  3749.3534      206            173            70860.223    
    140000   303.79728      3.5964926e+21  3757.1767      211            178            70860.223    
    145000   304.64902      3.5964926e+21  3767.7104      216            186            70860.223    
    150000   305.61442      3.5964926e+21  3779.65        219            193            70860.223    
    155000   305.77433      3.5964926e+21  3781.6277      221            196            70860.223    
    160000   306.37166      3.5964926e+21  3789.015       227            199            70860.223    
    165000   307.49354      3.5964926e+21  3802.8897      234            205            70860.223    
    170000   307.66587      3.5964926e+21  3805.021       236            206            70860.223    
    175000   308.10896      3.5964926e+21  3810.5009      240            212            70860.223    
    180000   308.55887      3.5964926e+21  3816.0651      242            215            70860.223    
    185000   309.06666      3.5964926e+21  3822.3452      247            217            70860.223    
    190000   309.5215       3.5964926e+21  3827.9703      250            222            70860.223    
    195000   309.69286      3.5964926e+21  3830.0895      251            224            70860.223    
    200000   310.35474      3.5964926e+21  3838.2753      256            226            70860.223    
Loop time of 793.447 on 8 procs for 100000 steps with 4330 atoms

Performance: 10.889 ns/day, 2.204 hours/ns, 126.032 timesteps/s, 545.720 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 104.67     | 253.62     | 685.97     |1192.7 | 31.96
Bond    | 0.0049725  | 0.0057547  | 0.0062019  |   0.6 |  0.00
Kspace  | 55.322     | 480.34     | 626.89     | 851.9 | 60.54
Neigh   | 0.32386    | 0.66314    | 1.4617     |  47.1 |  0.08
Comm    | 16.072     | 22.977     | 25.339     |  60.6 |  2.90
Output  | 0.00068869 | 0.00099568 | 0.0014453  |   0.0 |  0.00
Modify  | 32.879     | 32.947     | 33.125     |   1.4 |  4.15
Other   |            | 2.897      |            |       |  0.37

Nlocal:         541.25 ave        1054 max         339 min
Histogram: 4 0 1 0 2 0 0 0 0 1
Nghost:        6504.38 ave        7556 max        5279 min
Histogram: 1 0 0 1 2 0 2 1 0 1
Neighs:         221581 ave      586330 max       90868 min
Histogram: 4 0 1 0 2 0 0 0 0 1

Total # of neighbors = 1772648
Ave neighs/atom = 409.38753
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 256
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 226
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:25:56
