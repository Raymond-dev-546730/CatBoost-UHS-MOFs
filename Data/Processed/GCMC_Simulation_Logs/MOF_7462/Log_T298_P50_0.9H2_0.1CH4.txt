LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (19.07 19.07 36.93)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  472 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.504631 4.008000  # Al
pair_coeff 2 2 0.104924 3.431000  # C
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.060014 3.118000  # O

# Gas parameters
pair_coeff 5 5 0.072930 2.958000
pair_coeff 6 6 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:4
472 atoms in group framework
group h2 type 5
0 atoms in group h2
group ch4 type 6
0 atoms in group ch4
group gases type 5 6
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[5]
variable n_ch4 equal c_type_counts[6]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 1.6e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23857555
  grid = 12 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0027313787
  estimated relative force accuracy = 8.2254657e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2366 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.656 | 6.659 | 6.666 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            74189177       418.38054      0              0              13430.145    
      5000   306.19134      74189171       429.88087      7              5              13430.145    
     10000   308.41281      74189166       432.99972      11             8              13430.145    
     15000   312.56344      74189171       438.82705      17             12             13430.145    
     20000   318.83721      74189171       447.63518      23             14             13430.145    
     25000   325.87906      74189180       457.52167      27             15             13430.145    
     30000   328.68434      74189163       461.46017      30             15             13430.145    
     35000   333.93875      74189162       468.83716      34             18             13430.145    
     40000   338.10193      74189170       474.6821       41             22             13430.145    
     45000   340.11634      74189171       477.51026      42             24             13430.145    
     50000   341.77299      74189171       479.83614      43             26             13430.145    
     55000   342.53138      74189168       480.90088      44             27             13430.145    
     60000   341.70527      74189160       479.74106      45             26             13430.145    
     65000   343.4057       74189160       482.12839      51             26             13430.145    
     70000   346.78226      74189157       486.86895      55             30             13430.145    
     75000   349.08665      74189154       490.10423      59             31             13430.145    
     80000   352.96183      74189156       495.54483      63             31             13430.145    
     85000   358.79262      74189160       503.73104      68             32             13430.145    
     90000   359.1795       74189165       504.27421      71             33             13430.145    
     95000   362.18481      74189173       508.49354      74             34             13430.145    
    100000   367.65358      74189173       516.17149      78             34             13430.145    
Loop time of 44.7445 on 8 procs for 100000 steps with 584 atoms

Performance: 193.097 ns/day, 0.124 hours/ns, 2234.914 timesteps/s, 1.305 Matom-step/s
88.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.743     | 15.433     | 16.313     |  10.9 | 34.49
Bond    | 0.0037298  | 0.0040399  | 0.0046799  |   0.5 |  0.01
Kspace  | 15.784     | 16.969     | 17.488     |  11.8 | 37.92
Neigh   | 0.055868   | 0.060331   | 0.063665   |   1.0 |  0.13
Comm    | 9.0338     | 9.4373     | 9.6724     |   6.3 | 21.09
Output  | 0.00051861 | 0.00058275 | 0.00078475 |   0.0 |  0.00
Modify  | 1.771      | 1.7728     | 1.7744     |   0.1 |  3.96
Other   |            | 1.068      |            |       |  2.39

Nlocal:             73 ave          77 max          68 min
Histogram: 1 1 0 0 1 1 2 0 0 2
Nghost:        2775.38 ave        2790 max        2760 min
Histogram: 1 0 1 2 0 1 0 1 0 2
Neighs:        17963.9 ave       19871 max       17097 min
Histogram: 2 2 1 1 0 1 0 0 0 1

Total # of neighbors = 143711
Ave neighs/atom = 246.08048
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23860549
  grid = 12 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0024540962
  estimated relative force accuracy = 7.3904378e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2366 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.788 | 6.79 | 6.798 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   297.02373      74189173       516.17149      78             34             13430.145    
    105000   298.08594      74189166       518.01741      78             34             13430.145    
    110000   301.69685      74189175       524.29249      81             35             13430.145    
    115000   301.56793      74189174       524.06845      82             34             13430.145    
    120000   301.56793      74189174       524.06845      82             34             13430.145    
    125000   304.54966      74189179       529.25013      84             36             13430.145    
    130000   304.3172       74189173       528.84616      84             35             13430.145    
    135000   304.69852      74189171       529.50882      84             36             13430.145    
    140000   305.30547      74189165       530.56358      85             37             13430.145    
    145000   306.43023      74189158       532.51821      86             38             13430.145    
    150000   308.88284      74189167       536.78039      86             40             13430.145    
    155000   306.94932      74189154       533.4203       85             39             13430.145    
    160000   307.08567      74189150       533.65724      87             39             13430.145    
    165000   308.62337      74189150       536.32947      88             40             13430.145    
    170000   309.2163       74189143       537.35987      90             42             13430.145    
    175000   310.37268      74189149       539.36944      91             42             13430.145    
    180000   311.67934      74189151       541.64018      93             42             13430.145    
    185000   312.55734      74189149       543.16597      94             42             13430.145    
    190000   312.55734      74189149       543.16597      94             42             13430.145    
    195000   312.46246      74189148       543.0011       94             42             13430.145    
    200000   312.48853      74189137       543.0464       94             41             13430.145    
Loop time of 50.2288 on 8 procs for 100000 steps with 607 atoms

Performance: 172.013 ns/day, 0.140 hours/ns, 1990.888 timesteps/s, 1.208 Matom-step/s
89.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 19.436     | 20.14      | 22.241     |  19.4 | 40.10
Bond    | 0.003671   | 0.0041643  | 0.0045218  |   0.4 |  0.01
Kspace  | 15.163     | 17.33      | 18.197     |  22.4 | 34.50
Neigh   | 0.069706   | 0.074082   | 0.079646   |   1.1 |  0.15
Comm    | 9.1511     | 9.4452     | 9.7326     |   5.8 | 18.80
Output  | 0.00061262 | 0.00066321 | 0.00083374 |   0.0 |  0.00
Modify  | 2.0607     | 2.0626     | 2.0647     |   0.1 |  4.11
Other   |            | 1.172      |            |       |  2.33

Nlocal:         75.875 ave          79 max          73 min
Histogram: 1 0 0 2 0 3 1 0 0 1
Nghost:           2889 ave        2907 max        2870 min
Histogram: 1 1 0 1 0 2 1 1 0 1
Neighs:        19450.5 ave       21064 max       17957 min
Histogram: 1 0 0 2 1 2 1 0 0 1

Total # of neighbors = 155604
Ave neighs/atom = 256.34926
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 94
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 41
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:34
