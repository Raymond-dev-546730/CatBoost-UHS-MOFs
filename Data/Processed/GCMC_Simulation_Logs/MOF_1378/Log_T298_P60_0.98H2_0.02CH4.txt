LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (12.717 16.73 27.427)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  228 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.003 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
228 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2410735
  grid = 8 10 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0020406309
  estimated relative force accuracy = 6.1452993e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1800 160
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 2 3 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.46 | 6.463 | 6.466 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            21437662       201.63988      0              0              5835.2426    
      5000   307.64379      21437660       208.16529      3              6              5835.2426    
     10000   315.17784      21437652       213.26316      7              9              5835.2426    
     15000   324.42954      21437653       219.52326      11             11             5835.2426    
     20000   331.25205      21437657       224.13968      16             12             5835.2426    
     25000   332.43893      21437656       224.94277      17             12             5835.2426    
     30000   339.23498      21437651       229.54127      20             13             5835.2426    
     35000   347.50373      21437660       235.13627      23             15             5835.2426    
     40000   353.29814      21437664       239.05703      24             18             5835.2426    
     45000   354.2558       21437666       239.70502      25             18             5835.2426    
     50000   353.07425      21437666       238.90553      26             18             5835.2426    
     55000   355.81176      21437669       240.75785      27             19             5835.2426    
     60000   356.49507      21437666       241.22021      29             19             5835.2426    
     65000   357.19104      21437668       241.69113      30             19             5835.2426    
     70000   360.41424      21437665       243.87209      31             20             5835.2426    
     75000   364.97468      21437662       246.95788      32             20             5835.2426    
     80000   370.72837      21437668       250.85108      34             20             5835.2426    
     85000   370.72837      21437668       250.85108      34             20             5835.2426    
     90000   372.97306      21437672       252.36994      35             21             5835.2426    
     95000   373.03686      21437670       252.41311      35             21             5835.2426    
    100000   375.74608      21437662       254.24628      36             20             5835.2426    
Loop time of 30.8155 on 8 procs for 100000 steps with 284 atoms

Performance: 280.379 ns/day, 0.086 hours/ns, 3245.124 timesteps/s, 921.615 katom-step/s
87.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.0938     | 8.1393     | 10.573     |  49.6 | 26.41
Bond    | 0.0034893  | 0.0038243  | 0.004283   |   0.4 |  0.01
Kspace  | 9.39       | 11.805     | 13.976     |  45.6 | 38.31
Neigh   | 0.031495   | 0.036638   | 0.043307   |   2.6 |  0.12
Comm    | 7.7412     | 8.6141     | 9.2768     |  16.8 | 27.95
Output  | 0.00042373 | 0.00051829 | 0.00066204 |   0.0 |  0.00
Modify  | 1.2346     | 1.238      | 1.2421     |   0.2 |  4.02
Other   |            | 0.9776     |            |       |  3.17

Nlocal:           35.5 ave          41 max          31 min
Histogram: 1 2 1 0 0 0 1 0 2 1
Nghost:        2475.62 ave        2509 max        2423 min
Histogram: 1 0 0 0 2 1 1 0 1 2
Neighs:           9867 ave       12004 max        8012 min
Histogram: 1 0 2 2 0 0 1 0 1 1

Total # of neighbors = 78936
Ave neighs/atom = 277.94366
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2410724
  grid = 8 10 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0018284475
  estimated relative force accuracy = 5.5063154e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1800 160
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.591 | 6.594 | 6.597 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   301.3935       21437662       254.24628      36             20             5835.2426    
    105000   302.6235       21437666       255.28388      36             21             5835.2426    
    110000   301.3935       21437662       254.24628      36             20             5835.2426    
    115000   301.3935       21437662       254.24628      36             20             5835.2426    
    120000   304.2066       21437662       256.61933      38             19             5835.2426    
    125000   304.46946      21437664       256.84107      39             19             5835.2426    
    130000   302.25999      21437659       254.97723      38             19             5835.2426    
    135000   302.25999      21437659       254.97723      38             19             5835.2426    
    140000   302.25999      21437659       254.97723      38             19             5835.2426    
    145000   302.89492      21437657       255.51284      39             19             5835.2426    
    150000   301.18097      21437656       254.06701      40             18             5835.2426    
    155000   304.73423      21437659       257.06443      41             19             5835.2426    
    160000   304.73423      21437659       257.06443      41             19             5835.2426    
    165000   306.89784      21437664       258.88958      43             19             5835.2426    
    170000   309.28006      21437664       260.89915      44             19             5835.2426    
    175000   311.19189      21437656       262.51191      46             18             5835.2426    
    180000   312.50898      21437661       263.62297      47             18             5835.2426    
    185000   311.6259       21437657       262.87803      47             18             5835.2426    
    190000   311.75416      21437662       262.98622      48             18             5835.2426    
    195000   311.75416      21437662       262.98622      48             18             5835.2426    
    200000   313.95152      21437666       264.83985      49             18             5835.2426    
Loop time of 33.8202 on 8 procs for 100000 steps with 295 atoms

Performance: 255.468 ns/day, 0.094 hours/ns, 2956.810 timesteps/s, 872.259 katom-step/s
88.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.591      | 9.5417     | 12.075     |  47.7 | 28.21
Bond    | 0.0036677  | 0.0040481  | 0.0046451  |   0.5 |  0.01
Kspace  | 11.045     | 13.1       | 15.27      |  42.9 | 38.73
Neigh   | 0.035459   | 0.041887   | 0.047907   |   2.4 |  0.12
Comm    | 8.2912     | 8.7915     | 9.2459     |  12.4 | 25.99
Output  | 0.00050649 | 0.00055759 | 0.00070774 |   0.0 |  0.00
Modify  | 1.3926     | 1.396      | 1.3993     |   0.2 |  4.13
Other   |            | 0.9446     |            |       |  2.79

Nlocal:         36.875 ave          42 max          33 min
Histogram: 1 2 1 0 1 0 0 2 0 1
Nghost:        2567.38 ave        2605 max        2521 min
Histogram: 1 0 0 1 2 0 1 1 1 1
Neighs:          10653 ave       12884 max        9110 min
Histogram: 2 1 0 1 1 0 1 1 0 1

Total # of neighbors = 85224
Ave neighs/atom = 288.89492
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 49
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 18
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:04
