LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (12.717 16.73 27.427)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  228 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.003 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
228 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2410735
  grid = 8 10 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0020406309
  estimated relative force accuracy = 6.1452993e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1800 160
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 2 3 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.46 | 6.463 | 6.466 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            21437662       201.63988      0              0              5835.2426    
      5000   307.64379      21437660       208.16529      3              6              5835.2426    
     10000   315.77621      21437656       213.66804      8              9              5835.2426    
     15000   325.02791      21437663       219.92815      12             11             5835.2426    
     20000   331.85043      21437667       224.54456      17             12             5835.2426    
     25000   333.0373       21437666       225.34765      18             12             5835.2426    
     30000   339.5658       21437651       229.76512      21             12             5835.2426    
     35000   347.83456      21437660       235.36012      24             14             5835.2426    
     40000   353.62897      21437664       239.28088      25             17             5835.2426    
     45000   354.58662      21437666       239.92887      26             17             5835.2426    
     50000   352.75012      21437662       238.68621      27             16             5835.2426    
     55000   355.48763      21437665       240.53853      28             17             5835.2426    
     60000   353.45598      21437658       239.16382      30             16             5835.2426    
     65000   354.15195      21437660       239.63475      31             16             5835.2426    
     70000   357.37515      21437657       241.81571      32             17             5835.2426    
     75000   362.07111      21437658       244.9932       34             17             5835.2426    
     80000   367.8248       21437664       248.8864       36             17             5835.2426    
     85000   371.52825      21437659       251.39232      36             17             5835.2426    
     90000   373.77294      21437663       252.91117      37             18             5835.2426    
     95000   373.83674      21437661       252.95434      37             18             5835.2426    
    100000   378.50022      21437654       256.10986      39             17             5835.2426    
Loop time of 31.7547 on 8 procs for 100000 steps with 284 atoms

Performance: 272.086 ns/day, 0.088 hours/ns, 3149.145 timesteps/s, 894.357 katom-step/s
86.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.1539     | 8.099      | 10.45      |  50.7 | 25.51
Bond    | 0.0034256  | 0.0036799  | 0.0039898  |   0.3 |  0.01
Kspace  | 10.217     | 12.482     | 14.556     |  38.2 | 39.31
Neigh   | 0.030771   | 0.035395   | 0.041541   |   2.0 |  0.11
Comm    | 8.4913     | 8.7787     | 9.0309     |   5.9 | 27.65
Output  | 0.00050413 | 0.00056839 | 0.00074746 |   0.0 |  0.00
Modify  | 1.297      | 1.3006     | 1.3032     |   0.2 |  4.10
Other   |            | 1.055      |            |       |  3.32

Nlocal:           35.5 ave          40 max          31 min
Histogram: 1 3 0 0 0 0 1 0 0 3
Nghost:        2472.75 ave        2519 max        2416 min
Histogram: 1 0 1 1 1 1 0 0 1 2
Neighs:         9867.5 ave       12197 max        7946 min
Histogram: 1 2 0 1 1 0 1 0 0 2

Total # of neighbors = 78940
Ave neighs/atom = 277.95775
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2410724
  grid = 8 10 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0018284475
  estimated relative force accuracy = 5.5063154e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1800 160
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.591 | 6.594 | 6.597 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   303.60265      21437654       256.10986      39             17             5835.2426    
    105000   307.04163      21437652       259.01088      39             18             5835.2426    
    110000   305.81163      21437648       257.97328      39             17             5835.2426    
    115000   305.81163      21437648       257.97328      39             17             5835.2426    
    120000   311.65992      21437654       262.90673      42             18             5835.2426    
    125000   311.92279      21437655       263.12847      43             18             5835.2426    
    130000   311.92279      21437655       263.12847      43             18             5835.2426    
    135000   311.92279      21437655       263.12847      43             18             5835.2426    
    140000   311.92279      21437655       263.12847      43             18             5835.2426    
    145000   311.92279      21437655       263.12847      43             18             5835.2426    
    150000   310.08646      21437655       261.5794       43             18             5835.2426    
    155000   312.08009      21437655       263.26117      44             19             5835.2426    
    160000   312.08009      21437655       263.26117      44             19             5835.2426    
    165000   313.37239      21437655       264.35131      45             19             5835.2426    
    170000   315.22518      21437650       265.91427      45             19             5835.2426    
    175000   318.37003      21437654       268.56716      47             19             5835.2426    
    180000   318.9458       21437648       269.05287      46             19             5835.2426    
    185000   317.75682      21437637       268.04988      45             19             5835.2426    
    190000   317.88507      21437641       268.15807      46             19             5835.2426    
    195000   317.88507      21437641       268.15807      46             19             5835.2426    
    200000   320.08244      21437645       270.0117       47             19             5835.2426    
Loop time of 34.9417 on 8 procs for 100000 steps with 294 atoms

Performance: 247.269 ns/day, 0.097 hours/ns, 2861.913 timesteps/s, 841.402 katom-step/s
88.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.5608     | 9.6745     | 12.305     |  53.8 | 27.69
Bond    | 0.0034458  | 0.0038223  | 0.0042355  |   0.4 |  0.01
Kspace  | 10.655     | 13.714     | 16.427     |  45.1 | 39.25
Neigh   | 0.034665   | 0.040956   | 0.047801   |   2.1 |  0.12
Comm    | 8.554      | 9.0741     | 9.6954     |  13.5 | 25.97
Output  | 0.0004616  | 0.00052736 | 0.00065949 |   0.0 |  0.00
Modify  | 1.4096     | 1.4148     | 1.4184     |   0.3 |  4.05
Other   |            | 1.019      |            |       |  2.92

Nlocal:          36.75 ave          41 max          33 min
Histogram: 1 3 0 0 0 1 0 0 1 2
Nghost:        2560.88 ave        2601 max        2506 min
Histogram: 1 0 0 2 0 2 0 0 1 2
Neighs:        10581.9 ave       12837 max        8755 min
Histogram: 2 0 1 0 2 1 0 0 1 1

Total # of neighbors = 84655
Ave neighs/atom = 287.94218
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 47
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 19
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:06
