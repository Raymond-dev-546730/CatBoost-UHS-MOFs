LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 75.0% H₂ / 25.0% CH₄ at 35 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (19.519 19.519 49.1068)
  2 by 1 by 4 MPI processor grid
  reading atoms ...
  424 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.598566 3.976000  # In
pair_coeff 4 4 0.068956 3.261000  # N
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
424 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.939543
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.939543 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 3e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23873254
  grid = 12 12 24
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0019317407
  estimated relative force accuracy = 5.8173796e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2717 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 8
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.643 | 6.644 | 6.644 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            49254096       375.74303      0              0              18709.267    
      5000   309.19432      49254093       389.85775      10             5              18709.267    
     10000   318.52963      49254084       401.62849      19             12             18709.267    
     15000   320.27611      49254079       403.83059      22             15             18709.267    
     20000   334.58522      49254075       421.8727       33             23             18709.267    
     25000   340.89965      49254084       429.83445      39             27             18709.267    
     30000   348.0989       49254087       438.91186      46             30             18709.267    
     35000   360.67822      49254104       454.77291      55             31             18709.267    
     40000   368.60355      49254089       464.76583      63             35             18709.267    
     45000   373.41779      49254100       470.83601      66             39             18709.267    
     50000   376.9745       49254103       475.32061      69             42             18709.267    
     55000   383.46489      49254105       483.50423      74             47             18709.267    
     60000   385.90549      49254109       486.58154      76             50             18709.267    
     65000   391.36771      49254108       493.46876      81             52             18709.267    
     70000   398.70351      49254102       502.71834      86             57             18709.267    
     75000   401.76864      49254099       506.5831       91             57             18709.267    
     80000   403.34008      49254094       508.56451      93             58             18709.267    
     85000   406.8289       49254081       512.9635       96             61             18709.267    
     90000   412.4158       49254092       520.00793      99             63             18709.267    
     95000   410.20292      49254081       517.21775      99             65             18709.267    
    100000   414.68422      49254076       522.86814      106            68             18709.267    
Loop time of 35.7885 on 8 procs for 100000 steps with 598 atoms

Performance: 241.419 ns/day, 0.099 hours/ns, 2794.197 timesteps/s, 1.671 Matom-step/s
90.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.4489     | 9.941      | 12.568     |  43.8 | 27.78
Bond    | 0.0035486  | 0.0037725  | 0.0041173  |   0.3 |  0.01
Kspace  | 14.764     | 17.22      | 19.403     |  30.2 | 48.12
Neigh   | 0.038731   | 0.04526    | 0.052301   |   1.9 |  0.13
Comm    | 6.0149     | 6.2032     | 6.3078     |   4.3 | 17.33
Output  | 0.00047445 | 0.00052871 | 0.0007008  |   0.0 |  0.00
Modify  | 1.4702     | 1.4735     | 1.4765     |   0.2 |  4.12
Other   |            | 0.9012     |            |       |  2.52

Nlocal:          74.75 ave          87 max          65 min
Histogram: 2 0 2 0 0 2 0 1 0 1
Nghost:        2239.62 ave        2269 max        2218 min
Histogram: 1 0 3 1 0 1 0 1 0 1
Neighs:        13451.5 ave       15945 max       11085 min
Histogram: 1 0 1 1 1 2 0 1 0 1

Total # of neighbors = 107612
Ave neighs/atom = 179.95318
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23872948
  grid = 12 12 24
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0016267001
  estimated relative force accuracy = 4.8987589e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2717 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.776 | 6.777 | 6.778 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   293.82148      49254076       522.86814      106            68             18709.267    
    105000   295.41579      49254085       525.70528      109            68             18709.267    
    110000   297.75107      49254086       529.861        112            71             18709.267    
    115000   298.24341      49254092       530.73716      113            72             18709.267    
    120000   297.19032      49254087       528.86313      112            73             18709.267    
    125000   301.50028      49254080       536.53289      115            75             18709.267    
    130000   304.45012      49254090       541.78226      120            77             18709.267    
    135000   306.86044      49254073       546.07153      122            78             18709.267    
    140000   307.84606      49254063       547.82549      125            77             18709.267    
    145000   308.37105      49254064       548.75973      126            77             18709.267    
    150000   308.85185      49254072       549.61534      127            78             18709.267    
    155000   309.52005      49254068       550.80443      127            78             18709.267    
    160000   310.34816      49254066       552.27809      128            80             18709.267    
    165000   311.24407      49254065       553.87238      130            80             18709.267    
    170000   312.10043      49254072       555.39633      131            81             18709.267    
    175000   314.176        49254062       559.08989      134            81             18709.267    
    180000   315.65304      49254070       561.71836      137            81             18709.267    
    185000   314.49689      49254063       559.66093      136            80             18709.267    
    190000   315.48127      49254060       561.41267      138            81             18709.267    
    195000   316.46102      49254053       563.15618      141            80             18709.267    
    200000   318.28093      49254050       566.3948       144            80             18709.267    
Loop time of 42.6734 on 8 procs for 100000 steps with 648 atoms

Performance: 202.468 ns/day, 0.119 hours/ns, 2343.381 timesteps/s, 1.519 Matom-step/s
91.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 12.151     | 15.016     | 17.558     |  38.7 | 35.19
Bond    | 0.003555   | 0.0039254  | 0.0047746  |   0.6 |  0.01
Kspace  | 15.219     | 17.758     | 20.498     |  34.1 | 41.61
Neigh   | 0.054892   | 0.062479   | 0.067741   |   1.7 |  0.15
Comm    | 6.8431     | 7.0518     | 7.2621     |   4.7 | 16.52
Output  | 0.00048766 | 0.00054611 | 0.00067889 |   0.0 |  0.00
Modify  | 1.807      | 1.81       | 1.8128     |   0.2 |  4.24
Other   |            | 0.9702     |            |       |  2.27

Nlocal:             81 ave          88 max          71 min
Histogram: 1 0 2 0 0 1 0 0 2 2
Nghost:        2419.88 ave        2443 max        2389 min
Histogram: 1 1 0 0 1 0 1 3 0 1
Neighs:        15858.5 ave       16936 max       13957 min
Histogram: 2 0 0 0 0 1 1 0 0 4

Total # of neighbors = 126868
Ave neighs/atom = 195.78395
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 144
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 80
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:18
