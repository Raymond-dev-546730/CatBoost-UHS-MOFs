LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (30.926 30.926 35.157)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  574 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
574 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -2.5e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22873033
  grid = 15 15 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0030374209
  estimated relative force accuracy = 9.1471027e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2704 675
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 5 5 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.609 | 6.617 | 6.63 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            59286036       508.98524      0              0              33624.769    
      5000   305.33107      59286039       521.50673      8              8              33624.769    
     10000   310.22349      59286039       529.86301      16             14             33624.769    
     15000   317.97853      59286048       543.10865      27             22             33624.769    
     20000   325.16721      59286047       555.38695      37             27             33624.769    
     25000   334.32284      59286037       571.0248       45             31             33624.769    
     30000   339.72754      59286035       580.25604      49             37             33624.769    
     35000   349.27476      59286045       596.56274      54             45             33624.769    
     40000   356.7284       59286045       609.2936       65             55             33624.769    
     45000   361.48527      59286045       617.41834      71             58             33624.769    
     50000   365.41246      59286054       624.126        76             64             33624.769    
     55000   369.50526      59286047       631.11653      79             67             33624.769    
     60000   372.5206       59286034       636.26674      83             71             33624.769    
     65000   379.16981      59286043       647.62361      92             76             33624.769    
     70000   385.25138      59286043       658.01097      98             82             33624.769    
     75000   393.09189      59286041       671.40259      107            88             33624.769    
     80000   398.34755      59286020       680.37927      113            88             33624.769    
     85000   405.97157      59286020       693.40113      121            91             33624.769    
     90000   410.43476      59286022       701.02427      129            94             33624.769    
     95000   413.08468      59286020       705.55036      133            96             33624.769    
    100000   423.1172       59286025       722.68593      146            99             33624.769    
Loop time of 41.3423 on 8 procs for 100000 steps with 819 atoms

Performance: 208.987 ns/day, 0.115 hours/ns, 2418.827 timesteps/s, 1.981 Matom-step/s
87.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 9.5784     | 10.482     | 11.136     |  17.8 | 25.35
Bond    | 0.0034116  | 0.0036757  | 0.0040192  |   0.3 |  0.01
Kspace  | 21.003     | 21.688     | 22.62      |  13.0 | 52.46
Neigh   | 0.038499   | 0.0419     | 0.046546   |   1.2 |  0.10
Comm    | 6.7565     | 6.9474     | 7.1598     |   5.4 | 16.80
Output  | 0.00047309 | 0.00052571 | 0.00069973 |   0.0 |  0.00
Modify  | 1.4053     | 1.4085     | 1.4106     |   0.1 |  3.41
Other   |            | 0.771      |            |       |  1.87

Nlocal:        102.375 ave         107 max          99 min
Histogram: 1 2 1 1 0 0 1 0 1 1
Nghost:        1945.62 ave        1960 max        1925 min
Histogram: 1 1 1 0 0 0 1 1 0 3
Neighs:        14250.6 ave       15571 max       13059 min
Histogram: 2 0 1 0 1 0 2 1 0 1

Total # of neighbors = 114005
Ave neighs/atom = 139.20024
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22648684
  grid = 15 15 16
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0029452909
  estimated relative force accuracy = 8.869656e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 512
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.725 | 6.739 | 6.756 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   296.38894      59286025       722.68593      146            99             33624.769    
    105000   297.65375      59286009       725.76993      148            102            33624.769    
    110000   298.83009      59286011       728.6382       152            105            33624.769    
    115000   301.56295      59286018       735.30172      157            109            33624.769    
    120000   303.60632      59286014       740.28409      161            108            33624.769    
    125000   308.06446      59286025       751.15438      166            111            33624.769    
    130000   308.82844      59286034       753.0172       169            112            33624.769    
    135000   309.75251      59286023       755.27036      173            112            33624.769    
    140000   312.10404      59286011       761.00409      176            115            33624.769    
    145000   315.2666       59286024       768.71537      179            118            33624.769    
    150000   318.03512      59286017       775.46587      181            120            33624.769    
    155000   319.40822      59286017       778.8139       184            121            33624.769    
    160000   321.62925      59286025       784.22945      187            123            33624.769    
    165000   324.61413      59286038       791.50749      190            125            33624.769    
    170000   326.53383      59286039       796.18829      194            126            33624.769    
    175000   329.48022      59286034       803.37247      200            128            33624.769    
    180000   331.6345       59286036       808.62526      205            128            33624.769    
    185000   331.96234      59286033       809.42465      205            129            33624.769    
    190000   333.1777       59286032       812.38806      209            132            33624.769    
    195000   333.25274      59286028       812.57103      210            132            33624.769    
    200000   334.54818      59286033       815.7297       211            134            33624.769    
Loop time of 48.5886 on 8 procs for 100000 steps with 919 atoms

Performance: 177.819 ns/day, 0.135 hours/ns, 2058.096 timesteps/s, 1.891 Matom-step/s
89.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 15.337     | 17.188     | 18.959     |  28.7 | 35.38
Bond    | 0.0036756  | 0.0038391  | 0.0040907  |   0.2 |  0.01
Kspace  | 18.471     | 20.192     | 22.508     |  29.4 | 41.56
Neigh   | 0.059319   | 0.062626   | 0.06891    |   1.2 |  0.13
Comm    | 7.9022     | 8.3212     | 9.0163     |  13.5 | 17.13
Output  | 0.00044017 | 0.00050872 | 0.00063167 |   0.0 |  0.00
Modify  | 1.8298     | 1.8318     | 1.8353     |   0.1 |  3.77
Other   |            | 0.988      |            |       |  2.03

Nlocal:        114.875 ave         119 max         108 min
Histogram: 1 0 0 0 1 1 1 2 0 2
Nghost:        2183.75 ave        2207 max        2159 min
Histogram: 2 0 1 1 0 1 0 0 0 3
Neighs:        17956.4 ave       19701 max       16479 min
Histogram: 1 2 0 0 0 2 2 0 0 1

Total # of neighbors = 143651
Ave neighs/atom = 156.3123
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 211
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 134
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:29
