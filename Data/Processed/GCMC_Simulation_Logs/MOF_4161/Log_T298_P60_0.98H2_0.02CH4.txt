LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (26.3989 26.3989 19.2174)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  370 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
370 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -1.4e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2127562
  grid = 10 10 8
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0022717586
  estimated relative force accuracy = 6.8413336e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 900 100
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 4 4 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.408 | 6.408 | 6.408 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            44453711       327.77583      0              0              13392.643    
      5000   308.79344      44453703       339.64774      7              6              13392.643    
     10000   315.31223      44453700       346.81788      15             9              13392.643    
     15000   323.34507      44453688       355.65335      23             15             13392.643    
     20000   340.58906      44453688       374.62035      36             20             13392.643    
     25000   351.45052      44453687       386.56708      41             22             13392.643    
     30000   356.52102      44453683       392.14422      43             25             13392.643    
     35000   365.11553      44453679       401.59747      47             30             13392.643    
     40000   373.29861      44453672       410.5982       57             35             13392.643    
     45000   375.80174      44453665       413.35144      60             37             13392.643    
     50000   380.85682      44453663       418.91162      63             41             13392.643    
     55000   384.92885      44453657       423.39052      67             42             13392.643    
     60000   387.77381      44453647       426.51975      70             43             13392.643    
     65000   393.33622      44453653       432.63794      76             45             13392.643    
     70000   398.65188      44453652       438.48474      80             49             13392.643    
     75000   401.6629       44453659       441.79662      82             50             13392.643    
     80000   407.91669      44453657       448.67528      84             51             13392.643    
     85000   409.20056      44453652       450.08744      85             51             13392.643    
     90000   411.62872      44453658       452.75821      89             53             13392.643    
     95000   413.39292      44453651       454.69869      91             53             13392.643    
    100000   416.79241      44453655       458.43785      94             54             13392.643    
Loop time of 29.6253 on 8 procs for 100000 steps with 518 atoms

Performance: 291.643 ns/day, 0.082 hours/ns, 3375.498 timesteps/s, 1.749 Matom-step/s
87.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 8.9772     | 10.497     | 11.555     |  24.2 | 35.43
Bond    | 0.0036489  | 0.0037905  | 0.0038885  |   0.2 |  0.01
Kspace  | 8.1563     | 9.1497     | 10.427     |  22.4 | 30.88
Neigh   | 0.04631    | 0.048349   | 0.051245   |   0.7 |  0.16
Comm    | 7.6523     | 7.8074     | 8.0428     |   4.8 | 26.35
Output  | 0.00050855 | 0.0005476  | 0.00071887 |   0.0 |  0.00
Modify  | 1.3329     | 1.334      | 1.3356     |   0.1 |  4.50
Other   |            | 0.7846     |            |       |  2.65

Nlocal:          64.75 ave          71 max          61 min
Histogram: 1 2 2 0 0 1 0 0 0 2
Nghost:         2333.5 ave        2357 max        2306 min
Histogram: 1 0 2 1 0 0 0 1 1 2
Neighs:        13842.5 ave       14766 max       12097 min
Histogram: 1 0 0 0 0 3 0 1 1 2

Total # of neighbors = 110740
Ave neighs/atom = 213.78378
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.21275593
  grid = 10 10 8
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0019199932
  estimated relative force accuracy = 5.7820025e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 900 100
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.541 | 6.541 | 6.542 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   297.47853      44453655       458.43785      94             54             13392.643    
    105000   299.35535      44453661       461.33019      95             56             13392.643    
    110000   298.39684      44453655       459.85304      96             56             13392.643    
    115000   298.62315      44453653       460.2018       96             57             13392.643    
    120000   302.56151      44453650       466.27113      99             57             13392.643    
    125000   302.7054       44453650       466.49288      100            57             13392.643    
    130000   303.87651      44453654       468.29765      102            58             13392.643    
    135000   303.67892      44453648       467.99315      103            58             13392.643    
    140000   304.67686      44453646       469.53104      105            59             13392.643    
    145000   305.90971      44453636       471.43097      105            59             13392.643    
    150000   306.42358      44453641       472.22288      106            60             13392.643    
    155000   306.93326      44453644       473.00834      107            60             13392.643    
    160000   307.52605      44453637       473.92187      107            61             13392.643    
    165000   313.00512      44453646       482.36555      113            62             13392.643    
    170000   313.00512      44453646       482.36555      113            62             13392.643    
    175000   313.29405      44453638       482.81082      114            62             13392.643    
    180000   314.04042      44453645       483.96104      116            62             13392.643    
    185000   316.25466      44453657       487.37334      120            62             13392.643    
    190000   318.16953      44453665       490.32432      124            63             13392.643    
    195000   317.21975      44453656       488.86063      124            63             13392.643    
    200000   316.8127       44453653       488.23333      124            63             13392.643    
Loop time of 36.1575 on 8 procs for 100000 steps with 557 atoms

Performance: 238.954 ns/day, 0.100 hours/ns, 2765.674 timesteps/s, 1.540 Matom-step/s
88.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.481     | 14.678     | 15.642     |  19.0 | 40.59
Bond    | 0.003635   | 0.0038512  | 0.0041429  |   0.2 |  0.01
Kspace  | 8.4221     | 9.9123     | 11.034     |  25.0 | 27.41
Neigh   | 0.060135   | 0.064343   | 0.068323   |   1.1 |  0.18
Comm    | 8.3659     | 8.866      | 9.3116     |   9.8 | 24.52
Output  | 0.00053749 | 0.00058141 | 0.00075503 |   0.0 |  0.00
Modify  | 1.6962     | 1.6991     | 1.7012     |   0.1 |  4.70
Other   |            | 0.9334     |            |       |  2.58

Nlocal:         69.625 ave          75 max          63 min
Histogram: 1 0 1 1 1 1 0 0 0 3
Nghost:        2511.38 ave        2529 max        2492 min
Histogram: 1 0 2 0 1 1 1 0 0 2
Neighs:        16120.6 ave       18449 max       15219 min
Histogram: 3 1 1 1 1 0 0 0 0 1

Total # of neighbors = 128965
Ave neighs/atom = 231.53501
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 124
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 63
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:05
