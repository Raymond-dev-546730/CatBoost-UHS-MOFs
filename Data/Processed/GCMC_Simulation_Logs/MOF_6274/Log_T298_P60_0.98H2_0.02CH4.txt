LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (10.2186 15.2343 36.8564)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  280 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.003 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
280 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23580632
  grid = 8 9 16
  stencil order = 5
  estimated absolute RMS force accuracy = 0.002396689
  estimated relative force accuracy = 7.2175577e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1485 160
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 2 3 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.471 | 6.478 | 6.486 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            82077638       247.83051      0              0              5737.5544    
      5000   304.58868      82077636       253.30996      5              2              5737.5544    
     10000   309.47106      82077620       257.37037      10             4              5737.5544    
     15000   312.874        82077616       260.20041      13             5              5737.5544    
     20000   320.90311      82077614       266.87779      18             7              5737.5544    
     25000   321.26358      82077613       267.17758      18             8              5737.5544    
     30000   322.30727      82077611       268.04556      20             8              5737.5544    
     35000   323.07015      82077615       268.68         21             8              5737.5544    
     40000   323.37754      82077615       268.93564      23             8              5737.5544    
     45000   325.28582      82077613       270.52265      26             8              5737.5544    
     50000   325.28582      82077613       270.52265      26             8              5737.5544    
     55000   327.55575      82077615       272.41043      27             8              5737.5544    
     60000   328.03422      82077616       272.80835      28             8              5737.5544    
     65000   329.08276      82077618       273.68036      29             8              5737.5544    
     70000   330.13649      82077627       274.55669      31             9              5737.5544    
     75000   333.54744      82077634       277.3934       34             10             5737.5544    
     80000   333.54744      82077634       277.3934       34             10             5737.5544    
     85000   332.48387      82077622       276.50888      33             10             5737.5544    
     90000   332.48387      82077622       276.50888      33             10             5737.5544    
     95000   334.0451       82077618       277.80727      33             11             5737.5544    
    100000   338.69339      82077611       281.67301      34             11             5737.5544    
Loop time of 35.1916 on 8 procs for 100000 steps with 325 atoms

Performance: 245.513 ns/day, 0.098 hours/ns, 2841.584 timesteps/s, 923.515 katom-step/s
88.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 9.7642     | 11.523     | 13.97      |  36.5 | 32.74
Bond    | 0.0033711  | 0.003794   | 0.0042002  |   0.4 |  0.01
Kspace  | 9.584      | 12.181     | 13.729     |  37.0 | 34.61
Neigh   | 0.03839    | 0.043799   | 0.051477   |   1.9 |  0.12
Comm    | 8.5371     | 8.8842     | 9.0775     |   5.2 | 25.25
Output  | 0.00052599 | 0.00057152 | 0.00074887 |   0.0 |  0.00
Modify  | 1.4774     | 1.4788     | 1.4802     |   0.1 |  4.20
Other   |            | 1.076      |            |       |  3.06

Nlocal:         40.625 ave          45 max          38 min
Histogram: 2 2 0 0 1 1 0 1 0 1
Nghost:        2776.38 ave        2786 max        2765 min
Histogram: 2 1 0 0 1 0 0 1 0 3
Neighs:        13255.4 ave       16007 max       11401 min
Histogram: 1 1 1 1 2 0 1 0 0 1

Total # of neighbors = 106043
Ave neighs/atom = 326.28615
Ave special neighs/atom = 0
Neighbor list builds = 1285
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23580621
  grid = 8 9 16
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0022245894
  estimated relative force accuracy = 6.699285e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1485 160
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.601 | 6.608 | 6.616 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   291.65264      82077611       281.67301      34             11             5737.5544    
    105000   292.98804      82077615       282.96271      35             11             5737.5544    
    110000   292.98804      82077615       282.96271      35             11             5737.5544    
    115000   299.93236      82077620       289.66941      38             11             5737.5544    
    120000   302.55982      82077627       292.20697      39             13             5737.5544    
    125000   303.32087      82077628       292.94198      40             13             5737.5544    
    130000   303.32087      82077628       292.94198      40             13             5737.5544    
    135000   303.17709      82077623       292.80312      40             12             5737.5544    
    140000   302.76508      82077618       292.4052       39             12             5737.5544    
    145000   302.76508      82077618       292.4052       39             12             5737.5544    
    150000   302.76508      82077618       292.4052       39             12             5737.5544    
    155000   304.69867      82077618       294.27263      40             12             5737.5544    
    160000   305.22069      82077620       294.77679      41             12             5737.5544    
    165000   305.22069      82077620       294.77679      41             12             5737.5544    
    170000   305.22069      82077620       294.77679      41             12             5737.5544    
    175000   305.22069      82077620       294.77679      41             12             5737.5544    
    180000   303.88529      82077616       293.48708      40             12             5737.5544    
    185000   300.5187       82077612       290.23569      39             12             5737.5544    
    190000   301.77179      82077614       291.4459       40             13             5737.5544    
    195000   304.44986      82077621       294.03233      42             13             5737.5544    
    200000   304.44986      82077621       294.03233      42             13             5737.5544    
Loop time of 38.2158 on 8 procs for 100000 steps with 335 atoms

Performance: 226.084 ns/day, 0.106 hours/ns, 2616.718 timesteps/s, 876.600 katom-step/s
89.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.727     | 13.263     | 16.256     |  43.6 | 34.71
Bond    | 0.0035023  | 0.003819   | 0.004336   |   0.4 |  0.01
Kspace  | 9.3071     | 11.959     | 14.775     |  48.6 | 31.29
Neigh   | 0.044217   | 0.049139   | 0.058966   |   2.1 |  0.13
Comm    | 9.0841     | 9.7546     | 10.438     |  15.9 | 25.53
Output  | 0.00048092 | 0.00061196 | 0.00069744 |   0.0 |  0.00
Modify  | 1.6212     | 1.6242     | 1.6258     |   0.1 |  4.25
Other   |            | 1.561      |            |       |  4.08

Nlocal:         41.875 ave          45 max          38 min
Histogram: 1 0 2 0 1 1 0 0 1 2
Nghost:        2863.12 ave        2876 max        2852 min
Histogram: 2 0 1 1 0 1 0 2 0 1
Neighs:        14073.5 ave       16450 max       11674 min
Histogram: 1 0 1 1 1 1 1 1 0 1

Total # of neighbors = 112588
Ave neighs/atom = 336.08358
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 42
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 13
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:13
