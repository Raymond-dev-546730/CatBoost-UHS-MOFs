LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (37.726 37.726 37.726)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  1736 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.006 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.060014 3.118000  # O
pair_coeff 3 3 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 4 4 0.072930 2.958000
pair_coeff 5 5 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:3
1736 atoms in group framework
group h2 type 4
0 atoms in group h2
group ch4 type 5
0 atoms in group ch4
group gases type 4 5
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[4]
variable n_ch4 equal c_type_counts[5]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 4 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 4 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 5 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 5 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 0.000184 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.21407932
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0029980313
  estimated relative force accuracy = 9.0284821e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 512
Generated 10 of 10 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 6 6 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.721 | 6.729 | 6.734 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            57539918       1541.1682      0              0              53693.57     
      5000   300.09864      57539915       1552.0218      8              3              53693.57     
     10000   301.99035      57539915       1561.8051      18             8              53693.57     
     15000   303.48249      57539907       1569.522       26             11             53693.57     
     20000   306.4988       57539902       1585.1215      36             16             53693.57     
     25000   309.48935      57539896       1600.5877      41             22             53693.57     
     30000   310.69933      57539903       1606.8454      45             25             53693.57     
     35000   313.30004      57539905       1620.2955      52             31             53693.57     
     40000   315.42513      57539889       1631.2858      58             39             53693.57     
     45000   317.0197       57539874       1639.5325      60             45             53693.57     
     50000   318.95757      57539874       1649.5546      65             52             53693.57     
     55000   320.11647      57539873       1655.5481      67             57             53693.57     
     60000   322.10271      57539877       1665.8203      74             62             53693.57     
     65000   323.74058      57539873       1674.2909      81             64             53693.57     
     70000   325.70967      57539874       1684.4745      88             69             53693.57     
     75000   328.30281      57539865       1697.8854      98             73             53693.57     
     80000   329.61027      57539849       1704.6472      102            76             53693.57     
     85000   331.47006      57539849       1714.2655      109            79             53693.57     
     90000   332.92577      57539844       1721.794       115            83             53693.57     
     95000   333.38679      57539848       1724.1783      117            86             53693.57     
    100000   335.56574      57539848       1735.4471      126            87             53693.57     
Loop time of 147.011 on 8 procs for 100000 steps with 1949 atoms

Performance: 58.771 ns/day, 0.408 hours/ns, 680.220 timesteps/s, 1.326 Matom-step/s
95.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 9.4419     | 55.736     | 103        | 591.9 | 37.91
Bond    | 0.0038782  | 0.0046383  | 0.005921   |   1.0 |  0.00
Kspace  | 24.981     | 69.886     | 113.76     | 499.1 | 47.54
Neigh   | 0.037944   | 0.16082    | 0.29243    |  29.5 |  0.11
Comm    | 10.721     | 13.378     | 16.057     |  69.6 |  9.10
Output  | 0.00059509 | 0.00066502 | 0.00086214 |   0.0 |  0.00
Modify  | 6.3171     | 6.3786     | 6.4399     |   2.4 |  4.34
Other   |            | 1.466      |            |       |  1.00

Nlocal:        243.625 ave         415 max          72 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:        3502.25 ave        3725 max        3272 min
Histogram: 3 1 0 0 0 0 0 0 1 3
Neighs:        53862.5 ave       95750 max       13690 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 430900
Ave neighs/atom = 221.08774
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.21407356
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.002829688
  estimated relative force accuracy = 8.5215213e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 512
Generated 10 of 10 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.852 | 6.861 | 6.868 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   298.874        57539848       1735.4471      126            87             53693.57     
    105000   299.77377      57539848       1740.6718      130            89             53693.57     
    110000   300.99894      57539853       1747.7858      133            93             53693.57     
    115000   301.65223      57539867       1751.5793      134            98             53693.57     
    120000   302.72018      57539860       1757.7804      138            97             53693.57     
    125000   304.50255      57539858       1768.13        142            101            53693.57     
    130000   304.72351      57539860       1769.413       145            101            53693.57     
    135000   306.45589      57539851       1779.4723      148            107            53693.57     
    140000   307.46987      57539854       1785.3601      152            110            53693.57     
    145000   308.07292      57539859       1788.8618      153            114            53693.57     
    150000   309.40532      57539858       1796.5985      156            117            53693.57     
    155000   310.10326      57539844       1800.6512      161            119            53693.57     
    160000   311.06725      57539839       1806.2487      161            124            53693.57     
    165000   311.91646      57539852       1811.1797      164            126            53693.57     
    170000   312.07458      57539849       1812.0978      165            127            53693.57     
    175000   312.91987      57539844       1817.0062      167            129            53693.57     
    180000   313.94974      57539837       1822.9862      170            132            53693.57     
    185000   313.94314      57539830       1822.9479      170            133            53693.57     
    190000   314.8222       57539833       1828.0522      177            136            53693.57     
    195000   315.76009      57539842       1833.4982      182            139            53693.57     
    200000   317.4993       57539857       1843.5971      186            142            53693.57     
Loop time of 159.284 on 8 procs for 100000 steps with 2064 atoms

Performance: 54.243 ns/day, 0.442 hours/ns, 627.811 timesteps/s, 1.296 Matom-step/s
96.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 17.597     | 65.359     | 114.23     | 565.1 | 41.03
Bond    | 0.0040696  | 0.0048303  | 0.0059914  |   0.9 |  0.00
Kspace  | 25.096     | 71.509     | 116.58     | 513.0 | 44.89
Neigh   | 0.066788   | 0.19083    | 0.32623    |  27.7 |  0.12
Comm    | 11.012     | 13.734     | 16.306     |  64.8 |  8.62
Output  | 0.00060272 | 0.00065915 | 0.00082371 |   0.0 |  0.00
Modify  | 6.9365     | 6.9985     | 7.0609     |   2.3 |  4.39
Other   |            | 1.487      |            |       |  0.93

Nlocal:            258 ave         421 max          95 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:         3696.5 ave        3901 max        3478 min
Histogram: 2 2 0 0 0 0 0 0 0 4
Neighs:        59765.4 ave      101467 max       19028 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 478123
Ave neighs/atom = 231.64874
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 186
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 142
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:05:06
