LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 65.0% H₂ / 35.0% CH₄ at 25 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (37.726 37.726 37.726)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  1736 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.006 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.060014 3.118000  # O
pair_coeff 3 3 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 4 4 0.072930 2.958000
pair_coeff 5 5 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:3
1736 atoms in group framework
group h2 type 4
0 atoms in group h2
group ch4 type 5
0 atoms in group ch4
group gases type 4 5
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[4]
variable n_ch4 equal c_type_counts[5]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.653801
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 4 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 4 54321 298 1.653801 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 5 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 5 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 0.000184 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.21407932
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0029980313
  estimated relative force accuracy = 9.0284821e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 512
Generated 10 of 10 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 6 6 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.721 | 6.729 | 6.734 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            57539918       1541.1682      0              0              53693.57     
      5000   300.09864      57539915       1552.0218      8              3              53693.57     
     10000   301.99035      57539915       1561.8051      18             8              53693.57     
     15000   303.48249      57539907       1569.522       26             11             53693.57     
     20000   306.4988       57539902       1585.1215      36             16             53693.57     
     25000   309.48935      57539896       1600.5877      41             22             53693.57     
     30000   310.69933      57539903       1606.8454      45             25             53693.57     
     35000   313.30004      57539905       1620.2955      52             31             53693.57     
     40000   315.42513      57539889       1631.2858      58             39             53693.57     
     45000   316.89702      57539868       1638.8981      59             45             53693.57     
     50000   318.83489      57539868       1648.9201      64             52             53693.57     
     55000   319.9938       57539866       1654.9137      66             57             53693.57     
     60000   321.98003      57539871       1665.1859      73             62             53693.57     
     65000   323.6179       57539866       1673.6565      80             64             53693.57     
     70000   325.58699      57539867       1683.84        87             69             53693.57     
     75000   328.18013      57539859       1697.251       97             73             53693.57     
     80000   329.48759      57539843       1704.0128      101            76             53693.57     
     85000   331.34738      57539843       1713.631       108            79             53693.57     
     90000   332.8031       57539838       1721.1596      114            83             53693.57     
     95000   333.1527       57539842       1722.9676      116            86             53693.57     
    100000   335.26421      57539836       1733.8877      125            86             53693.57     
Loop time of 148.357 on 8 procs for 100000 steps with 1947 atoms

Performance: 58.238 ns/day, 0.412 hours/ns, 674.049 timesteps/s, 1.312 Matom-step/s
96.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 9.4522     | 55.674     | 103.74     | 592.1 | 37.53
Bond    | 0.0038091  | 0.0046811  | 0.0058005  |   1.1 |  0.00
Kspace  | 24.836     | 70.684     | 113.73     | 496.3 | 47.64
Neigh   | 0.039181   | 0.16073    | 0.29572    |  29.4 |  0.11
Comm    | 10.882     | 13.829     | 16.794     |  68.1 |  9.32
Output  | 0.00062815 | 0.00068532 | 0.00083763 |   0.0 |  0.00
Modify  | 6.3645     | 6.4285     | 6.4954     |   2.4 |  4.33
Other   |            | 1.576      |            |       |  1.06

Nlocal:        243.375 ave         415 max          72 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:         3499.5 ave        3723 max        3269 min
Histogram: 2 2 0 0 0 0 0 0 1 3
Neighs:          53759 ave       95653 max       13677 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 430072
Ave neighs/atom = 220.88957
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.21407362
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0028311386
  estimated relative force accuracy = 8.5258898e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 512
Generated 10 of 10 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.851 | 6.861 | 6.868 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   298.91233      57539836       1733.8877      125            86             53693.57     
    105000   300.03687      57539843       1740.4108      129            89             53693.57     
    110000   301.26329      57539849       1747.5248      132            93             53693.57     
    115000   301.84244      57539857       1750.8843      131            99             53693.57     
    120000   303.0182       57539863       1757.7045      136            99             53693.57     
    125000   304.77847      57539854       1767.9152      140            102            53693.57     
    130000   304.99965      57539856       1769.1982      143            102            53693.57     
    135000   306.73381      57539847       1779.2574      146            108            53693.57     
    140000   307.74884      57539850       1785.1452      150            111            53693.57     
    145000   308.46188      57539861       1789.2814      152            115            53693.57     
    150000   309.79565      57539860       1797.0181      155            118            53693.57     
    155000   310.4943       57539846       1801.0708      160            120            53693.57     
    160000   311.23546      57539834       1805.3699      160            124            53693.57     
    165000   312.08553      57539847       1810.3009      163            126            53693.57     
    170000   312.24381      57539844       1811.2191      164            127            53693.57     
    175000   313.29393      57539849       1817.3104      167            130            53693.57     
    180000   314.32485      57539843       1823.2905      170            133            53693.57     
    185000   314.41513      57539842       1823.8141      170            135            53693.57     
    190000   315.29509      57539845       1828.9184      177            138            53693.57     
    195000   316.23394      57539854       1834.3644      182            141            53693.57     
    200000   317.80382      57539863       1843.4707      185            144            53693.57     
Loop time of 158.944 on 8 procs for 100000 steps with 2065 atoms

Performance: 54.359 ns/day, 0.442 hours/ns, 629.152 timesteps/s, 1.299 Matom-step/s
96.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 17.479     | 65.392     | 115.74     | 564.8 | 41.14
Bond    | 0.003976   | 0.0048745  | 0.0059544  |   1.2 |  0.00
Kspace  | 23.552     | 71.524     | 117.03     | 513.1 | 45.00
Neigh   | 0.066219   | 0.19007    | 0.3216     |  27.5 |  0.12
Comm    | 10.914     | 13.423     | 15.917     |  64.1 |  8.44
Output  | 0.00057839 | 0.0006265  | 0.00075282 |   0.0 |  0.00
Modify  | 6.8932     | 6.9568     | 7.0248     |   2.3 |  4.38
Other   |            | 1.453      |            |       |  0.91

Nlocal:        258.125 ave         421 max          95 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:        3698.38 ave        3903 max        3481 min
Histogram: 3 1 0 0 0 0 0 0 0 4
Neighs:        59820.9 ave      101530 max       19028 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 478567
Ave neighs/atom = 231.75157
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 185
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 144
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:05:07
