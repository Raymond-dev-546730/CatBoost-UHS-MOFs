LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 75.0% H₂ / 25.0% CH₄ at 35 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (18.4641 18.4641 37.4193)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  552 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.504631 4.008000  # Al
pair_coeff 2 2 0.104924 3.431000  # C
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.060014 3.118000  # O

# Gas parameters
pair_coeff 5 5 0.072930 2.958000
pair_coeff 6 6 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:4
552 atoms in group framework
group h2 type 5
0 atoms in group h2
group ch4 type 6
0 atoms in group ch4
group gases type 5 6
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[5]
variable n_ch4 equal c_type_counts[6]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.939543
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 1.939543 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -6.8e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.24306442
  grid = 12 12 20
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0020701726
  estimated relative force accuracy = 6.2342632e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2964 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.702 | 6.707 | 6.718 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            51081822       489.44305      0              0              12757.1      
      5000   301.81584      51081814       495.71028      4              4              12757.1      
     10000   304.70423      51081811       500.45425      8              8              12757.1      
     15000   305.65845      51081817       502.02149      11             9              12757.1      
     20000   307.96439      51081822       505.80882      16             10             12757.1      
     25000   313.2505       51081810       514.49088      22             11             12757.1      
     30000   318.71288      51081815       523.46244      27             13             12757.1      
     35000   325.05491      51081822       533.87875      32             15             12757.1      
     40000   328.71155      51081807       539.8845       36             18             12757.1      
     45000   329.13701      51081791       540.58329      37             17             12757.1      
     50000   330.54559      51081799       542.89679      38             22             12757.1      
     55000   336.51857      51081793       552.70697      44             26             12757.1      
     60000   337.75767      51081799       554.7421       50             26             12757.1      
     65000   340.8343       51081792       559.79524      54             27             12757.1      
     70000   343.74076      51081801       564.56887      58             30             12757.1      
     75000   344.02227      51081806       565.03123      60             30             12757.1      
     80000   345.19043      51081799       566.94985      62             30             12757.1      
     85000   347.64655      51081797       570.98384      65             31             12757.1      
     90000   350.35805      51081804       575.43729      68             31             12757.1      
     95000   350.10086      51081791       575.01488      68             31             12757.1      
    100000   354.09117      51081801       581.56866      72             31             12757.1      
Loop time of 59.8755 on 8 procs for 100000 steps with 655 atoms

Performance: 144.299 ns/day, 0.166 hours/ns, 1670.132 timesteps/s, 1.094 Matom-step/s
88.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 21.084     | 23.278     | 26.612     |  37.7 | 38.88
Bond    | 0.0042046  | 0.0045809  | 0.0055624  |   0.7 |  0.01
Kspace  | 17.166     | 20.545     | 22.81      |  40.0 | 34.31
Neigh   | 0.081383   | 0.086051   | 0.091968   |   1.2 |  0.14
Comm    | 11.537     | 11.797     | 11.979     |   4.3 | 19.70
Output  | 0.00070088 | 0.00077529 | 0.0010687  |   0.0 |  0.00
Modify  | 2.5802     | 2.5815     | 2.5857     |   0.1 |  4.31
Other   |            | 1.583      |            |       |  2.64

Nlocal:         81.875 ave          83 max          79 min
Histogram: 1 0 0 0 0 1 0 3 0 3
Nghost:        3207.12 ave        3210 max        3205 min
Histogram: 3 0 1 0 1 0 0 0 1 2
Neighs:          23801 ave       26858 max       21521 min
Histogram: 1 2 0 0 1 2 1 0 0 1

Total # of neighbors = 190408
Ave neighs/atom = 290.69924
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23878319
  grid = 12 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0025517831
  estimated relative force accuracy = 7.684619e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2470 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.812 | 6.818 | 6.834 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   298.32451      51081801       581.56866      72             31             12757.1      
    105000   297.23038      51081794       579.43569      71             31             12757.1      
    110000   298.97965      51081797       582.84581      72             32             12757.1      
    115000   300.66942      51081796       586.13994      75             32             12757.1      
    120000   301.20793      51081794       587.18973      77             32             12757.1      
    125000   302.97778      51081798       590.63996      79             34             12757.1      
    130000   303.07152      51081797       590.82271      80             34             12757.1      
    135000   304.58744      51081802       593.77792      81             36             12757.1      
    140000   306.49943      51081811       597.50525      84             36             12757.1      
    145000   305.99338      51081813       596.51873      86             35             12757.1      
    150000   306.10732      51081810       596.74085      85             36             12757.1      
    155000   306.10732      51081810       596.74085      85             36             12757.1      
    160000   306.49779      51081806       597.50204      85             37             12757.1      
    165000   307.15533      51081801       598.78388      88             36             12757.1      
    170000   307.77763      51081807       599.99703      89             36             12757.1      
    175000   307.15533      51081801       598.78388      88             36             12757.1      
    180000   308.38986      51081808       601.19055      90             37             12757.1      
    185000   308.31073      51081803       601.03629      89             37             12757.1      
    190000   308.58548      51081808       601.5719       90             37             12757.1      
    195000   308.17043      51081802       600.76278      90             36             12757.1      
    200000   308.94443      51081797       602.27164      90             37             12757.1      
Loop time of 65.8473 on 8 procs for 100000 steps with 679 atoms

Performance: 131.213 ns/day, 0.183 hours/ns, 1518.666 timesteps/s, 1.031 Matom-step/s
90.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 26.099     | 28.897     | 32.493     |  38.9 | 43.88
Bond    | 0.0043055  | 0.0045463  | 0.005046   |   0.4 |  0.01
Kspace  | 16.489     | 20.163     | 23.029     |  45.4 | 30.62
Neigh   | 0.098225   | 0.1026     | 0.11084    |   1.4 |  0.16
Comm    | 12.008     | 12.155     | 12.314     |   3.8 | 18.46
Output  | 0.00064388 | 0.00069133 | 0.00093302 |   0.0 |  0.00
Modify  | 2.8873     | 2.889      | 2.8929     |   0.1 |  4.39
Other   |            | 1.635      |            |       |  2.48

Nlocal:         84.875 ave          89 max          83 min
Histogram: 1 3 0 3 0 0 0 0 0 1
Nghost:        3332.62 ave        3338 max        3327 min
Histogram: 2 1 0 0 0 1 1 1 0 2
Neighs:          25608 ave       27951 max       23625 min
Histogram: 2 1 0 0 2 0 0 0 2 1

Total # of neighbors = 204864
Ave neighs/atom = 301.71429
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 90
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 37
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:02:05
