LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (18.6543 18.6543 18.1444)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  184 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.060014 3.118000  # O
pair_coeff 3 3 0.016991 2.829000  # Ti

# Gas parameters
pair_coeff 4 4 0.072930 2.958000
pair_coeff 5 5 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:3
184 atoms in group framework
group h2 type 4
0 atoms in group h2
group ch4 type 5
0 atoms in group ch4
group gases type 4 5
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[4]
variable n_ch4 equal c_type_counts[5]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 4 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 4 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 5 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 5 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -2.4e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.26096369
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0013023824
  estimated relative force accuracy = 3.922086e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 512
Generated 10 of 10 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.493 | 6.502 | 6.508 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            3544507.2      162.5555       0              0              6313.9411    
      5000   310.10444      3544501.1      169.15833      4              3              6313.9411    
     10000   318.6117       3544502.4      173.79893      7              6              6313.9411    
     15000   326.94768      3544508.7      178.34611      12             9              6313.9411    
     20000   332.72215      3544512        181.49602      18             9              6313.9411    
     25000   340.89617      3544508.6      185.95485      20             11             6313.9411    
     30000   342.22735      3544508        186.681        22             11             6313.9411    
     35000   342.19405      3544499.8      186.66283      22             13             6313.9411    
     40000   349.48224      3544499.4      190.63845      26             14             6313.9411    
     45000   352.63799      3544501.9      192.35988      26             16             6313.9411    
     50000   361.46548      3544515.9      197.17517      30             16             6313.9411    
     55000   366.06903      3544511.9      199.68635      29             17             6313.9411    
     60000   358.58182      3544502.2      195.60216      28             17             6313.9411    
     65000   358.86807      3544500.7      195.75831      30             17             6313.9411    
     70000   357.17432      3544496        194.83439      29             20             6313.9411    
     75000   359.36973      3544492        196.03196      29             21             6313.9411    
     80000   362.19804      3544495.1      197.57477      31             21             6313.9411    
     85000   371.19614      3544498.5      202.48313      34             21             6313.9411    
     90000   372.54656      3544500.4      203.21977      35             21             6313.9411    
     95000   371.99793      3544496.2      202.9205       35             20             6313.9411    
    100000   377.18242      3544502.3      205.74857      40             20             6313.9411    
Loop time of 28.5093 on 8 procs for 100000 steps with 244 atoms

Performance: 303.059 ns/day, 0.079 hours/ns, 3507.625 timesteps/s, 855.860 katom-step/s
86.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.0707     | 4.9121     | 5.3024     |  18.0 | 17.23
Bond    | 0.0036035  | 0.0039029  | 0.004387   |   0.5 |  0.01
Kspace  | 15.353     | 15.895     | 16.806     |  10.7 | 55.75
Neigh   | 0.02279    | 0.024961   | 0.028407   |   1.1 |  0.09
Comm    | 6.0196     | 6.2073     | 6.4292     |   5.5 | 21.77
Output  | 0.00045546 | 0.00048711 | 0.00064527 |   0.0 |  0.00
Modify  | 0.94166    | 0.94347    | 0.94621    |   0.1 |  3.31
Other   |            | 0.5217     |            |       |  1.83

Nlocal:           30.5 ave          34 max          28 min
Histogram: 2 1 0 0 0 3 1 0 0 1
Nghost:         1939.5 ave        1944 max        1937 min
Histogram: 3 1 1 0 1 0 0 0 0 2
Neighs:        6725.62 ave        7331 max        5931 min
Histogram: 1 1 0 0 1 1 1 0 2 1

Total # of neighbors = 53805
Ave neighs/atom = 220.5123
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.24728065
  grid = 12 12 12
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0030807546
  estimated relative force accuracy = 9.277601e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 288
Generated 10 of 10 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.59 | 6.594 | 6.597 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   284.05096      3544502.3      205.74857      40             20             6313.9411    
    105000   285.87655      3544502.4      207.07092      41             20             6313.9411    
    110000   280.15418      3544496.5      202.92599      40             20             6313.9411    
    115000   280.15418      3544496.5      202.92599      40             20             6313.9411    
    120000   281.94304      3544502.7      204.22173      41             21             6313.9411    
    125000   286.43183      3544501.9      207.47313      42             21             6313.9411    
    130000   286.43183      3544501.9      207.47313      42             21             6313.9411    
    135000   291.36613      3544514.4      211.04722      45             21             6313.9411    
    140000   292.66885      3544506.3      211.99083      44             22             6313.9411    
    145000   291.65186      3544501.6      211.25419      43             22             6313.9411    
    150000   293.00042      3544501.6      212.231        44             22             6313.9411    
    155000   294.08481      3544501.2      213.01646      45             22             6313.9411    
    160000   294.08481      3544501.2      213.01646      45             22             6313.9411    
    165000   296.53355      3544505.7      214.79017      46             23             6313.9411    
    170000   296.87573      3544506.5      215.03803      47             22             6313.9411    
    175000   297.31031      3544508.6      215.35281      48             22             6313.9411    
    180000   296.44802      3544503.8      214.72823      47             22             6313.9411    
    185000   296.04824      3544500.8      214.43864      47             22             6313.9411    
    190000   296.77506      3544498.2      214.96511      47             22             6313.9411    
    195000   296.77506      3544498.2      214.96511      47             22             6313.9411    
    200000   296.77506      3544498.2      214.96511      47             22             6313.9411    
Loop time of 26.126 on 8 procs for 100000 steps with 253 atoms

Performance: 330.706 ns/day, 0.073 hours/ns, 3827.611 timesteps/s, 968.386 katom-step/s
85.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.3179     | 6.1996     | 6.991      |  22.4 | 23.73
Bond    | 0.0034198  | 0.0038659  | 0.0048034  |   0.7 |  0.01
Kspace  | 10.9       | 11.708     | 12.813     |  17.9 | 44.81
Neigh   | 0.027861   | 0.030915   | 0.035759   |   1.3 |  0.12
Comm    | 6.476      | 6.5834     | 6.7464     |   3.9 | 25.20
Output  | 0.00048162 | 0.00051467 | 0.00062237 |   0.0 |  0.00
Modify  | 1.0292     | 1.03       | 1.0338     |   0.1 |  3.94
Other   |            | 0.5697     |            |       |  2.18

Nlocal:         31.625 ave          39 max          28 min
Histogram: 3 1 0 2 0 1 0 0 0 1
Nghost:        2014.38 ave        2020 max        2005 min
Histogram: 1 0 0 0 1 0 3 1 1 1
Neighs:           7237 ave        8623 max        6247 min
Histogram: 2 0 1 1 0 3 0 0 0 1

Total # of neighbors = 57896
Ave neighs/atom = 228.83794
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 47
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 22
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:00:54
