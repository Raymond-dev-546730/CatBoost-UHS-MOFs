LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (7.2682 30.1678 49.7021)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  492 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.598566 3.976000  # In
pair_coeff 4 4 0.060014 3.118000  # O

# Gas parameters
pair_coeff 5 5 0.072930 2.958000
pair_coeff 6 6 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:4
492 atoms in group framework
group h2 type 5
0 atoms in group h2
group ch4 type 6
0 atoms in group ch4
group gases type 5 6
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[5]
variable n_ch4 equal c_type_counts[6]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -6.3e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23817636
  grid = 6 15 24
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0024221006
  estimated relative force accuracy = 7.2940841e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1859 288
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 2 5 8
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.67 | 6.672 | 6.674 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            52779924       436.14616      0              0              10897.961    
      5000   302.23321      52779919       442.3418       4              4              10897.961    
     10000   306.58622      52779919       448.71276      9              6              10897.961    
     15000   309.14521      52779915       452.45805      13             9              10897.961    
     20000   314.63783      52779914       460.49693      21             11             10897.961    
     25000   318.13733      52779913       465.61871      26             11             10897.961    
     30000   318.18166      52779913       465.6836       27             11             10897.961    
     35000   320.47747      52779921       469.04368      28             12             10897.961    
     40000   324.67521      52779928       475.1874       34             14             10897.961    
     45000   324.28606      52779920       474.61785      34             14             10897.961    
     50000   327.44855      52779913       479.2464       37             17             10897.961    
     55000   332.87343      52779928       487.18614      41             22             10897.961    
     60000   331.05613      52779912       484.52638      40             22             10897.961    
     65000   332.69069      52779915       486.91868      43             22             10897.961    
     70000   334.16652      52779919       489.07868      48             22             10897.961    
     75000   336.15773      52779906       491.99297      52             22             10897.961    
     80000   340.0959       52779908       497.75679      53             24             10897.961    
     85000   342.69959      52779909       501.56749      56             24             10897.961    
     90000   345.13152      52779912       505.12681      58             25             10897.961    
     95000   346.33612      52779915       506.88984      60             25             10897.961    
    100000   347.89713      52779910       509.17449      62             26             10897.961    
Loop time of 54.3551 on 8 procs for 100000 steps with 580 atoms

Performance: 158.955 ns/day, 0.151 hours/ns, 1839.753 timesteps/s, 1.067 Matom-step/s
91.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 12.119     | 19.473     | 27.546     | 123.7 | 35.83
Bond    | 0.0036163  | 0.0038825  | 0.0042864  |   0.3 |  0.01
Kspace  | 12.619     | 20.624     | 27.977     | 116.6 | 37.94
Neigh   | 0.05144    | 0.068439   | 0.087352   |   5.6 |  0.13
Comm    | 9.9472     | 10.47      | 10.87      |  10.9 | 19.26
Output  | 0.00045818 | 0.00052727 | 0.00066816 |   0.0 |  0.00
Modify  | 2.2289     | 2.2365     | 2.2454     |   0.4 |  4.11
Other   |            | 1.479      |            |       |  2.72

Nlocal:           72.5 ave          88 max          56 min
Histogram: 2 2 0 0 0 0 0 0 0 4
Nghost:        3301.88 ave        3370 max        3225 min
Histogram: 2 0 1 1 0 0 0 0 2 2
Neighs:        22032.2 ave       30217 max       14631 min
Histogram: 2 0 0 2 0 1 0 2 0 1

Total # of neighbors = 176258
Ave neighs/atom = 303.8931
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23817623
  grid = 6 15 24
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0022308062
  estimated relative force accuracy = 6.7180065e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1859 288
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.803 | 6.805 | 6.808 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   295.02157      52779910       509.17449      62             26             10897.961    
    105000   295.76884      52779909       510.46419      63             26             10897.961    
    110000   297.53577      52779915       513.51372      64             26             10897.961    
    115000   298.36876      52779905       514.95136      65             26             10897.961    
    120000   298.97702      52779905       516.00115      67             26             10897.961    
    125000   300.37295      52779902       518.41038      69             26             10897.961    
    130000   300.50493      52779895       518.63816      69             27             10897.961    
    135000   301.54557      52779895       520.43419      71             27             10897.961    
    140000   301.86677      52779891       520.98853      72             26             10897.961    
    145000   302.75495      52779901       522.52144      73             27             10897.961    
    150000   304.2492       52779909       525.10035      74             28             10897.961    
    155000   304.2492       52779909       525.10035      74             28             10897.961    
    160000   304.23066      52779906       525.06835      74             28             10897.961    
    165000   304.65653      52779906       525.80336      75             28             10897.961    
    170000   304.65653      52779906       525.80336      75             28             10897.961    
    175000   304.86759      52779910       526.16762      75             29             10897.961    
    180000   306.20508      52779908       528.47598      77             29             10897.961    
    185000   305.04071      52779903       526.46641      76             29             10897.961    
    190000   305.11291      52779904       526.59102      77             28             10897.961    
    195000   306.68332      52779902       529.30138      79             28             10897.961    
    200000   307.18562      52779896       530.16829      79             28             10897.961    
Loop time of 60.3934 on 8 procs for 100000 steps with 599 atoms

Performance: 143.062 ns/day, 0.168 hours/ns, 1655.809 timesteps/s, 991.830 katom-step/s
91.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 15.054     | 24.113     | 33.534     | 127.2 | 39.93
Bond    | 0.0036738  | 0.0040531  | 0.0047597  |   0.6 |  0.01
Kspace  | 12.494     | 21.894     | 30.272     | 128.2 | 36.25
Neigh   | 0.062817   | 0.080312   | 0.10203    |   5.6 |  0.13
Comm    | 9.7726     | 10.426     | 11.19      |  13.1 | 17.26
Output  | 0.00047604 | 0.00056284 | 0.00063628 |   0.0 |  0.00
Modify  | 2.5246     | 2.5334     | 2.544      |   0.5 |  4.19
Other   |            | 1.341      |            |       |  2.22

Nlocal:         74.875 ave          91 max          58 min
Histogram: 3 1 0 0 0 0 0 0 0 4
Nghost:        3406.25 ave        3475 max        3329 min
Histogram: 2 0 1 0 1 0 1 0 0 3
Neighs:          23535 ave       31561 max       16045 min
Histogram: 2 0 1 0 1 1 0 2 0 1

Total # of neighbors = 188280
Ave neighs/atom = 314.32387
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 79
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 28
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:54
