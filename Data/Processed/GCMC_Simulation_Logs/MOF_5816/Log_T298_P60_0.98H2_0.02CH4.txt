LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (23.369 44.49 17.204)
  2 by 4 by 1 MPI processor grid
  reading atoms ...
  376 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.006 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
376 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -2.8e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22611355
  grid = 12 18 9
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0018507203
  estimated relative force accuracy = 5.5733893e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2080 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 4 7 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.586 | 6.591 | 6.607 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            38051596       333.10552      0              0              17886.772    
      5000   309.2398       38051591       345.66942      9              7              17886.772    
     10000   318.57959      38051583       356.10947      18             12             17886.772    
     15000   329.41532      38051576       368.22169      27             18             17886.772    
     20000   337.79548      38051570       377.58906      37             21             17886.772    
     25000   348.61216      38051566       389.67999      42             27             17886.772    
     30000   351.25734      38051566       392.63677      44             29             17886.772    
     35000   353.20424      38051567       394.81303      44             32             17886.772    
     40000   364.64442      38051566       407.6009       53             38             17886.772    
     45000   369.97959      38051560       413.56459      60             39             17886.772    
     50000   379.5941       38051566       424.31172      66             45             17886.772    
     55000   382.82209      38051566       427.91998      70             47             17886.772    
     60000   387.82632      38051565       433.51372      74             51             17886.772    
     65000   393.07463      38051577       439.3803       80             53             17886.772    
     70000   401.01719      38051569       448.25853      87             58             17886.772    
     75000   408.14536      38051577       456.22642      92             61             17886.772    
     80000   412.03737      38051581       460.57692      97             62             17886.772    
     85000   416.45164      38051576       465.51121      100            62             17886.772    
     90000   418.95522      38051567       468.30972      102            64             17886.772    
     95000   421.44382      38051560       471.09149      107            63             17886.772    
    100000   424.75414      38051554       474.79178      112            65             17886.772    
Loop time of 26.4822 on 8 procs for 100000 steps with 553 atoms

Performance: 326.256 ns/day, 0.074 hours/ns, 3776.115 timesteps/s, 2.088 Matom-step/s
93.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.8816     | 8.4334     | 8.837      |  12.6 | 31.85
Bond    | 0.0036191  | 0.0038708  | 0.0041196  |   0.3 |  0.01
Kspace  | 11.571     | 12.026     | 12.666     |  10.2 | 45.41
Neigh   | 0.033298   | 0.038325   | 0.042311   |   1.4 |  0.14
Comm    | 4.1511     | 4.3609     | 4.4785     |   5.9 | 16.47
Output  | 0.00047006 | 0.0005112  | 0.00067317 |   0.0 |  0.00
Modify  | 1.1485     | 1.151      | 1.1537     |   0.1 |  4.35
Other   |            | 0.4682     |            |       |  1.77

Nlocal:         69.125 ave          74 max          65 min
Histogram: 1 0 2 1 1 0 1 1 0 1
Nghost:         2107.5 ave        2132 max        2073 min
Histogram: 1 1 0 1 1 0 0 1 0 3
Neighs:        12023.9 ave       12911 max       10953 min
Histogram: 2 0 0 1 1 0 1 1 0 2

Total # of neighbors = 96191
Ave neighs/atom = 173.94394
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.21678197
  grid = 10 16 8
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0027648916
  estimated relative force accuracy = 8.326389e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1170 160
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.675 | 6.681 | 6.697 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   288.5558       38051554       474.79178      112            65             17886.772    
    105000   294.83458      38051549       485.12293      117            65             17886.772    
    110000   295.53274      38051542       486.27168      117            68             17886.772    
    115000   296.88664      38051546       488.49939      117            70             17886.772    
    120000   299.94027      38051547       493.52386      120            71             17886.772    
    125000   301.12899      38051557       495.4798       122            72             17886.772    
    130000   303.02886      38051556       498.60586      125            72             17886.772    
    135000   306.58141      38051559       504.45124      127            73             17886.772    
    140000   310.35551      38051562       510.66117      129            74             17886.772    
    145000   311.47746      38051564       512.50723      131            74             17886.772    
    150000   311.0033       38051553       511.72705      130            76             17886.772    
    155000   314.58983      38051552       517.62836      133            77             17886.772    
    160000   316.02518      38051552       519.99009      134            78             17886.772    
    165000   316.98756      38051555       521.5736       136            79             17886.772    
    170000   316.85358      38051551       521.35314      135            79             17886.772    
    175000   317.17172      38051549       521.87662      137            80             17886.772    
    180000   319.04889      38051542       524.96532      137            81             17886.772    
    185000   318.4311       38051543       523.94881      139            81             17886.772    
    190000   320.64437      38051550       527.59053      144            81             17886.772    
    195000   321.99721      38051539       529.81652      145            83             17886.772    
    200000   323.66294      38051540       532.55732      147            83             17886.772    
Loop time of 29.8977 on 8 procs for 100000 steps with 606 atoms

Performance: 288.985 ns/day, 0.083 hours/ns, 3344.739 timesteps/s, 2.027 Matom-step/s
95.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.532     | 13.207     | 13.83      |  21.3 | 44.17
Bond    | 0.0036651  | 0.004203   | 0.004805   |   0.5 |  0.01
Kspace  | 9.0197     | 9.5203     | 11.019     |  22.6 | 31.84
Neigh   | 0.050501   | 0.055216   | 0.058367   |   1.2 |  0.18
Comm    | 4.755      | 5.008      | 5.218      |   7.6 | 16.75
Output  | 0.00054339 | 0.00060218 | 0.00076821 |   0.0 |  0.00
Modify  | 1.4783     | 1.4795     | 1.4815     |   0.1 |  4.95
Other   |            | 0.6228     |            |       |  2.08

Nlocal:          75.75 ave          79 max          72 min
Histogram: 2 0 2 0 0 0 0 1 0 3
Nghost:        2297.88 ave        2313 max        2286 min
Histogram: 3 0 2 0 0 0 0 0 1 2
Neighs:        14492.1 ave       15213 max       13324 min
Histogram: 1 0 1 1 0 0 1 0 1 3

Total # of neighbors = 115937
Ave neighs/atom = 191.31518
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 147
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 83
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:00:56
