LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 75.0% H₂ / 25.0% CH₄ at 35 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (19.215 19.215 36.779)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  536 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.005 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.504631 4.008000  # Al
pair_coeff 2 2 0.104924 3.431000  # C
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.060014 3.118000  # O

# Gas parameters
pair_coeff 5 5 0.072930 2.958000
pair_coeff 6 6 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:4
536 atoms in group framework
group h2 type 5
0 atoms in group h2
group ch4 type 6
0 atoms in group ch4
group gases type 5 6
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[5]
variable n_ch4 equal c_type_counts[6]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.939543
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 1.939543 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 2e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23853709
  grid = 12 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.002848493
  estimated relative force accuracy = 8.5781521e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2366 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.674 | 6.677 | 6.684 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            56498616       475.23055      0              0              13579.404    
      5000   304.5887       56498613       485.73776      6              5              13579.404    
     10000   305.61145      56498608       487.36877      9              6              13579.404    
     15000   309.26555      56498598       493.1961       15             10             13579.404    
     20000   316.67439      56498586       505.01123      22             13             13579.404    
     25000   322.37027      56498588       514.09462      25             14             13579.404    
     30000   325.31122      56498587       518.78465      28             16             13579.404    
     35000   328.20172      56498594       523.39424      32             17             13579.404    
     40000   331.12391      56498598       528.05436      38             21             13579.404    
     45000   331.50677      56498604       528.66491      40             21             13579.404    
     50000   330.40288      56498602       526.9045       41             22             13579.404    
     55000   332.10215      56498595       529.61438      44             23             13579.404    
     60000   334.56445      56498586       533.54109      45             24             13579.404    
     65000   335.43607      56498586       534.93109      49             24             13579.404    
     70000   338.26815      56498582       539.44751      53             29             13579.404    
     75000   339.33561      56498591       541.14982      57             29             13579.404    
     80000   346.12035      56498601       551.96967      63             30             13579.404    
     85000   350.1666       56498609       558.42236      68             31             13579.404    
     90000   349.77532      56498594       557.79838      69             31             13579.404    
     95000   349.05706      56498580       556.65294      68             30             13579.404    
    100000   355.65751      56498594       567.1789       75             31             13579.404    
Loop time of 49.6108 on 8 procs for 100000 steps with 642 atoms

Performance: 174.156 ns/day, 0.138 hours/ns, 2015.692 timesteps/s, 1.294 Matom-step/s
89.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 18.892     | 20.032     | 21.738     |  18.2 | 40.38
Bond    | 0.0038216  | 0.004134   | 0.004667   |   0.4 |  0.01
Kspace  | 15.419     | 16.816     | 18.026     |  19.4 | 33.90
Neigh   | 0.069039   | 0.074301   | 0.079096   |   1.2 |  0.15
Comm    | 9.3084     | 9.4664     | 9.6555     |   3.8 | 19.08
Output  | 0.00053387 | 0.00058438 | 0.00077918 |   0.0 |  0.00
Modify  | 2.0501     | 2.0524     | 2.0543     |   0.1 |  4.14
Other   |            | 1.165      |            |       |  2.35

Nlocal:          80.25 ave          88 max          77 min
Histogram: 2 3 1 0 1 0 0 0 0 1
Nghost:        2991.12 ave        3017 max        2961 min
Histogram: 1 0 1 2 0 0 1 1 0 2
Neighs:          21651 ave       24727 max       19852 min
Histogram: 1 1 2 0 2 1 0 0 0 1

Total # of neighbors = 173208
Ave neighs/atom = 269.79439
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23851601
  grid = 12 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0026038171
  estimated relative force accuracy = 7.8413179e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2366 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.805 | 6.808 | 6.815 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   296.84363      56498594       567.1789       75             31             13579.404    
    105000   298.40162      56498593       570.15575      76             31             13579.404    
    110000   301.28547      56498594       575.66592      79             31             13579.404    
    115000   300.01263      56498589       573.23391      79             30             13579.404    
    120000   299.64724      56498580       572.53576      78             31             13579.404    
    125000   302.09531      56498578       577.21328      79             33             13579.404    
    130000   301.77428      56498572       576.59989      78             33             13579.404    
    135000   302.1211       56498569       577.26255      78             34             13579.404    
    140000   302.8719       56498569       578.6971       80             34             13579.404    
    145000   303.44244      56498569       579.78724      81             34             13579.404    
    150000   305.84048      56498576       584.36917      81             37             13579.404    
    155000   304.1692       56498563       581.17586      81             35             13579.404    
    160000   304.43306      56498562       581.68001      82             35             13579.404    
    165000   306.46255      56498558       585.55777      85             36             13579.404    
    170000   308.03131      56498560       588.55519      86             37             13579.404    
    175000   309.03442      56498557       590.47183      87             37             13579.404    
    180000   310.7934       56498565       593.83271      90             37             13579.404    
    185000   311.59195      56498564       595.3585       91             37             13579.404    
    190000   311.59195      56498564       595.3585       91             37             13579.404    
    195000   311.78356      56498562       595.72462      92             37             13579.404    
    200000   312.30307      56498562       596.71724      93             37             13579.404    
Loop time of 56.4068 on 8 procs for 100000 steps with 666 atoms

Performance: 153.173 ns/day, 0.157 hours/ns, 1772.836 timesteps/s, 1.181 Matom-step/s
90.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.279     | 25.063     | 28.51      |  33.7 | 44.43
Bond    | 0.0037703  | 0.0041884  | 0.0048237  |   0.5 |  0.01
Kspace  | 15.01      | 17.772     | 20.571     |  38.8 | 31.51
Neigh   | 0.082097   | 0.08851    | 0.095948   |   1.6 |  0.16
Comm    | 9.4159     | 9.8875     | 10.164     |   7.1 | 17.53
Output  | 0.0005367  | 0.00058047 | 0.00074222 |   0.0 |  0.00
Modify  | 2.3462     | 2.3495     | 2.3535     |   0.1 |  4.17
Other   |            | 1.241      |            |       |  2.20

Nlocal:          83.25 ave          89 max          80 min
Histogram: 2 0 2 1 1 0 1 0 0 1
Nghost:        3116.12 ave        3138 max        3092 min
Histogram: 1 1 0 0 1 1 2 1 0 1
Neighs:        23328.1 ave       25759 max       21115 min
Histogram: 1 1 1 0 1 0 2 1 0 1

Total # of neighbors = 186625
Ave neighs/atom = 280.21772
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 93
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 37
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:46
