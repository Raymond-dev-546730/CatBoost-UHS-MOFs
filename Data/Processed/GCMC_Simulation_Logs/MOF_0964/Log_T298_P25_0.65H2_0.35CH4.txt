LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 65.0% H₂ / 35.0% CH₄ at 25 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (16.8365 18.0784 20.746)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  288 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.049958 2.997000  # F
pair_coeff 3 3 0.012996 2.594000  # Fe
pair_coeff 4 4 0.043997 2.571000  # H
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
288 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.653801
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.653801 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.25112525
  grid = 12 12 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0021537465
  estimated relative force accuracy = 6.4859435e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2366 288
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.527 | 6.529 | 6.53 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            11418123       254.93676      0              0              6314.6049    
      5000   301.55085      11418117       257.97449      1              2              6314.6049    
     10000   305.14839      11418117       261.05215      3              4              6314.6049    
     15000   306.49786      11418109       262.20661      5              3              6314.6049    
     20000   315.96093      11418119       270.3022       10             4              6314.6049    
     25000   324.00278      11418119       277.18194      13             4              6314.6049    
     30000   326.89896      11418116       279.65961      15             5              6314.6049    
     35000   332.16784      11418118       284.16709      17             6              6314.6049    
     40000   333.14189      11418115       285.00039      20             5              6314.6049    
     45000   331.57273      11418105       283.65798      21             4              6314.6049    
     50000   337.92413      11418104       289.09156      22             8              6314.6049    
     55000   338.47461      11418095       289.56248      23             8              6314.6049    
     60000   342.6959       11418098       293.17377      25             8              6314.6049    
     65000   343.76843      11418103       294.09131      27             8              6314.6049    
     70000   345.20776      11418100       295.32265      28             9              6314.6049    
     75000   349.91002      11418102       299.34539      31             9              6314.6049    
     80000   346.43034      11418097       296.36855      30             9              6314.6049    
     85000   346.43034      11418097       296.36855      30             9              6314.6049    
     90000   348.38718      11418101       298.04262      32             10             6314.6049    
     95000   348.85231      11418101       298.44053      33             10             6314.6049    
    100000   348.85231      11418101       298.44053      33             10             6314.6049    
Loop time of 37.4709 on 8 procs for 100000 steps with 331 atoms

Performance: 230.579 ns/day, 0.104 hours/ns, 2668.736 timesteps/s, 883.352 katom-step/s
86.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.258     | 10.615     | 11.132     |   9.2 | 28.33
Bond    | 0.0035711  | 0.0038017  | 0.0043011  |   0.4 |  0.01
Kspace  | 14.211     | 14.883     | 15.4       |  11.1 | 39.72
Neigh   | 0.043583   | 0.045324   | 0.047159   |   0.5 |  0.12
Comm    | 9.2947     | 9.5409     | 9.8173     |   4.7 | 25.46
Output  | 0.00049048 | 0.00055005 | 0.00072693 |   0.0 |  0.00
Modify  | 1.4204     | 1.4236     | 1.4253     |   0.1 |  3.80
Other   |            | 0.959      |            |       |  2.56

Nlocal:         41.375 ave          43 max          39 min
Histogram: 1 0 1 0 0 2 0 2 0 2
Nghost:        2665.62 ave        2675 max        2660 min
Histogram: 1 0 4 0 1 1 0 0 0 1
Neighs:          12581 ave       13227 max       11852 min
Histogram: 1 0 1 1 1 1 0 1 0 2

Total # of neighbors = 100648
Ave neighs/atom = 304.07251
Ave special neighs/atom = 0
Neighbor list builds = 1290
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.25112477
  grid = 12 12 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0020090078
  estimated relative force accuracy = 6.0500673e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2366 288
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.656 | 6.659 | 6.66 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   303.3958       11418101       298.44053      33             10             6314.6049    
    105000   305.43645      11418106       300.44785      35             10             6314.6049    
    110000   305.59327      11418112       300.60211      36             10             6314.6049    
    115000   304.9483       11418107       299.96767      35             10             6314.6049    
    120000   306.82651      11418109       301.81521      36             11             6314.6049    
    125000   309.25224      11418105       304.20132      35             12             6314.6049    
    130000   310.51198      11418106       305.44048      37             12             6314.6049    
    135000   310.7374       11418107       305.66223      38             12             6314.6049    
    140000   311.48628      11418106       306.39887      39             12             6314.6049    
    145000   313.24118      11418108       308.12511      41             12             6314.6049    
    150000   315.01437      11418118       309.86934      42             13             6314.6049    
    155000   315.01437      11418118       309.86934      42             13             6314.6049    
    160000   314.9869       11418117       309.84232      41             14             6314.6049    
    165000   315.11729      11418115       309.97058      41             14             6314.6049    
    170000   315.11729      11418115       309.97058      41             14             6314.6049    
    175000   315.11729      11418115       309.97058      41             14             6314.6049    
    180000   313.6641       11418110       308.54113      41             13             6314.6049    
    185000   313.79375      11418112       308.66866      42             13             6314.6049    
    190000   313.79375      11418112       308.66866      42             13             6314.6049    
    195000   315.68739      11418114       310.53137      44             13             6314.6049    
    200000   315.68739      11418114       310.53137      44             13             6314.6049    
Loop time of 40.5026 on 8 procs for 100000 steps with 345 atoms

Performance: 213.319 ns/day, 0.113 hours/ns, 2468.975 timesteps/s, 851.796 katom-step/s
86.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.669     | 12.727     | 13.378     |  14.3 | 31.42
Bond    | 0.003419   | 0.0037558  | 0.0041334  |   0.4 |  0.01
Kspace  | 13.949     | 15.255     | 15.789     |  13.7 | 37.66
Neigh   | 0.049713   | 0.052314   | 0.055276   |   0.9 |  0.13
Comm    | 9.3714     | 9.8927     | 10.385     |   9.0 | 24.42
Output  | 0.00046657 | 0.00050743 | 0.00063696 |   0.0 |  0.00
Modify  | 1.5609     | 1.5644     | 1.5687     |   0.2 |  3.86
Other   |            | 1.007      |            |       |  2.49

Nlocal:         43.125 ave          45 max          41 min
Histogram: 1 0 1 0 0 3 0 2 0 1
Nghost:        2789.38 ave        2799 max        2779 min
Histogram: 1 0 0 2 2 0 0 0 2 1
Neighs:        13651.5 ave       14169 max       12908 min
Histogram: 1 0 1 0 1 1 1 1 0 2

Total # of neighbors = 109212
Ave neighs/atom = 316.55652
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 44
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 13
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:17
