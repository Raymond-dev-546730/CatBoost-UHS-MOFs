LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (9.9792 9.9792 43.855)
  1 by 1 by 8 MPI processor grid
  reading atoms ...
  132 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.598566 3.976000  # In
pair_coeff 4 4 0.068956 3.261000  # N
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
132 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 1.6e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23679959
  grid = 8 8 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0022239307
  estimated relative force accuracy = 6.6973012e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1800 192
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 2 2 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.413 | 6.423 | 6.429 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            10045572       116.36486      0              0              4367.2753    
      5000   313.50091      10045559       122.41775      3              4              4367.2753    
     10000   329.50193      10045547       128.66593      9              8              4367.2753    
     15000   341.75586      10045555       133.45092      15             8              4367.2753    
     20000   366.18976      10045560       142.99202      22             10             4367.2753    
     25000   375.00826      10045545       146.43552      23             10             4367.2753    
     30000   386.7721       10045544       151.02914      28             10             4367.2753    
     35000   386.7721       10045544       151.02914      28             10             4367.2753    
     40000   389.77802      10045545       152.2029       30             11             4367.2753    
     45000   392.93781      10045543       153.43676      32             11             4367.2753    
     50000   393.97234      10045549       153.84073      32             12             4367.2753    
     55000   389.73914      10045535       152.18772      32             12             4367.2753    
     60000   394.66776      10045541       154.11228      33             13             4367.2753    
     65000   402.902        10045536       157.32764      34             14             4367.2753    
     70000   408.82868      10045535       159.64192      38             14             4367.2753    
     75000   411.41854      10045539       160.65323      40             14             4367.2753    
     80000   421.66439      10045543       164.65409      42             15             4367.2753    
     85000   421.43105      10045542       164.56297      44             14             4367.2753    
     90000   425.12892      10045544       166.00694      46             14             4367.2753    
     95000   425.12892      10045544       166.00694      46             14             4367.2753    
    100000   427.36207      10045545       166.87896      47             14             4367.2753    
Loop time of 24.3062 on 8 procs for 100000 steps with 193 atoms

Performance: 355.465 ns/day, 0.068 hours/ns, 4114.183 timesteps/s, 794.037 katom-step/s
83.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.3457     | 4.6046     | 4.9908     |   9.8 | 18.94
Bond    | 0.0035494  | 0.0038221  | 0.0040302  |   0.3 |  0.02
Kspace  | 9.4978     | 9.8589     | 10.074     |   6.2 | 40.56
Neigh   | 0.018313   | 0.019307   | 0.020863   |   0.6 |  0.08
Comm    | 7.5363     | 7.9937     | 8.2657     |   7.0 | 32.89
Output  | 0.0005888  | 0.00065476 | 0.0008113  |   0.0 |  0.00
Modify  | 0.85698    | 0.85778    | 0.85854    |   0.1 |  3.53
Other   |            | 0.9675     |            |       |  3.98

Nlocal:         24.125 ave          27 max          21 min
Histogram: 1 1 0 1 0 1 2 0 1 1
Nghost:        2077.62 ave        2125 max        2037 min
Histogram: 1 0 1 3 0 0 1 1 0 1
Neighs:        6165.88 ave        6918 max        5444 min
Histogram: 2 0 1 0 2 0 0 0 1 2

Total # of neighbors = 49327
Ave neighs/atom = 255.58031
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23340675
  grid = 6 6 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0023141954
  estimated relative force accuracy = 6.9691306e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1352 108
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.545 | 6.553 | 6.557 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   291.58558      10045545       166.87896      47             14             4367.2753    
    105000   291.58558      10045545       166.87896      47             14             4367.2753    
    110000   292.24258      10045546       167.25496      49             14             4367.2753    
    115000   292.24258      10045546       167.25496      49             14             4367.2753    
    120000   287.04117      10045540       164.27812      48             14             4367.2753    
    125000   289.9101       10045541       165.92005      48             15             4367.2753    
    130000   289.9101       10045541       165.92005      48             15             4367.2753    
    135000   289.9101       10045541       165.92005      48             15             4367.2753    
    140000   289.9101       10045541       165.92005      48             15             4367.2753    
    145000   289.9101       10045541       165.92005      48             15             4367.2753    
    150000   291.13241      10045543       166.6196       49             15             4367.2753    
    155000   291.13241      10045543       166.6196       49             15             4367.2753    
    160000   291.13241      10045543       166.6196       49             15             4367.2753    
    165000   293.25213      10045542       167.83275      50             15             4367.2753    
    170000   293.25213      10045542       167.83275      50             15             4367.2753    
    175000   293.44117      10045541       167.94094      51             15             4367.2753    
    180000   296.95247      10045543       169.95051      52             15             4367.2753    
    185000   295.84392      10045539       169.31607      51             15             4367.2753    
    190000   298.50991      10045538       170.84186      52             15             4367.2753    
    195000   300.47265      10045537       171.96516      52             15             4367.2753    
    200000   300.96433      10045538       172.24656      53             15             4367.2753    
Loop time of 25.6149 on 8 procs for 100000 steps with 200 atoms

Performance: 337.304 ns/day, 0.071 hours/ns, 3903.979 timesteps/s, 780.796 katom-step/s
83.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.0626     | 5.8178     | 6.2972     |  17.6 | 22.71
Bond    | 0.0034622  | 0.0037741  | 0.0040135  |   0.3 |  0.01
Kspace  | 8.2612     | 8.7291     | 9.5581     |  16.0 | 34.08
Neigh   | 0.021435   | 0.02447    | 0.026972   |   1.3 |  0.10
Comm    | 8.7453     | 8.9701     | 9.2929     |   6.2 | 35.02
Output  | 0.00056745 | 0.00065631 | 0.00087394 |   0.0 |  0.00
Modify  | 0.97595    | 0.97696    | 0.97763    |   0.0 |  3.81
Other   |            | 1.092      |            |       |  4.26

Nlocal:             25 ave          27 max          23 min
Histogram: 1 0 2 0 0 3 0 0 0 2
Nghost:        2158.25 ave        2210 max        2109 min
Histogram: 1 1 0 2 0 1 1 0 1 1
Neighs:           6612 ave        7075 max        5764 min
Histogram: 1 0 1 0 1 0 0 1 1 3

Total # of neighbors = 52896
Ave neighs/atom = 264.48
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 53
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 15
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:00:49
