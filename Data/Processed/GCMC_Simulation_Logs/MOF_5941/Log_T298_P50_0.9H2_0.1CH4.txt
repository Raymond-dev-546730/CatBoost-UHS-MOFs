LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (23.369 44.49 17.204)
  2 by 4 by 1 MPI processor grid
  reading atoms ...
  384 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
384 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 1.4e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22611378
  grid = 12 18 9
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0019140459
  estimated relative force accuracy = 5.7640922e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2080 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 4 7 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.589 | 6.594 | 6.61 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            38051575       340.21177      0              0              17886.772    
      5000   308.13514      38051571       351.78256      8              7              17886.772    
     10000   317.27984      38051563       362.22261      17             12             17886.772    
     15000   327.31062      38051556       373.67425      25             18             17886.772    
     20000   335.51573      38051550       383.04162      35             21             17886.772    
     25000   345.03373      38051540       393.90785      40             26             17886.772    
     30000   347.62366      38051540       396.86463      42             28             17886.772    
     35000   349.52989      38051540       399.04089      42             31             17886.772    
     40000   360.71924      38051541       411.81521      50             38             17886.772    
     45000   366.83844      38051537       418.8012       57             40             17886.772    
     50000   374.70996      38051543       427.78772      63             45             17886.772    
     55000   377.87052      38051543       431.39597      67             47             17886.772    
     60000   383.30751      38051541       437.60311      72             51             17886.772    
     65000   388.50264      38051553       443.53414      79             53             17886.772    
     70000   395.34434      38051548       451.34497      86             57             17886.772    
     75000   402.67746      38051561       459.71683      91             61             17886.772    
     80000   406.08361      38051564       463.60546      94             62             17886.772    
     85000   410.74145      38051565       468.92308      96             63             17886.772    
     90000   412.20382      38051554       470.59259      98             65             17886.772    
     95000   414.90302      38051553       473.67414      103            65             17886.772    
    100000   417.08691      38051536       476.16738      107            66             17886.772    
Loop time of 29.8236 on 8 procs for 100000 steps with 557 atoms

Performance: 289.704 ns/day, 0.083 hours/ns, 3353.052 timesteps/s, 1.868 Matom-step/s
93.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 8.5936     | 9.3913     | 10.022     |  15.2 | 31.49
Bond    | 0.0038624  | 0.0043836  | 0.0050633  |   0.6 |  0.01
Kspace  | 13.269     | 13.798     | 14.662     |  11.8 | 46.27
Neigh   | 0.037105   | 0.041237   | 0.044887   |   1.1 |  0.14
Comm    | 4.6184     | 4.7201     | 4.7996     |   2.9 | 15.83
Output  | 0.00060034 | 0.00066653 | 0.00096591 |   0.0 |  0.00
Modify  | 1.31       | 1.313      | 1.3246     |   0.4 |  4.40
Other   |            | 0.555      |            |       |  1.86

Nlocal:         69.625 ave          73 max          66 min
Histogram: 1 0 3 0 1 0 0 0 1 2
Nghost:           2126 ave        2153 max        2093 min
Histogram: 1 1 0 1 0 1 0 2 0 2
Neighs:        12213.6 ave       13222 max       11323 min
Histogram: 2 0 1 0 1 1 1 0 1 1

Total # of neighbors = 97709
Ave neighs/atom = 175.42011
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2167872
  grid = 10 16 8
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0028791626
  estimated relative force accuracy = 8.6705126e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1170 160
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.678 | 6.679 | 6.679 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   287.30987      38051536       476.16738      107            66             17886.772    
    105000   293.59881      38051535       486.59022      113            66             17886.772    
    110000   294.19886      38051528       487.58472      112            69             17886.772    
    115000   295.54302      38051532       489.81243      112            71             17886.772    
    120000   298.57468      38051534       494.83689      115            72             17886.772    
    125000   298.97667      38051539       495.50312      116            73             17886.772    
    130000   302.41749      38051545       501.2057       121            73             17886.772    
    135000   305.94447      38051548       507.05107      123            74             17886.772    
    140000   309.77046      38051549       513.39199      124            76             17886.772    
    145000   311.32782      38051556       515.97306      127            76             17886.772    
    150000   311.99613      38051553       517.08067      127            78             17886.772    
    155000   314.76563      38051551       521.67065      129            79             17886.772    
    160000   315.755        38051547       523.31035      130            80             17886.772    
    165000   316.71045      38051550       524.89386      132            81             17886.772    
    170000   316.11123      38051543       523.90075      131            81             17886.772    
    175000   315.50782      38051540       522.9007       132            83             17886.772    
    180000   317.81596      38051538       526.72605      133            84             17886.772    
    185000   318.44893      38051544       527.77508      136            84             17886.772    
    190000   320.43832      38051549       531.07217      140            84             17886.772    
    195000   321.58095      38051544       532.96588      140            86             17886.772    
    200000   323.2347       38051545       535.70668      142            86             17886.772    
Loop time of 32.4195 on 8 procs for 100000 steps with 612 atoms

Performance: 266.507 ns/day, 0.090 hours/ns, 3084.567 timesteps/s, 1.888 Matom-step/s
95.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 12.388     | 14.273     | 15.096     |  24.6 | 44.03
Bond    | 0.0040095  | 0.0043731  | 0.0051435  |   0.5 |  0.01
Kspace  | 9.8773     | 10.682     | 12.505     |  27.3 | 32.95
Neigh   | 0.053557   | 0.057373   | 0.061046   |   1.1 |  0.18
Comm    | 5.0498     | 5.1425     | 5.2458     |   2.7 | 15.86
Output  | 0.00060657 | 0.00065886 | 0.00090428 |   0.0 |  0.00
Modify  | 1.6326     | 1.6357     | 1.6468     |   0.3 |  5.05
Other   |            | 0.624      |            |       |  1.92

Nlocal:           76.5 ave          80 max          71 min
Histogram: 1 0 0 2 1 0 0 1 0 3
Nghost:           2324 ave        2340 max        2308 min
Histogram: 1 0 0 3 1 0 1 1 0 1
Neighs:        14800.9 ave       15775 max       13143 min
Histogram: 1 0 0 1 0 1 1 1 1 2

Total # of neighbors = 118407
Ave neighs/atom = 193.47549
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 142
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 86
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:02
