LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (18.171 18.171 18.171)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  248 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.003 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
248 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 3.5e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.24838831
  grid = 12 12 12
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0013545754
  estimated relative force accuracy = 4.0792636e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 288
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.493 | 6.496 | 6.5 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            12676137       219.4055       0              0              5999.796     
      5000   303.76566      12676140       223.65053      2              2              5999.796     
     10000   309.88021      12676142       228.15243      9              4              5999.796     
     15000   313.30216      12676136       230.67188      11             5              5999.796     
     20000   319.70878      12676131       235.38881      17             6              5999.796     
     25000   328.74411      12676130       242.04117      19             7              5999.796     
     30000   333.02077      12676126       245.1899       21             9              5999.796     
     35000   336.09701      12676137       247.45481      23             11             5999.796     
     40000   336.28325      12676139       247.59193      22             13             5999.796     
     45000   334.61682      12676128       246.36501      24             12             5999.796     
     50000   337.49787      12676119       248.48621      24             14             5999.796     
     55000   338.28373      12676122       249.06481      24             16             5999.796     
     60000   342.11272      12676118       251.88394      24             18             5999.796     
     65000   343.58102      12676118       252.96499      26             18             5999.796     
     70000   346.10686      12676110       254.82466      26             19             5999.796     
     75000   347.52759      12676113       255.87069      28             19             5999.796     
     80000   348.12736      12676110       256.31228      28             19             5999.796     
     85000   348.49288      12676112       256.5814       28             19             5999.796     
     90000   348.7411       12676112       256.76415      29             19             5999.796     
     95000   348.7411       12676112       256.76415      29             19             5999.796     
    100000   354.95391      12676112       261.33839      33             19             5999.796     
Loop time of 37.6431 on 8 procs for 100000 steps with 300 atoms

Performance: 229.524 ns/day, 0.105 hours/ns, 2656.526 timesteps/s, 796.958 katom-step/s
88.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.1547     | 9.0434     | 14.122     | 117.7 | 24.02
Bond    | 0.0034161  | 0.0035679  | 0.0037505  |   0.2 |  0.01
Kspace  | 12.962     | 17.206     | 21.067     |  80.7 | 45.71
Neigh   | 0.025393   | 0.03848    | 0.052048   |   6.1 |  0.10
Comm    | 8.0746     | 8.9156     | 9.7086     |  14.8 | 23.68
Output  | 0.00041899 | 0.00045857 | 0.00062864 |   0.0 |  0.00
Modify  | 1.4864     | 1.4928     | 1.4994     |   0.4 |  3.97
Other   |            | 0.9425     |            |       |  2.50

Nlocal:           37.5 ave          51 max          24 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:           2504 ave        2522 max        2482 min
Histogram: 1 0 1 2 0 0 0 1 1 2
Neighs:        10728.2 ave       15501 max        6729 min
Histogram: 3 1 0 0 0 0 0 2 0 2

Total # of neighbors = 85826
Ave neighs/atom = 286.08667
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23660305
  grid = 10 10 10
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0028039614
  estimated relative force accuracy = 8.4440464e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1728 200
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.596 | 6.598 | 6.603 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   293.22279      12676112       261.33839      33             19             5999.796     
    105000   295.49136      12676114       263.36028      35             19             5999.796     
    110000   298.05764      12676120       265.64751      37             19             5999.796     
    115000   298.56662      12676123       266.10115      38             20             5999.796     
    120000   297.57841      12676118       265.22039      37             20             5999.796     
    125000   301.79216      12676121       268.97594      39             20             5999.796     
    130000   301.79216      12676121       268.97594      39             20             5999.796     
    135000   302.57705      12676124       269.67549      40             20             5999.796     
    140000   305.5814       12676125       272.35315      41             20             5999.796     
    145000   305.5814       12676125       272.35315      41             20             5999.796     
    150000   307.28617      12676129       273.87255      43             20             5999.796     
    155000   306.93298      12676124       273.55777      42             20             5999.796     
    160000   307.93244      12676124       274.44855      43             21             5999.796     
    165000   307.93244      12676124       274.44855      43             21             5999.796     
    170000   308.41827      12676127       274.88155      44             21             5999.796     
    175000   308.77146      12676129       275.19633      45             21             5999.796     
    180000   310.85124      12676131       277.04996      46             21             5999.796     
    185000   312.20282      12676129       278.25457      47             21             5999.796     
    190000   312.44074      12676128       278.46663      48             20             5999.796     
    195000   312.44074      12676128       278.46663      48             20             5999.796     
    200000   312.85153      12676130       278.83274      49             20             5999.796     
Loop time of 37.2495 on 8 procs for 100000 steps with 317 atoms

Performance: 231.949 ns/day, 0.103 hours/ns, 2684.599 timesteps/s, 851.018 katom-step/s
88.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.7785     | 11.178     | 16.316     | 117.0 | 30.01
Bond    | 0.0034617  | 0.0036522  | 0.0039687  |   0.3 |  0.01
Kspace  | 9.7124     | 14.595     | 18.785     |  97.0 | 39.18
Neigh   | 0.032896   | 0.045754   | 0.059122   |   5.9 |  0.12
Comm    | 8.3845     | 8.9265     | 9.2661     |   9.2 | 23.96
Output  | 0.00041697 | 0.00045385 | 0.00057098 |   0.0 |  0.00
Modify  | 1.5764     | 1.5838     | 1.5908     |   0.4 |  4.25
Other   |            | 0.9164     |            |       |  2.46

Nlocal:         39.625 ave          54 max          26 min
Histogram: 4 0 0 0 0 0 0 0 3 1
Nghost:        2643.88 ave        2664 max        2621 min
Histogram: 1 0 1 1 1 0 0 2 1 1
Neighs:        11979.4 ave       16569 max        7682 min
Histogram: 2 2 0 0 0 0 0 1 1 2

Total # of neighbors = 95835
Ave neighs/atom = 302.31861
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 49
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 20
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:14
