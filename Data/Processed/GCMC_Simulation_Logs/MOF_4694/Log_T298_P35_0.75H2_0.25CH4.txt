LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 75.0% H₂ / 25.0% CH₄ at 35 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (29.0202 29.0202 41.0408)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  1312 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.005 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.226839 3.516000  # Cl
pair_coeff 3 3 0.012996 2.594000  # Fe
pair_coeff 4 4 0.043997 2.571000  # H
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
1312 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.939543
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.939543 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 0.000181 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23101905
  grid = 15 15 20
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0025797874
  estimated relative force accuracy = 7.768953e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2940 675
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 5 5 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.76 | 6.771 | 6.777 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            1.4887369e+13  1164.5369      0              0              34563.413    
      5000   302.29795      1.4887369e+13  1181.3326      9              11             34563.413    
     10000   303.47855      1.4887369e+13  1185.9462      15             15             34563.413    
     15000   305.97179      1.4887369e+13  1195.6894      24             22             34563.413    
     20000   309.91554      1.4887369e+13  1211.101       33             26             34563.413    
     25000   313.44369      1.4887369e+13  1224.8884      38             30             34563.413    
     30000   314.63441      1.4887369e+13  1229.5416      41             34             34563.413    
     35000   317.55368      1.4887369e+13  1240.9496      48             36             34563.413    
     40000   320.25397      1.4887369e+13  1251.5019      54             43             34563.413    
     45000   321.70019      1.4887369e+13  1257.1535      59             45             34563.413    
     50000   324.85522      1.4887369e+13  1269.4829      64             51             34563.413    
     55000   326.07152      1.4887369e+13  1274.236       69             53             34563.413    
     60000   327.52964      1.4887369e+13  1279.9341      72             58             34563.413    
     65000   330.54746      1.4887369e+13  1291.7272      80             63             34563.413    
     70000   332.06556      1.4887369e+13  1297.6597      85             66             34563.413    
     75000   334.31162      1.4887369e+13  1306.437       90             69             34563.413    
     80000   337.37012      1.4887369e+13  1318.3891      95             72             34563.413    
     85000   338.65824      1.4887369e+13  1323.4229      99             77             34563.413    
     90000   340.12956      1.4887369e+13  1329.1726      105            80             34563.413    
     95000   341.16542      1.4887369e+13  1333.2205      107            84             34563.413    
    100000   342.38284      1.4887369e+13  1337.978       113            84             34563.413    
Loop time of 99.3144 on 8 procs for 100000 steps with 1509 atoms

Performance: 86.996 ns/day, 0.276 hours/ns, 1006.903 timesteps/s, 1.519 Matom-step/s
91.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.491     | 50.68      | 52.579     |  13.9 | 51.03
Bond    | 0.004732   | 0.0054029  | 0.0060205  |   0.6 |  0.01
Kspace  | 28.561     | 30.743     | 31.907     |  20.1 | 30.96
Neigh   | 0.16185    | 0.16497    | 0.17024    |   0.7 |  0.17
Comm    | 11.655     | 11.841     | 12.023     |   3.7 | 11.92
Output  | 0.00068952 | 0.00073826 | 0.0010379  |   0.0 |  0.00
Modify  | 4.2409     | 4.2434     | 4.248      |   0.1 |  4.27
Other   |            | 1.636      |            |       |  1.65

Nlocal:        188.625 ave         191 max         184 min
Histogram: 1 0 0 0 0 3 0 0 3 1
Nghost:        3802.38 ave        3813 max        3790 min
Histogram: 1 1 0 1 0 1 1 1 1 1
Neighs:        47746.5 ave       49108 max       46678 min
Histogram: 2 1 0 0 0 3 1 0 0 1

Total # of neighbors = 381972
Ave neighs/atom = 253.12922
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23106092
  grid = 15 15 20
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0024036902
  estimated relative force accuracy = 7.2386416e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2940 675
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.891 | 6.903 | 6.908 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   297.6551       1.4887369e+13  1337.978       113            84             34563.413    
    105000   299.06668      1.4887369e+13  1344.3231      118            87             34563.413    
    110000   300.05651      1.4887369e+13  1348.7725      121            89             34563.413    
    115000   300.27008      1.4887369e+13  1349.7325      122            90             34563.413    
    120000   301.72242      1.4887369e+13  1356.2609      127            90             34563.413    
    125000   302.17417      1.4887369e+13  1358.2915      130            91             34563.413    
    130000   303.30928      1.4887369e+13  1363.3939      133            94             34563.413    
    135000   304.06701      1.4887369e+13  1366.7999      137            95             34563.413    
    140000   305.08996      1.4887369e+13  1371.3981      140            95             34563.413    
    145000   306.19174      1.4887369e+13  1376.3507      145            96             34563.413    
    150000   308.06979      1.4887369e+13  1384.7927      148            100            34563.413    
    155000   308.187        1.4887369e+13  1385.3195      150            99             34563.413    
    160000   309.05736      1.4887369e+13  1389.2318      151            100            34563.413    
    165000   310.29229      1.4887369e+13  1394.783       155            100            34563.413    
    170000   311.8867       1.4887369e+13  1401.9499      161            99             34563.413    
    175000   312.70372      1.4887369e+13  1405.6225      167            98             34563.413    
    180000   313.37038      1.4887369e+13  1408.6191      169            99             34563.413    
    185000   313.0889       1.4887369e+13  1407.3539      170            99             34563.413    
    190000   313.57874      1.4887369e+13  1409.5557      174            100            34563.413    
    195000   313.94486      1.4887369e+13  1411.2015      177            100            34563.413    
    200000   314.99178      1.4887369e+13  1415.9074      180            102            34563.413    
Loop time of 111.154 on 8 procs for 100000 steps with 1594 atoms

Performance: 77.730 ns/day, 0.309 hours/ns, 899.654 timesteps/s, 1.434 Matom-step/s
91.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.483     | 60.965     | 62.717     |  13.6 | 54.85
Bond    | 0.0047892  | 0.0054611  | 0.0062806  |   0.6 |  0.00
Kspace  | 29.164     | 30.892     | 32.15      |  18.2 | 27.79
Neigh   | 0.18915    | 0.19452    | 0.20043    |   0.9 |  0.18
Comm    | 12.325     | 12.545     | 12.712     |   4.0 | 11.29
Output  | 0.00072962 | 0.00077505 | 0.0010449  |   0.0 |  0.00
Modify  | 4.8545     | 4.8575     | 4.8628     |   0.1 |  4.37
Other   |            | 1.693      |            |       |  1.52

Nlocal:         199.25 ave         202 max         195 min
Histogram: 1 0 1 0 1 1 0 0 3 1
Nghost:        4002.38 ave        4022 max        3988 min
Histogram: 1 1 1 1 1 2 0 0 0 1
Neighs:        53149.6 ave       54565 max       51834 min
Histogram: 2 1 0 0 1 0 1 1 1 1

Total # of neighbors = 425197
Ave neighs/atom = 266.74843
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 180
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 102
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:03:30
