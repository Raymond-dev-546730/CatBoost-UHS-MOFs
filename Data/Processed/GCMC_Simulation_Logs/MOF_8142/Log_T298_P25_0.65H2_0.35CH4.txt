LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 65.0% H₂ / 35.0% CH₄ at 25 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (18.171 18.171 18.171)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  248 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.003 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
248 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.653801
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.653801 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 2.8e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.24838867
  grid = 12 12 12
  stencil order = 5
  estimated absolute RMS force accuracy = 0.001359238
  estimated relative force accuracy = 4.093305e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 288
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.493 | 6.496 | 6.5 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            12676112       219.4055       0              0              5999.796     
      5000   303.76566      12676115       223.65053      2              2              5999.796     
     10000   309.88021      12676117       228.15243      9              4              5999.796     
     15000   313.30216      12676111       230.67188      11             5              5999.796     
     20000   319.70878      12676107       235.38881      17             6              5999.796     
     25000   328.74411      12676105       242.04117      19             7              5999.796     
     30000   333.02077      12676101       245.1899       21             9              5999.796     
     35000   333.55066      12676107       245.58004      23             10             5999.796     
     40000   333.73691      12676109       245.71716      22             12             5999.796     
     45000   334.61682      12676104       246.36501      24             12             5999.796     
     50000   337.49787      12676094       248.48621      24             14             5999.796     
     55000   338.28373      12676098       249.06481      24             16             5999.796     
     60000   342.14914      12676089       251.91075      24             18             5999.796     
     65000   343.61744      12676089       252.99181      26             18             5999.796     
     70000   345.83781      12676088       254.62658      26             20             5999.796     
     75000   349.01024      12676093       256.96231      29             20             5999.796     
     80000   349.93456      12676090       257.64285      29             20             5999.796     
     85000   347.40305      12676086       255.779        28             20             5999.796     
     90000   347.65127      12676086       255.96175      29             20             5999.796     
     95000   347.65127      12676086       255.96175      29             20             5999.796     
    100000   351.79754      12676093       259.01449      32             20             5999.796     
Loop time of 39.2741 on 8 procs for 100000 steps with 300 atoms

Performance: 219.993 ns/day, 0.109 hours/ns, 2546.209 timesteps/s, 763.863 katom-step/s
88.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.1844     | 9.235      | 14.332     | 118.9 | 23.51
Bond    | 0.0034349  | 0.0036394  | 0.0037994  |   0.2 |  0.01
Kspace  | 12.789     | 18.471     | 22.25      |  81.2 | 47.03
Neigh   | 0.024777   | 0.038556   | 0.052421   |   6.3 |  0.10
Comm    | 8.453      | 8.9987     | 9.8111     |  12.9 | 22.91
Output  | 0.00051116 | 0.00054304 | 0.00071141 |   0.0 |  0.00
Modify  | 1.5229     | 1.529      | 1.5366     |   0.4 |  3.89
Other   |            | 0.9973     |            |       |  2.54

Nlocal:           37.5 ave          51 max          24 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:         2501.5 ave        2522 max        2478 min
Histogram: 1 0 2 0 1 0 1 1 1 1
Neighs:          10728 ave       15550 max        6768 min
Histogram: 3 1 0 0 0 0 0 2 1 1

Total # of neighbors = 85824
Ave neighs/atom = 286.08
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23660372
  grid = 10 10 10
  stencil order = 5
  estimated absolute RMS force accuracy = 0.002813599
  estimated relative force accuracy = 8.4730698e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 1728 200
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.596 | 6.598 | 6.603 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   290.61536      12676093       259.01449      32             20             5999.796     
    105000   292.88393      12676095       261.03638      34             20             5999.796     
    110000   294.99592      12676097       262.91872      35             20             5999.796     
    115000   294.79306      12676102       262.73792      35             21             5999.796     
    120000   293.70197      12676086       261.76546      33             21             5999.796     
    125000   300.01097      12676088       267.38844      36             21             5999.796     
    130000   300.01097      12676088       267.38844      36             21             5999.796     
    135000   300.79586      12676091       268.08799      37             21             5999.796     
    140000   303.80021      12676091       270.76565      38             21             5999.796     
    145000   304.44745      12676091       271.3425       39             21             5999.796     
    150000   305.69793      12676090       272.45702      40             21             5999.796     
    155000   305.69793      12676090       272.45702      40             21             5999.796     
    160000   306.6974       12676090       273.3478       41             22             5999.796     
    165000   306.6974       12676090       273.3478       41             22             5999.796     
    170000   307.18322      12676089       273.7808       42             22             5999.796     
    175000   308.00628      12676095       274.51436      44             22             5999.796     
    180000   308.95022      12676088       275.35565      46             21             5999.796     
    185000   310.34201      12676084       276.5961       47             21             5999.796     
    190000   310.81188      12676085       277.01488      48             21             5999.796     
    195000   311.85687      12676088       277.94624      49             21             5999.796     
    200000   311.85687      12676088       277.94624      49             21             5999.796     
Loop time of 38.5935 on 8 procs for 100000 steps with 318 atoms

Performance: 223.872 ns/day, 0.107 hours/ns, 2591.111 timesteps/s, 823.973 katom-step/s
88.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.7861     | 11.223     | 16.36      | 117.2 | 29.08
Bond    | 0.0033781  | 0.0037734  | 0.0042656  |   0.4 |  0.01
Kspace  | 10.312     | 15.861     | 19.893     |  95.5 | 41.10
Neigh   | 0.031717   | 0.045452   | 0.062827   |   6.0 |  0.12
Comm    | 7.9884     | 8.8002     | 9.527      |  19.9 | 22.80
Output  | 0.00044239 | 0.00051397 | 0.00068224 |   0.0 |  0.00
Modify  | 1.6312     | 1.6384     | 1.6466     |   0.4 |  4.25
Other   |            | 1.021      |            |       |  2.64

Nlocal:          39.75 ave          54 max          26 min
Histogram: 3 1 0 0 0 0 0 0 2 2
Nghost:        2645.25 ave        2667 max        2621 min
Histogram: 1 1 0 0 1 2 1 0 0 2
Neighs:        12051.8 ave       16702 max        7731 min
Histogram: 3 1 0 0 0 0 0 1 1 2

Total # of neighbors = 96414
Ave neighs/atom = 303.18868
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 49
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 21
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:17
