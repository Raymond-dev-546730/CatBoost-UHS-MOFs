LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (17.427 22.7852 25.235)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  384 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
384 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 2.1e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23690527
  grid = 10 12 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0024112132
  estimated relative force accuracy = 7.261297e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2184 240
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.53 | 6.533 | 6.533 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            29475179       340.21177      0              0              10020.255    
      5000   302.88812      29475172       345.7923       4              2              10020.255    
     10000   305.44426      29475170       348.71052      6              6              10020.255    
     15000   310.01211      29475158       353.9254       11             11             10020.255    
     20000   319.64427      29475164       364.92196      18             16             10020.255    
     25000   326.21881      29475162       372.42779      23             16             10020.255    
     30000   327.74245      29475158       374.16725      25             17             10020.255    
     35000   332.77223      29475165       379.90949      28             18             10020.255    
     40000   332.34236      29475162       379.41873      32             19             10020.255    
     45000   331.72449      29475155       378.71335      33             19             10020.255    
     50000   334.51746      29475149       381.90195      35             21             10020.255    
     55000   340.6532       29475149       388.90681      38             23             10020.255    
     60000   343.50139      29475157       392.15845      41             26             10020.255    
     65000   347.624        29475163       396.86503      45             28             10020.255    
     70000   349.74268      29475163       399.28381      47             29             10020.255    
     75000   351.82591      29475162       401.66214      50             29             10020.255    
     80000   350.11333      29475142       399.70697      50             26             10020.255    
     85000   358.30013      29475138       409.05344      54             27             10020.255    
     90000   359.61185      29475136       410.55096      55             28             10020.255    
     95000   360.96739      29475135       412.09851      57             28             10020.255    
    100000   365.25557      29475136       416.99412      59             29             10020.255    
Loop time of 40.6964 on 8 procs for 100000 steps with 472 atoms

Performance: 212.304 ns/day, 0.113 hours/ns, 2457.220 timesteps/s, 1.160 Matom-step/s
88.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.838     | 13.575     | 15.528     |  36.4 | 33.36
Bond    | 0.0035596  | 0.0037555  | 0.0041437  |   0.3 |  0.01
Kspace  | 13.222     | 15.279     | 17.1       |  33.4 | 37.54
Neigh   | 0.045665   | 0.052064   | 0.056846   |   1.5 |  0.13
Comm    | 8.6425     | 9.1339     | 9.5855     |   9.3 | 22.44
Output  | 0.00051952 | 0.00055434 | 0.00071346 |   0.0 |  0.00
Modify  | 1.6048     | 1.6065     | 1.6091     |   0.1 |  3.95
Other   |            | 1.047      |            |       |  2.57

Nlocal:             59 ave          63 max          56 min
Histogram: 2 1 0 0 2 1 0 0 1 1
Nghost:        2703.12 ave        2714 max        2695 min
Histogram: 1 2 1 0 1 1 0 0 1 1
Neighs:        15963.8 ave       17825 max       14217 min
Histogram: 1 1 1 1 1 0 0 1 1 1

Total # of neighbors = 127710
Ave neighs/atom = 270.57203
Ave special neighs/atom = 0
Neighbor list builds = 1295
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23690507
  grid = 10 12 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0021748632
  estimated relative force accuracy = 6.5495358e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2184 240
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.662 | 6.664 | 6.665 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   297.01249      29475136       416.99412      59             29             10020.255    
    105000   297.01249      29475136       416.99412      59             29             10020.255    
    110000   297.12237      29475140       417.14838      60             29             10020.255    
    115000   297.8701       29475145       418.19817      62             29             10020.255    
    120000   300.18597      29475144       421.44956      63             29             10020.255    
    125000   300.34392      29475146       421.67131      64             29             10020.255    
    130000   301.10834      29475153       422.74453      65             30             10020.255    
    135000   301.16103      29475150       422.8185       64             31             10020.255    
    140000   302.8486       29475144       425.18779      64             31             10020.255    
    145000   303.81895      29475147       426.55011      66             31             10020.255    
    150000   302.43525      29475145       424.60746      66             31             10020.255    
    155000   302.51231      29475144       424.71565      67             31             10020.255    
    160000   303.37007      29475148       425.91991      69             31             10020.255    
    165000   305.5779       29475150       429.01962      71             31             10020.255    
    170000   305.3713       29475146       428.72956      70             32             10020.255    
    175000   306.80266      29475148       430.73914      71             32             10020.255    
    180000   306.54155      29475142       430.37255      71             32             10020.255    
    185000   308.10362      29475145       432.56563      73             32             10020.255    
    190000   308.06291      29475142       432.50847      72             33             10020.255    
    195000   308.06291      29475142       432.50847      72             33             10020.255    
    200000   309.38319      29475147       434.3621       73             33             10020.255    
Loop time of 45.0759 on 8 procs for 100000 steps with 490 atoms

Performance: 191.677 ns/day, 0.125 hours/ns, 2218.482 timesteps/s, 1.087 Matom-step/s
88.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.885     | 17.182     | 19.197     |  35.5 | 38.12
Bond    | 0.003689   | 0.003867   | 0.0040522  |   0.2 |  0.01
Kspace  | 13.565     | 15.694     | 17.886     |  37.8 | 34.82
Neigh   | 0.056331   | 0.062696   | 0.06815    |   1.5 |  0.14
Comm    | 8.9633     | 9.2372     | 9.3381     |   3.7 | 20.49
Output  | 0.00051722 | 0.00054745 | 0.00073279 |   0.0 |  0.00
Modify  | 1.8182     | 1.8204     | 1.8228     |   0.1 |  4.04
Other   |            | 1.075      |            |       |  2.39

Nlocal:          61.25 ave          68 max          56 min
Histogram: 1 0 2 1 1 1 1 0 0 1
Nghost:         2805.5 ave        2824 max        2797 min
Histogram: 4 0 0 1 1 0 0 1 0 1
Neighs:        17198.8 ave       19135 max       15341 min
Histogram: 2 0 0 1 2 0 0 1 1 1

Total # of neighbors = 137590
Ave neighs/atom = 280.79592
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 73
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 33
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:25
