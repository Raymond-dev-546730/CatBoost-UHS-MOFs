LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 75.0% H₂ / 25.0% CH₄ at 35 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (17.427 22.7852 25.235)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  384 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
384 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.939543
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.939543 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 2.1e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23690527
  grid = 10 12 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0024112132
  estimated relative force accuracy = 7.261297e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2184 240
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.53 | 6.533 | 6.533 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            29475179       340.21177      0              0              10020.255    
      5000   302.88812      29475172       345.7923       4              2              10020.255    
     10000   305.44426      29475170       348.71052      6              6              10020.255    
     15000   310.01211      29475158       353.9254       11             11             10020.255    
     20000   319.64427      29475164       364.92196      18             16             10020.255    
     25000   326.76882      29475174       373.0557       23             18             10020.255    
     30000   328.00504      29475163       374.46704      25             18             10020.255    
     35000   332.77223      29475162       379.90949      28             18             10020.255    
     40000   333.40491      29475160       380.63179      32             19             10020.255    
     45000   334.08923      29475153       381.41306      34             18             10020.255    
     50000   336.88221      29475148       384.60165      36             20             10020.255    
     55000   342.85937      29475142       391.42549      39             21             10020.255    
     60000   345.70756      29475151       394.67712      42             24             10020.255    
     65000   349.83017      29475157       399.3837       46             26             10020.255    
     70000   351.94884      29475157       401.80249      48             27             10020.255    
     75000   354.74722      29475158       404.99725      52             28             10020.255    
     80000   354.41529      29475153       404.6183       52             28             10020.255    
     85000   362.13013      29475149       413.42595      56             28             10020.255    
     90000   362.45124      29475140       413.79255      56             29             10020.255    
     95000   363.80678      29475139       415.3401       58             29             10020.255    
    100000   368.09496      29475141       420.2357       60             30             10020.255    
Loop time of 40.8366 on 8 procs for 100000 steps with 474 atoms

Performance: 211.575 ns/day, 0.113 hours/ns, 2448.783 timesteps/s, 1.161 Matom-step/s
88.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.586     | 13.66      | 15.582     |  36.2 | 33.45
Bond    | 0.0036017  | 0.0038411  | 0.0041178  |   0.3 |  0.01
Kspace  | 12.969     | 15.35      | 16.983     |  37.4 | 37.59
Neigh   | 0.045877   | 0.052858   | 0.05633    |   1.6 |  0.13
Comm    | 8.7082     | 9.0802     | 9.6329     |  10.3 | 22.24
Output  | 0.0005099  | 0.0005766  | 0.00075036 |   0.0 |  0.00
Modify  | 1.6754     | 1.6783     | 1.6817     |   0.2 |  4.11
Other   |            | 1.01       |            |       |  2.47

Nlocal:          59.25 ave          64 max          56 min
Histogram: 2 1 0 2 0 0 1 1 0 1
Nghost:        2713.38 ave        2724 max        2703 min
Histogram: 1 2 1 0 0 1 0 1 0 2
Neighs:        16103.6 ave       18223 max       14268 min
Histogram: 1 2 0 1 1 0 0 2 0 1

Total # of neighbors = 128829
Ave neighs/atom = 271.79114
Ave special neighs/atom = 0
Neighbor list builds = 1295
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23690506
  grid = 10 12 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0021702703
  estimated relative force accuracy = 6.5357044e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2184 240
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.662 | 6.664 | 6.665 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   298.05575      29475141       420.2357       60             30             10020.255    
    105000   300.04325      29475134       423.03792      61             29             10020.255    
    110000   300.15266      29475138       423.19218      62             29             10020.255    
    115000   300.89723      29475143       424.24197      64             29             10020.255    
    120000   303.20331      29475142       427.49337      65             29             10020.255    
    125000   303.36058      29475143       427.71511      66             29             10020.255    
    130000   303.31966      29475145       427.65741      66             30             10020.255    
    135000   303.41815      29475148       427.79627      66             31             10020.255    
    140000   306.41392      29475153       432.02008      68             32             10020.255    
    145000   307.38016      29475156       433.3824       70             32             10020.255    
    150000   306.49486      29475150       432.13419      69             33             10020.255    
    155000   306.57159      29475148       432.24238      70             33             10020.255    
    160000   306.86862      29475150       432.66117      71             33             10020.255    
    165000   309.92755      29475153       436.97403      74             33             10020.255    
    170000   310.24314      29475157       437.41899      74             34             10020.255    
    175000   311.09885      29475154       438.62547      74             34             10020.255    
    180000   311.29843      29475152       438.90687      75             34             10020.255    
    185000   312.76344      29475152       440.97241      76             34             10020.255    
    190000   312.76344      29475152       440.97241      76             34             10020.255    
    195000   312.76344      29475152       440.97241      76             34             10020.255    
    200000   314.07814      29475157       442.82604      77             34             10020.255    
Loop time of 47.7976 on 8 procs for 100000 steps with 495 atoms

Performance: 180.762 ns/day, 0.133 hours/ns, 2092.155 timesteps/s, 1.036 Matom-step/s
89.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.746     | 17.526     | 19.995     |  39.8 | 36.67
Bond    | 0.0036955  | 0.0039511  | 0.0043001  |   0.3 |  0.01
Kspace  | 14.383     | 16.85      | 19.639     |  42.7 | 35.25
Neigh   | 0.057206   | 0.064158   | 0.069687   |   1.6 |  0.13
Comm    | 9.8889     | 10.158     | 10.571     |   6.1 | 21.25
Output  | 0.00052119 | 0.00057992 | 0.00073387 |   0.0 |  0.00
Modify  | 1.9978     | 1.9998     | 2.0038     |   0.1 |  4.18
Other   |            | 1.196      |            |       |  2.50

Nlocal:         61.875 ave          68 max          58 min
Histogram: 1 2 0 0 2 1 1 0 0 1
Nghost:        2834.88 ave        2855 max        2823 min
Histogram: 3 0 2 0 0 0 1 1 0 1
Neighs:        17557.9 ave       19429 max       15431 min
Histogram: 1 0 1 1 2 0 0 1 0 2

Total # of neighbors = 140463
Ave neighs/atom = 283.76364
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 77
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 34
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:28
