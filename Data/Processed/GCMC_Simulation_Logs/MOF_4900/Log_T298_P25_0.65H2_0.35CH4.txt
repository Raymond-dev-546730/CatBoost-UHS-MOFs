LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 65.0% H₂ / 35.0% CH₄ at 25 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (36.5584 36.5584 36.5584)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  920 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.005 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.598566 3.976000  # In
pair_coeff 4 4 0.068956 3.261000  # N
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
920 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.653801
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.653801 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 7.3e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22910224
  grid = 18 18 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0026593015
  estimated relative force accuracy = 8.0084075e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 972
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 6 6 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.701 | 6.706 | 6.723 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            92024142       816.3306       0              0              48860.909    
      5000   304.14528      92024137       833.16476      9              12             48860.909    
     10000   307.45133      92024136       842.22125      17             21             48860.909    
     15000   310.99501      92024145       851.92867      27             28             48860.909    
     20000   318.56959      92024146       872.67821      43             31             48860.909    
     25000   324.13918      92024146       887.93533      50             38             48860.909    
     30000   327.1628       92024143       896.21815      55             43             48860.909    
     35000   332.12282      92024150       909.80544      61             49             48860.909    
     40000   334.84463      92024150       917.26148      71             56             48860.909    
     45000   338.29066      92024153       926.7014       76             62             48860.909    
     50000   340.87005      92024147       933.76728      81             69             48860.909    
     55000   344.32133      92024140       943.22161      86             74             48860.909    
     60000   348.73215      92024139       955.30445      91             81             48860.909    
     65000   353.16429      92024132       967.4457       99             86             48860.909    
     70000   356.29478      92024124       976.02126      106            91             48860.909    
     75000   360.97512      92024118       988.8424       119            93             48860.909    
     80000   365.13967      92024107       1000.2506      123            98             48860.909    
     85000   370.53593      92024100       1015.0329      130            104            48860.909    
     90000   371.33916      92024086       1017.2333      133            108            48860.909    
     95000   374.03193      92024093       1024.6098      138            112            48860.909    
    100000   378.90638      92024084       1037.9627      149            113            48860.909    
Loop time of 55.904 on 8 procs for 100000 steps with 1182 atoms

Performance: 154.551 ns/day, 0.155 hours/ns, 1788.782 timesteps/s, 2.114 Matom-step/s
86.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 16.558     | 17.339     | 17.938     |  10.7 | 31.02
Bond    | 0.0035638  | 0.0041419  | 0.004874   |   0.7 |  0.01
Kspace  | 26.543     | 27.196     | 27.801     |   8.0 | 48.65
Neigh   | 0.056669   | 0.062911   | 0.069925   |   1.9 |  0.11
Comm    | 7.8034     | 8.1672     | 8.3898     |   6.2 | 14.61
Output  | 0.00058311 | 0.00062656 | 0.00079595 |   0.0 |  0.00
Modify  | 2.0407     | 2.0425     | 2.044      |   0.1 |  3.65
Other   |            | 1.091      |            |       |  1.95

Nlocal:         147.75 ave         152 max         142 min
Histogram: 1 0 0 0 2 1 0 2 0 2
Nghost:        2626.12 ave        2651 max        2610 min
Histogram: 1 1 2 1 0 1 1 0 0 1
Neighs:        20469.8 ave       21460 max       19698 min
Histogram: 2 0 0 3 1 0 0 0 0 2

Total # of neighbors = 163758
Ave neighs/atom = 138.54315
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22913474
  grid = 18 18 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0023448013
  estimated relative force accuracy = 7.0612996e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 972
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.832 | 6.838 | 6.855 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   294.84756      92024084       1037.9627      149            113            48860.909    
    105000   297.49788      92024087       1047.2927      154            118            48860.909    
    110000   300.24031      92024085       1056.947       159            122            48860.909    
    115000   301.0744       92024088       1059.8832      160            127            48860.909    
    120000   303.01616      92024083       1066.7189      165            127            48860.909    
    125000   305.54811      92024070       1075.6322      172            129            48860.909    
    130000   307.44149      92024071       1082.2976      178            132            48860.909    
    135000   308.10304      92024055       1084.6264      180            137            48860.909    
    140000   309.33455      92024053       1088.9617      186            137            48860.909    
    145000   310.88037      92024045       1094.4036      190            140            48860.909    
    150000   313.6359       92024050       1104.104       195            145            48860.909    
    155000   314.37751      92024043       1106.7147      198            146            48860.909    
    160000   316.32688      92024047       1113.5771      203            149            48860.909    
    165000   318.66098      92024047       1121.7939      208            151            48860.909    
    170000   318.75958      92024038       1122.141       209            150            48860.909    
    175000   320.65544      92024033       1128.8151      214            152            48860.909    
    180000   322.4505       92024034       1135.1343      219            154            48860.909    
    185000   323.89399      92024026       1140.2159      223            156            48860.909    
    190000   325.91031      92024026       1147.314       227            161            48860.909    
    195000   326.43588      92024031       1149.1642      230            162            48860.909    
    200000   328.0628       92024037       1154.8915      234            163            48860.909    
Loop time of 65.8311 on 8 procs for 100000 steps with 1317 atoms

Performance: 131.245 ns/day, 0.183 hours/ns, 1519.039 timesteps/s, 2.001 Matom-step/s
88.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.774     | 25.46      | 26.899     |  17.9 | 38.67
Bond    | 0.0038868  | 0.004367   | 0.0048669  |   0.5 |  0.01
Kspace  | 26.622     | 27.773     | 29.19      |  14.6 | 42.19
Neigh   | 0.081016   | 0.08678    | 0.093641   |   1.6 |  0.13
Comm    | 8.6688     | 8.826      | 8.9795     |   3.4 | 13.41
Output  | 0.0005683  | 0.00060895 | 0.00078327 |   0.0 |  0.00
Modify  | 2.5547     | 2.5566     | 2.5587     |   0.1 |  3.88
Other   |            | 1.123      |            |       |  1.71

Nlocal:        164.625 ave         166 max         160 min
Histogram: 1 0 0 0 0 0 1 0 3 3
Nghost:        2858.12 ave        2871 max        2845 min
Histogram: 1 0 0 3 0 1 1 0 1 1
Neighs:        25432.8 ave       26356 max       23980 min
Histogram: 1 0 1 0 0 1 1 2 1 1

Total # of neighbors = 203462
Ave neighs/atom = 154.48899
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 234
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 163
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:02:01
