LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 75.0% H₂ / 25.0% CH₄ at 35 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (36.5584 36.5584 36.5584)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  920 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.005 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.598566 3.976000  # In
pair_coeff 4 4 0.068956 3.261000  # N
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
920 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.939543
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.939543 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 7.3e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22910224
  grid = 18 18 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0026593015
  estimated relative force accuracy = 8.0084075e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 972
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 6 6 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.701 | 6.706 | 6.723 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            92024142       816.3306       0              0              48860.909    
      5000   304.14528      92024137       833.16476      9              12             48860.909    
     10000   307.45133      92024136       842.22125      17             21             48860.909    
     15000   310.99501      92024145       851.92867      27             28             48860.909    
     20000   318.56959      92024146       872.67821      43             31             48860.909    
     25000   324.13918      92024146       887.93533      50             38             48860.909    
     30000   327.1628       92024143       896.21815      55             43             48860.909    
     35000   332.12282      92024150       909.80544      61             49             48860.909    
     40000   334.84463      92024150       917.26148      71             56             48860.909    
     45000   338.29066      92024153       926.7014       76             62             48860.909    
     50000   340.87005      92024147       933.76728      81             69             48860.909    
     55000   344.32133      92024140       943.22161      86             74             48860.909    
     60000   348.73215      92024139       955.30445      91             81             48860.909    
     65000   353.16429      92024132       967.4457       99             86             48860.909    
     70000   356.29478      92024124       976.02126      106            91             48860.909    
     75000   361.31278      92024123       989.76737      119            94             48860.909    
     80000   365.47733      92024112       1001.1756      123            99             48860.909    
     85000   370.79588      92024105       1015.745       130            105            48860.909    
     90000   371.59911      92024090       1017.9454      133            109            48860.909    
     95000   374.29188      92024098       1025.3219      138            113            48860.909    
    100000   379.16633      92024089       1038.6748      149            114            48860.909    
Loop time of 56.5569 on 8 procs for 100000 steps with 1183 atoms

Performance: 152.766 ns/day, 0.157 hours/ns, 1768.129 timesteps/s, 2.092 Matom-step/s
87.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 16.755     | 17.345     | 18.164     |  10.9 | 30.67
Bond    | 0.0036576  | 0.0041625  | 0.0047739  |   0.6 |  0.01
Kspace  | 27.172     | 27.877     | 28.696     |   9.6 | 49.29
Neigh   | 0.057086   | 0.062621   | 0.067175   |   1.3 |  0.11
Comm    | 7.9916     | 8.2624     | 8.5724     |   6.7 | 14.61
Output  | 0.00052281 | 0.00060844 | 0.00085887 |   0.0 |  0.00
Modify  | 1.9398     | 1.9424     | 1.9439     |   0.1 |  3.43
Other   |            | 1.063      |            |       |  1.88

Nlocal:        147.875 ave         152 max         142 min
Histogram: 1 0 0 0 1 2 0 2 0 2
Nghost:         2627.5 ave        2652 max        2612 min
Histogram: 1 1 2 1 0 2 0 0 0 1
Neighs:        20504.4 ave       21465 max       19700 min
Histogram: 1 1 0 3 0 1 0 0 0 2

Total # of neighbors = 164035
Ave neighs/atom = 138.66019
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22913474
  grid = 18 18 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0023438101
  estimated relative force accuracy = 7.0583146e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 972
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.832 | 6.838 | 6.855 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   294.80022      92024089       1038.6748      149            114            48860.909    
    105000   297.39692      92024085       1047.8238      154            118            48860.909    
    110000   300.13702      92024083       1057.478       159            122            48860.909    
    115000   300.97041      92024086       1060.4143      160            127            48860.909    
    120000   302.91053      92024081       1067.25        165            127            48860.909    
    125000   305.94004      92024073       1077.9239      172            130            48860.909    
    130000   307.62274      92024074       1083.8526      177            133            48860.909    
    135000   309.20656      92024063       1089.4329      180            138            48860.909    
    140000   310.16742      92024054       1092.8183      185            139            48860.909    
    145000   311.11009      92024053       1096.1396      189            142            48860.909    
    150000   313.8633       92024057       1105.84        194            147            48860.909    
    155000   314.64806      92024055       1108.605       198            148            48860.909    
    160000   316.33325      92024053       1114.5425      203            150            48860.909    
    165000   318.66537      92024053       1122.7593      208            152            48860.909    
    170000   319.0404       92024055       1124.0806      210            152            48860.909    
    175000   320.93466      92024051       1130.7547      215            154            48860.909    
    180000   322.57707      92024042       1136.5414      220            154            48860.909    
    185000   323.94341      92024040       1141.3555      223            156            48860.909    
    190000   325.95802      92024041       1148.4536      227            161            48860.909    
    195000   326.48315      92024046       1150.3038      230            162            48860.909    
    200000   328.1087       92024051       1156.0311      234            163            48860.909    
Loop time of 65.7412 on 8 procs for 100000 steps with 1317 atoms

Performance: 131.424 ns/day, 0.183 hours/ns, 1521.117 timesteps/s, 2.003 Matom-step/s
88.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.922     | 25.436     | 26.716     |  16.1 | 38.69
Bond    | 0.0036658  | 0.0042249  | 0.0045865  |   0.5 |  0.01
Kspace  | 26.869     | 28.008     | 29.858     |  16.2 | 42.60
Neigh   | 0.079411   | 0.086066   | 0.091056   |   1.3 |  0.13
Comm    | 8.4161     | 8.6493     | 8.8564     |   4.8 | 13.16
Output  | 0.00053063 | 0.00059083 | 0.00077029 |   0.0 |  0.00
Modify  | 2.4057     | 2.408      | 2.4102     |   0.1 |  3.66
Other   |            | 1.149      |            |       |  1.75

Nlocal:        164.625 ave         167 max         160 min
Histogram: 1 0 0 0 1 0 0 3 2 1
Nghost:        2858.88 ave        2870 max        2848 min
Histogram: 2 0 0 1 1 1 0 1 1 1
Neighs:        25428.8 ave       26581 max       23924 min
Histogram: 1 1 0 0 1 0 3 0 1 1

Total # of neighbors = 203430
Ave neighs/atom = 154.46469
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 234
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 163
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:02:02
