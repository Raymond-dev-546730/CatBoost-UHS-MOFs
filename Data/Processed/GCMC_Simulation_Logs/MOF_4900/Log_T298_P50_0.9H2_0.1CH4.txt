LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (36.5584 36.5584 36.5584)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  920 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.005 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.598566 3.976000  # In
pair_coeff 4 4 0.068956 3.261000  # N
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
920 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 7.3e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22910224
  grid = 18 18 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0026593015
  estimated relative force accuracy = 8.0084075e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 972
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 6 6 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.701 | 6.706 | 6.723 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            92024142       816.3306       0              0              48860.909    
      5000   304.14528      92024137       833.16476      9              12             48860.909    
     10000   307.45133      92024136       842.22125      17             21             48860.909    
     15000   310.92892      92024138       851.74763      27             27             48860.909    
     20000   318.50351      92024138       872.49717      43             30             48860.909    
     25000   324.16729      92024144       888.01235      51             37             48860.909    
     30000   327.19092      92024142       896.29516      56             42             48860.909    
     35000   332.15093      92024148       909.88246      62             48             48860.909    
     40000   334.87275      92024148       917.3385       72             55             48860.909    
     45000   338.31877      92024152       926.77842      77             61             48860.909    
     50000   341.56878      92024153       935.68136      82             69             48860.909    
     55000   345.18184      92024152       945.57886      87             75             48860.909    
     60000   349.9113       92024148       958.53458      92             82             48860.909    
     65000   354.34344      92024141       970.67582      100            87             48860.909    
     70000   357.47393      92024133       979.25138      107            92             48860.909    
     75000   361.1594       92024122       989.34721      118            95             48860.909    
     80000   365.47175      92024116       1001.1603      123            100            48860.909    
     85000   370.81441      92024106       1015.7958      130            106            48860.909    
     90000   372.27072      92024097       1019.7852      133            111            48860.909    
     95000   374.9398       92024101       1027.0968      137            115            48860.909    
    100000   379.61124      92024092       1039.8935      147            117            48860.909    
Loop time of 56.3575 on 8 procs for 100000 steps with 1184 atoms

Performance: 153.307 ns/day, 0.157 hours/ns, 1774.386 timesteps/s, 2.101 Matom-step/s
86.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 16.625     | 17.304     | 18.091     |  12.0 | 30.70
Bond    | 0.0037081  | 0.0039673  | 0.004568   |   0.4 |  0.01
Kspace  | 26.2       | 27.369     | 28.419     |  13.2 | 48.56
Neigh   | 0.056483   | 0.062441   | 0.069029   |   1.7 |  0.11
Comm    | 8.1835     | 8.5396     | 8.997      |   9.6 | 15.15
Output  | 0.00052241 | 0.00059415 | 0.00080528 |   0.0 |  0.00
Modify  | 1.9804     | 1.9815     | 1.9829     |   0.1 |  3.52
Other   |            | 1.097      |            |       |  1.95

Nlocal:            148 ave         153 max         142 min
Histogram: 1 0 0 2 0 2 0 1 1 1
Nghost:        2630.62 ave        2659 max        2611 min
Histogram: 1 0 3 1 0 2 0 0 0 1
Neighs:        20533.1 ave       21721 max       19574 min
Histogram: 1 1 1 1 1 1 0 0 0 2

Total # of neighbors = 164265
Ave neighs/atom = 138.73733
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22913474
  grid = 18 18 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0023428201
  estimated relative force accuracy = 7.0553333e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 972
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.832 | 6.838 | 6.855 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   294.89664      92024092       1039.8935      147            117            48860.909    
    105000   297.54248      92024094       1049.2236      152            122            48860.909    
    110000   300.16545      92024080       1058.4729      156            126            48860.909    
    115000   301.0874       92024090       1061.724       158            131            48860.909    
    120000   303.07722      92024092       1068.7407      163            132            48860.909    
    125000   305.75804      92024078       1078.194       170            134            48860.909    
    130000   307.43932      92024080       1084.1227      175            137            48860.909    
    135000   308.70108      92024057       1088.5721      177            142            48860.909    
    140000   309.98184      92024059       1093.0884      183            143            48860.909    
    145000   311.84576      92024063       1099.6612      188            146            48860.909    
    150000   314.59664      92024067       1109.3616      193            151            48860.909    
    155000   315.38074      92024067       1112.1266      197            152            48860.909    
    160000   317.47531      92024060       1119.5127      202            154            48860.909    
    165000   319.67192      92024054       1127.2585      206            156            48860.909    
    170000   320.12455      92024048       1128.8546      208            156            48860.909    
    175000   322.39237      92024044       1136.8517      213            159            48860.909    
    180000   324.36431      92024054       1143.8053      219            161            48860.909    
    185000   325.7295       92024051       1148.6194      222            163            48860.909    
    190000   327.51467      92024048       1154.9144      225            168            48860.909    
    195000   328.03935      92024053       1156.7646      228            169            48860.909    
    200000   329.63338      92024046       1162.3856      230            170            48860.909    
Loop time of 65.9663 on 8 procs for 100000 steps with 1320 atoms

Performance: 130.976 ns/day, 0.183 hours/ns, 1515.925 timesteps/s, 2.001 Matom-step/s
88.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.614     | 25.549     | 27.151     |  21.0 | 38.73
Bond    | 0.0037837  | 0.0041335  | 0.0045693  |   0.4 |  0.01
Kspace  | 25.642     | 27.235     | 29.005     |  18.7 | 41.29
Neigh   | 0.081952   | 0.086318   | 0.094667   |   1.6 |  0.13
Comm    | 8.9981     | 9.426      | 10.044     |  11.0 | 14.29
Output  | 0.00051348 | 0.00058674 | 0.00079117 |   0.0 |  0.00
Modify  | 2.4825     | 2.4849     | 2.4867     |   0.1 |  3.77
Other   |            | 1.181      |            |       |  1.79

Nlocal:            165 ave         170 max         159 min
Histogram: 1 0 0 0 2 2 1 1 0 1
Nghost:        2865.38 ave        2885 max        2849 min
Histogram: 1 1 2 0 0 2 0 0 1 1
Neighs:        25550.1 ave       27145 max       23858 min
Histogram: 1 0 1 1 0 3 0 0 1 1

Total # of neighbors = 204401
Ave neighs/atom = 154.84924
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 230
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 170
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:02:02
