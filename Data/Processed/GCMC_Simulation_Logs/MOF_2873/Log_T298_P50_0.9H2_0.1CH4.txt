LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (21.9524 21.9524 21.9524)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  440 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.005 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.012996 2.594000  # Fe
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.068956 3.261000  # N
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
440 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.25052529
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.001369473
  estimated relative force accuracy = 4.1241272e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 512
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 4 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.551 | 6.56 | 6.566 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            29213466       389.95553      0              0              10579.034    
      5000   304.02435      29213445       397.83885      3              6              10579.034    
     10000   306.09409      29213443       400.54726      4              9              10579.034    
     15000   310.057        29213435       405.73303      9              11             10579.034    
     20000   316.17964      29213444       413.74496      15             12             10579.034    
     25000   325.35608      29213445       425.75303      18             14             10579.034    
     30000   327.47255      29213449       428.52259      20             15             10579.034    
     35000   330.64677      29213449       432.6763       22             16             10579.034    
     40000   332.67489      29213453       435.33024      28             17             10579.034    
     45000   334.60321      29213460       437.8536       30             20             10579.034    
     50000   335.30584      29213446       438.77305      30             20             10579.034    
     55000   334.69088      29213445       437.96832      32             19             10579.034    
     60000   335.05075      29213446       438.43925      33             19             10579.034    
     65000   335.54594      29213445       439.08724      34             19             10579.034    
     70000   336.95952      29213448       440.93701      36             22             10579.034    
     75000   340.41702      29213448       445.46141      39             22             10579.034    
     80000   342.86037      29213447       448.65872      41             22             10579.034    
     85000   346.99372      29213450       454.06752      44             23             10579.034    
     90000   347.42676      29213444       454.63418      43             24             10579.034    
     95000   348.60938      29213451       456.18173      45             24             10579.034    
    100000   351.21371      29213449       459.5897       49             24             10579.034    
Loop time of 47.3176 on 8 procs for 100000 steps with 513 atoms

Performance: 182.596 ns/day, 0.131 hours/ns, 2113.379 timesteps/s, 1.084 Matom-step/s
89.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 15.583     | 16.485     | 17.686     |  15.7 | 34.84
Bond    | 0.0036551  | 0.0041407  | 0.0045334  |   0.5 |  0.01
Kspace  | 16.68      | 18.454     | 19.278     |  18.4 | 39.00
Neigh   | 0.051766   | 0.054533   | 0.058675   |   0.9 |  0.12
Comm    | 8.6863     | 9.4991     | 10.291     |  15.0 | 20.08
Output  | 0.00047615 | 0.00052556 | 0.00069607 |   0.0 |  0.00
Modify  | 1.8131     | 1.815      | 1.8185     |   0.1 |  3.84
Other   |            | 1.006      |            |       |  2.13

Nlocal:         64.125 ave          69 max          60 min
Histogram: 1 1 1 0 1 1 2 0 0 1
Nghost:        2543.38 ave        2563 max        2532 min
Histogram: 2 1 0 2 0 2 0 0 0 1
Neighs:        18013.6 ave       19634 max       16748 min
Histogram: 2 0 0 1 2 0 1 1 0 1

Total # of neighbors = 144109
Ave neighs/atom = 280.91423
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2505157
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0012685757
  estimated relative force accuracy = 3.8202781e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 512
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.681 | 6.691 | 6.697 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   301.13832      29213449       459.5897       49             24             10579.034    
    105000   301.98148      29213450       460.8765       50             24             10579.034    
    110000   304.1119       29213449       464.1279       51             24             10579.034    
    115000   305.05186      29213452       465.56245      53             24             10579.034    
    120000   305.05186      29213452       465.56245      53             24             10579.034    
    125000   305.64598      29213459       466.46917      55             24             10579.034    
    130000   304.109        29213445       464.12348      54             23             10579.034    
    135000   304.9039       29213448       465.33663      55             23             10579.034    
    140000   306.86464      29213445       468.32907      57             23             10579.034    
    145000   308.0936       29213448       470.20468      59             23             10579.034    
    150000   308.50139      29213440       470.82703      58             24             10579.034    
    155000   309.71675      29213443       472.68188      59             26             10579.034    
    160000   309.7612       29213440       472.74972      60             25             10579.034    
    165000   310.62043      29213443       474.06105      62             25             10579.034    
    170000   310.534        29213438       473.92915      61             26             10579.034    
    175000   310.66242      29213437       474.12513      60             27             10579.034    
    180000   311.87698      29213435       475.97876      61             27             10579.034    
    185000   312.66914      29213433       477.18775      62             26             10579.034    
    190000   312.67871      29213439       477.20236      63             26             10579.034    
    195000   312.67871      29213439       477.20236      63             26             10579.034    
    200000   313.94347      29213441       479.1326       66             25             10579.034    
Loop time of 53.3403 on 8 procs for 100000 steps with 531 atoms

Performance: 161.979 ns/day, 0.148 hours/ns, 1874.753 timesteps/s, 995.494 katom-step/s
88.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 18.981     | 20.323     | 22.676     |  24.5 | 38.10
Bond    | 0.0036936  | 0.0044886  | 0.0051753  |   0.7 |  0.01
Kspace  | 17.351     | 19.54      | 20.601     |  25.1 | 36.63
Neigh   | 0.060523   | 0.063675   | 0.0675     |   1.1 |  0.12
Comm    | 10.07      | 10.349     | 10.702     |   6.5 | 19.40
Output  | 0.00055404 | 0.00060388 | 0.0007778  |   0.0 |  0.00
Modify  | 2.0449     | 2.0465     | 2.0478     |   0.1 |  3.84
Other   |            | 1.014      |            |       |  1.90

Nlocal:         66.375 ave          74 max          62 min
Histogram: 2 0 1 2 1 1 0 0 0 1
Nghost:        2650.38 ave        2665 max        2638 min
Histogram: 1 1 1 0 2 1 0 1 0 1
Neighs:          19293 ave       20857 max       18327 min
Histogram: 2 1 0 3 0 0 0 0 1 1

Total # of neighbors = 154344
Ave neighs/atom = 290.66667
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 66
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 25
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:40
