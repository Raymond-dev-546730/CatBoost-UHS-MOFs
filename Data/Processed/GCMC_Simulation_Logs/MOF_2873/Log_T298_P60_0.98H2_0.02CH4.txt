LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (21.9524 21.9524 21.9524)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  440 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.012996 2.594000  # Fe
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.068956 3.261000  # N
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
440 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.25052529
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.001369473
  estimated relative force accuracy = 4.1241272e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 512
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 4 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.551 | 6.56 | 6.566 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            29213466       389.95553      0              0              10579.034    
      5000   304.02435      29213445       397.83885      3              6              10579.034    
     10000   306.09409      29213443       400.54726      4              9              10579.034    
     15000   310.057        29213435       405.73303      9              11             10579.034    
     20000   316.17964      29213444       413.74496      15             12             10579.034    
     25000   325.35608      29213445       425.75303      18             14             10579.034    
     30000   327.47255      29213449       428.52259      20             15             10579.034    
     35000   330.64677      29213449       432.6763       22             16             10579.034    
     40000   332.67489      29213453       435.33024      28             17             10579.034    
     45000   333.50308      29213453       436.41399      30             19             10579.034    
     50000   334.92944      29213452       438.2805       31             20             10579.034    
     55000   334.09943      29213449       437.19437      33             18             10579.034    
     60000   334.11801      29213443       437.21868      33             18             10579.034    
     65000   334.6132       29213442       437.86667      34             18             10579.034    
     70000   336.02678      29213445       439.71645      36             21             10579.034    
     75000   339.48428      29213445       444.24085      39             21             10579.034    
     80000   341.92763      29213444       447.43815      41             21             10579.034    
     85000   346.06098      29213447       452.84696      44             22             10579.034    
     90000   346.85389      29213445       453.88455      44             23             10579.034    
     95000   348.03652      29213453       455.4321       46             23             10579.034    
    100000   349.65527      29213445       457.55036      49             23             10579.034    
Loop time of 46.3814 on 8 procs for 100000 steps with 512 atoms

Performance: 186.282 ns/day, 0.129 hours/ns, 2156.038 timesteps/s, 1.104 Matom-step/s
88.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 15.257     | 16.421     | 17.487     |  17.0 | 35.40
Bond    | 0.0035687  | 0.0040469  | 0.0049794  |   0.7 |  0.01
Kspace  | 16.539     | 17.98      | 19.316     |  17.7 | 38.77
Neigh   | 0.052286   | 0.054936   | 0.058959   |   0.8 |  0.12
Comm    | 8.8617     | 9.0978     | 9.4368     |   6.3 | 19.62
Output  | 0.00048331 | 0.00054709 | 0.00066413 |   0.0 |  0.00
Modify  | 1.8109     | 1.8132     | 1.8176     |   0.2 |  3.91
Other   |            | 1.01       |            |       |  2.18

Nlocal:             64 ave          69 max          60 min
Histogram: 1 1 1 0 2 0 2 0 0 1
Nghost:           2539 ave        2555 max        2528 min
Histogram: 1 1 2 1 0 1 1 0 0 1
Neighs:        17943.4 ave       19565 max       16690 min
Histogram: 2 0 0 2 1 0 1 1 0 1

Total # of neighbors = 143547
Ave neighs/atom = 280.36523
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.25051585
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0012698097
  estimated relative force accuracy = 3.8239943e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 512
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.681 | 6.691 | 6.697 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   300.38877      29213445       457.55036      49             23             10579.034    
    105000   301.23358      29213446       458.83716      50             23             10579.034    
    110000   303.059        29213439       461.61763      50             23             10579.034    
    115000   304.00081      29213442       463.05218      52             23             10579.034    
    120000   302.76999      29213438       461.17741      52             22             10579.034    
    125000   303.88094      29213441       462.8696       55             22             10579.034    
    130000   303.88094      29213441       462.8696       55             22             10579.034    
    135000   304.67739      29213444       464.08275      56             22             10579.034    
    140000   306.64197      29213441       467.07519      58             22             10579.034    
    145000   307.87334      29213444       468.9508       60             22             10579.034    
    150000   308.4275       29213440       469.7949       60             23             10579.034    
    155000   309.64524      29213443       471.64976      61             25             10579.034    
    160000   308.32055      29213433       469.632        60             24             10579.034    
    165000   309.64946      29213436       471.65618      62             24             10579.034    
    170000   309.5079       29213430       471.44056      61             25             10579.034    
    175000   310.07025      29213435       472.29712      61             26             10579.034    
    180000   311.28719      29213433       474.15075      62             26             10579.034    
    185000   312.0809       29213431       475.35974      63             25             10579.034    
    190000   312.09049      29213437       475.37435      64             25             10579.034    
    195000   312.09049      29213437       475.37435      64             25             10579.034    
    200000   313.25009      29213434       477.14064      66             24             10579.034    
Loop time of 53.1099 on 8 procs for 100000 steps with 530 atoms

Performance: 162.682 ns/day, 0.148 hours/ns, 1882.888 timesteps/s, 997.931 katom-step/s
89.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 18.536     | 19.864     | 21.962     |  24.1 | 37.40
Bond    | 0.0036662  | 0.0040211  | 0.0044439  |   0.5 |  0.01
Kspace  | 17.153     | 19.84      | 21.239     |  28.5 | 37.36
Neigh   | 0.059898   | 0.063712   | 0.070432   |   1.4 |  0.12
Comm    | 9.826      | 10.182     | 10.639     |   9.9 | 19.17
Output  | 0.00047629 | 0.00053365 | 0.00065678 |   0.0 |  0.00
Modify  | 2.0825     | 2.0851     | 2.0901     |   0.2 |  3.93
Other   |            | 1.071      |            |       |  2.02

Nlocal:          66.25 ave          74 max          62 min
Histogram: 2 0 1 2 2 0 0 0 0 1
Nghost:         2646.5 ave        2661 max        2630 min
Histogram: 1 1 1 0 0 1 1 1 0 2
Neighs:        19222.8 ave       20453 max       18292 min
Histogram: 2 1 0 1 2 0 0 0 0 2

Total # of neighbors = 153782
Ave neighs/atom = 290.15472
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 66
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 24
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:39
