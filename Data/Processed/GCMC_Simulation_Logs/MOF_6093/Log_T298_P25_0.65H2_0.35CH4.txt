LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 65.0% H₂ / 35.0% CH₄ at 25 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (18.4641 18.4641 37.4193)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  552 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.504631 4.008000  # Al
pair_coeff 2 2 0.104924 3.431000  # C
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.060014 3.118000  # O

# Gas parameters
pair_coeff 5 5 0.072930 2.958000
pair_coeff 6 6 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:4
552 atoms in group framework
group h2 type 5
0 atoms in group h2
group ch4 type 6
0 atoms in group ch4
group gases type 5 6
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[5]
variable n_ch4 equal c_type_counts[6]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.653801
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 1.653801 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 5.3e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2430644
  grid = 12 12 20
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0020633129
  estimated relative force accuracy = 6.2136056e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2964 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.702 | 6.707 | 6.718 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            51081865       489.44305      0              0              12757.1      
      5000   301.81584      51081857       495.71028      4              4              12757.1      
     10000   304.70423      51081854       500.45425      8              8              12757.1      
     15000   305.65845      51081860       502.02149      11             9              12757.1      
     20000   307.96439      51081864       505.80882      16             10             12757.1      
     25000   313.2505       51081852       514.49088      22             11             12757.1      
     30000   318.71288      51081857       523.46244      27             13             12757.1      
     35000   325.05491      51081864       533.87875      32             15             12757.1      
     40000   328.71155      51081850       539.8845       36             18             12757.1      
     45000   329.13701      51081833       540.58329      37             17             12757.1      
     50000   330.54559      51081841       542.89679      38             22             12757.1      
     55000   336.51857      51081836       552.70697      44             26             12757.1      
     60000   337.75767      51081841       554.7421       50             26             12757.1      
     65000   340.8343       51081835       559.79524      54             27             12757.1      
     70000   343.74076      51081843       564.56887      58             30             12757.1      
     75000   344.02227      51081848       565.03123      60             30             12757.1      
     80000   345.19043      51081841       566.94985      62             30             12757.1      
     85000   347.64655      51081839       570.98384      65             31             12757.1      
     90000   350.35805      51081846       575.43729      68             31             12757.1      
     95000   350.10086      51081833       575.01488      68             31             12757.1      
    100000   354.09117      51081844       581.56866      72             31             12757.1      
Loop time of 58.1628 on 8 procs for 100000 steps with 655 atoms

Performance: 148.549 ns/day, 0.162 hours/ns, 1719.311 timesteps/s, 1.126 Matom-step/s
89.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 20.615     | 23.067     | 26.302     |  38.6 | 39.66
Bond    | 0.0040306  | 0.0044865  | 0.0048782  |   0.4 |  0.01
Kspace  | 16.475     | 19.535     | 21.825     |  41.2 | 33.59
Neigh   | 0.081332   | 0.085434   | 0.090881   |   1.2 |  0.15
Comm    | 11.187     | 11.444     | 11.698     |   4.6 | 19.67
Output  | 0.00062777 | 0.00071359 | 0.00096123 |   0.0 |  0.00
Modify  | 2.546      | 2.5467     | 2.548      |   0.0 |  4.38
Other   |            | 1.48       |            |       |  2.54

Nlocal:         81.875 ave          83 max          79 min
Histogram: 1 0 0 0 0 1 0 3 0 3
Nghost:        3207.12 ave        3210 max        3205 min
Histogram: 3 0 1 0 1 0 0 0 1 2
Neighs:          23801 ave       26858 max       21521 min
Histogram: 1 2 0 0 1 2 1 0 0 1

Total # of neighbors = 190408
Ave neighs/atom = 290.69924
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2387821
  grid = 12 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0025433811
  estimated relative force accuracy = 7.6593166e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2470 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.812 | 6.818 | 6.834 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   298.32451      51081844       581.56866      72             31             12757.1      
    105000   297.23038      51081837       579.43569      71             31             12757.1      
    110000   298.97965      51081839       582.84581      72             32             12757.1      
    115000   300.66942      51081838       586.13994      75             32             12757.1      
    120000   301.20793      51081836       587.18973      77             32             12757.1      
    125000   302.97778      51081841       590.63996      79             34             12757.1      
    130000   303.07152      51081840       590.82271      80             34             12757.1      
    135000   304.58744      51081844       593.77792      81             36             12757.1      
    140000   306.49943      51081854       597.50525      84             36             12757.1      
    145000   305.99338      51081855       596.51873      86             35             12757.1      
    150000   306.10732      51081852       596.74085      85             36             12757.1      
    155000   305.7781       51081848       596.09905      84             36             12757.1      
    160000   305.58415      51081843       595.72096      85             35             12757.1      
    165000   306.24169      51081838       597.00279      88             34             12757.1      
    170000   306.86399      51081844       598.21594      89             34             12757.1      
    175000   306.86399      51081844       598.21594      89             34             12757.1      
    180000   307.18859      51081842       598.84873      90             34             12757.1      
    185000   306.39532      51081828       597.30229      88             33             12757.1      
    190000   306.67007      51081833       597.8379       89             33             12757.1      
    195000   306.25812      51081825       597.03481      88             33             12757.1      
    200000   307.44407      51081825       599.34677      89             34             12757.1      
Loop time of 61.2474 on 8 procs for 100000 steps with 675 atoms

Performance: 141.067 ns/day, 0.170 hours/ns, 1632.722 timesteps/s, 1.102 Matom-step/s
90.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 25.153     | 27.779     | 31.1       |  38.2 | 45.36
Bond    | 0.0038385  | 0.00434    | 0.0046738  |   0.5 |  0.01
Kspace  | 14.854     | 17.927     | 20.526     |  47.2 | 29.27
Neigh   | 0.095025   | 0.10023    | 0.10628    |   1.1 |  0.16
Comm    | 10.996     | 11.238     | 11.472     |   5.2 | 18.35
Output  | 0.0006125  | 0.00066823 | 0.00088858 |   0.0 |  0.00
Modify  | 2.7937     | 2.7946     | 2.7959     |   0.0 |  4.56
Other   |            | 1.404      |            |       |  2.29

Nlocal:         84.375 ave          88 max          83 min
Histogram: 2 0 4 0 1 0 0 0 0 1
Nghost:        3313.12 ave        3318 max        3308 min
Histogram: 2 0 0 1 0 1 1 1 0 2
Neighs:        25309.1 ave       27730 max       23476 min
Histogram: 3 0 0 1 1 0 0 1 1 1

Total # of neighbors = 202473
Ave neighs/atom = 299.96
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 89
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 34
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:59
