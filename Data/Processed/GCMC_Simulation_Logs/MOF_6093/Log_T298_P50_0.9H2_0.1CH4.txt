LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 90.0% H₂ / 10.0% CH₄ at 50 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (18.4641 18.4641 37.4193)
  1 by 2 by 4 MPI processor grid
  reading atoms ...
  552 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.005 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.504631 4.008000  # Al
pair_coeff 2 2 0.104924 3.431000  # C
pair_coeff 3 3 0.043997 2.571000  # H
pair_coeff 4 4 0.060014 3.118000  # O

# Gas parameters
pair_coeff 5 5 0.072930 2.958000
pair_coeff 6 6 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:4
552 atoms in group framework
group h2 type 5
0 atoms in group h2
group ch4 type 6
0 atoms in group ch4
group gases type 5 6
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[5]
variable n_ch4 equal c_type_counts[6]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.262132
variable mu_ch4 equal 0.946536

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 5 54321 298 2.262132 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 6 12345 298 0.946536 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 5.3e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2430644
  grid = 12 12 20
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0020633129
  estimated relative force accuracy = 6.2136056e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2964 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.702 | 6.707 | 6.718 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            51081865       489.44305      0              0              12757.1      
      5000   301.81584      51081857       495.71028      4              4              12757.1      
     10000   304.70423      51081854       500.45425      8              8              12757.1      
     15000   305.65845      51081860       502.02149      11             9              12757.1      
     20000   307.96439      51081864       505.80882      16             10             12757.1      
     25000   313.2505       51081852       514.49088      22             11             12757.1      
     30000   318.71288      51081857       523.46244      27             13             12757.1      
     35000   325.05491      51081864       533.87875      32             15             12757.1      
     40000   328.71155      51081850       539.8845       36             18             12757.1      
     45000   329.13701      51081833       540.58329      37             17             12757.1      
     50000   330.91366      51081846       543.50131      39             22             12757.1      
     55000   336.88664      51081841       553.31149      45             26             12757.1      
     60000   338.43044      51081856       555.84706      51             27             12757.1      
     65000   342.04332      51081856       561.78095      56             28             12757.1      
     70000   344.94977      51081865       566.55459      60             31             12757.1      
     75000   344.9373       51081870       566.53411      62             31             12757.1      
     80000   345.83723      51081858       568.01217      62             32             12757.1      
     85000   347.4008       51081851       570.58023      65             33             12757.1      
     90000   350.11231      51081858       575.03368      68             33             12757.1      
     95000   349.15516      51081841       573.46163      67             33             12757.1      
    100000   352.7774       51081847       579.41089      70             33             12757.1      
Loop time of 56.0812 on 8 procs for 100000 steps with 655 atoms

Performance: 154.062 ns/day, 0.156 hours/ns, 1783.129 timesteps/s, 1.168 Matom-step/s
88.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 20.075     | 22.574     | 25.579     |  36.9 | 40.25
Bond    | 0.0039484  | 0.0044808  | 0.0050249  |   0.6 |  0.01
Kspace  | 15.864     | 18.712     | 20.935     |  40.6 | 33.37
Neigh   | 0.082209   | 0.085382   | 0.091211   |   1.1 |  0.15
Comm    | 10.693     | 10.975     | 11.22      |   5.1 | 19.57
Output  | 0.00065741 | 0.0007114  | 0.0009605  |   0.0 |  0.00
Modify  | 2.348      | 2.3489     | 2.3499     |   0.0 |  4.19
Other   |            | 1.381      |            |       |  2.46

Nlocal:         81.875 ave          85 max          78 min
Histogram: 1 0 0 0 2 3 0 0 1 1
Nghost:        3205.62 ave        3207 max        3200 min
Histogram: 1 0 0 0 0 1 0 0 1 5
Neighs:        23797.5 ave       26532 max       21177 min
Histogram: 1 1 1 0 0 3 0 0 1 1

Total # of neighbors = 190380
Ave neighs/atom = 290.65649
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2387821
  grid = 12 12 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0025433811
  estimated relative force accuracy = 7.6593166e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2470 432
Generated 15 of 15 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.812 | 6.818 | 6.834 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   297.21765      51081847       579.41089      70             33             12757.1      
    105000   297.10456      51081836       579.19042      69             33             12757.1      
    110000   298.82078      51081835       582.5361       69             34             12757.1      
    115000   300.51055      51081834       585.83022      72             34             12757.1      
    120000   301.04905      51081836       586.88001      74             34             12757.1      
    125000   304.19245      51081846       593.0079       77             36             12757.1      
    130000   304.20706      51081840       593.03639      77             36             12757.1      
    135000   305.51576      51081840       595.58763      78             37             12757.1      
    140000   307.42775      51081849       599.31496      81             37             12757.1      
    145000   307.07548      51081854       598.62823      83             37             12757.1      
    150000   307.18942      51081851       598.85035      82             38             12757.1      
    155000   307.18942      51081851       598.85035      82             38             12757.1      
    160000   307.54301      51081849       599.53966      83             38             12757.1      
    165000   308.20055      51081845       600.82149      86             37             12757.1      
    170000   308.82285      51081850       602.03464      87             37             12757.1      
    175000   308.82285      51081850       602.03464      87             37             12757.1      
    180000   309.64234      51081848       603.63219      89             37             12757.1      
    185000   309.02004      51081843       602.41904      88             37             12757.1      
    190000   309.29479      51081848       602.95465      89             37             12757.1      
    195000   309.29479      51081848       602.95465      89             37             12757.1      
    200000   309.45816      51081848       603.27314      90             37             12757.1      
Loop time of 60.6486 on 8 procs for 100000 steps with 679 atoms

Performance: 142.460 ns/day, 0.168 hours/ns, 1648.842 timesteps/s, 1.120 Matom-step/s
90.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 24.767     | 27.591     | 30.54      |  37.2 | 45.49
Bond    | 0.0042414  | 0.0046442  | 0.0052776  |   0.5 |  0.01
Kspace  | 14.223     | 17.507     | 20.556     |  48.7 | 28.87
Neigh   | 0.095177   | 0.09994    | 0.10807    |   1.2 |  0.16
Comm    | 11.023     | 11.324     | 11.54      |   5.7 | 18.67
Output  | 0.00056673 | 0.00063399 | 0.00080055 |   0.0 |  0.00
Modify  | 2.5766     | 2.5781     | 2.5799     |   0.1 |  4.25
Other   |            | 1.543      |            |       |  2.54

Nlocal:         84.875 ave          88 max          83 min
Histogram: 3 0 1 0 1 0 1 0 1 1
Nghost:        3329.12 ave        3334 max        3323 min
Histogram: 2 0 1 0 0 1 0 0 2 2
Neighs:        25613.5 ave       27881 max       23409 min
Histogram: 2 1 0 0 0 2 0 1 0 2

Total # of neighbors = 204908
Ave neighs/atom = 301.77909
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 90
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 37
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:56
