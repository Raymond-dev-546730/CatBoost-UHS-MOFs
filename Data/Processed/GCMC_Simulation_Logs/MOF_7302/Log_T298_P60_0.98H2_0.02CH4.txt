LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 98.0% H₂ / 2.0% CH₄ at 60 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (36.2108 36.2108 36.2108)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  992 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.005 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.598566 3.976000  # In
pair_coeff 4 4 0.068956 3.261000  # N
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
992 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 2.423137
variable mu_ch4 equal 0.106391

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 2.423137 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 0.106391 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -4.2e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22976565
  grid = 18 18 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0028096311
  estimated relative force accuracy = 8.4611206e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 972
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 6 6 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.719 | 6.724 | 6.741 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            96589147       880.28686      0              0              47480.399    
      5000   303.40734      96589150       896.26006      10             10             47480.399    
     10000   305.90395      96589151       903.63499      16             17             47480.399    
     15000   308.62772      96589143       911.68095      25             25             47480.399    
     20000   315.13999      96589135       930.9181       39             28             47480.399    
     25000   320.3614       96589138       946.34205      45             35             47480.399    
     30000   322.71876      96589124       953.30567      47             40             47480.399    
     35000   327.18834      96589133       966.50873      53             46             47480.399    
     40000   330.23964      96589142       975.52222      63             55             47480.399    
     45000   332.26195      96589138       981.49607      68             59             47480.399    
     50000   335.20857      96589132       990.20034      73             65             47480.399    
     55000   338.99982      96589132       1001.3996      76             72             47480.399    
     60000   343.93261      96589138       1015.971       83             80             47480.399    
     65000   347.30887      96589124       1025.9444      88             86             47480.399    
     70000   349.9598       96589107       1033.7752      95             92             47480.399    
     75000   354.7229       96589116       1047.8453      106            96             47480.399    
     80000   356.9596       96589105       1054.4525      109            100            47480.399    
     85000   361.69906      96589103       1068.4528      116            105            47480.399    
     90000   363.20239      96589092       1072.8936      119            111            47480.399    
     95000   365.24258      96589092       1078.9203      124            115            47480.399    
    100000   368.91244      96589082       1089.761       133            116            47480.399    
Loop time of 59.8161 on 8 procs for 100000 steps with 1241 atoms

Performance: 144.443 ns/day, 0.166 hours/ns, 1671.791 timesteps/s, 2.075 Matom-step/s
87.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 19.047     | 19.981     | 20.917     |  12.8 | 33.40
Bond    | 0.0036265  | 0.0039229  | 0.0041468  |   0.2 |  0.01
Kspace  | 27.226     | 27.783     | 28.718     |   8.4 | 46.45
Neigh   | 0.064891   | 0.070987   | 0.076533   |   1.6 |  0.12
Comm    | 8.3472     | 8.698      | 8.9964     |   7.3 | 14.54
Output  | 0.00055693 | 0.00059626 | 0.00076493 |   0.0 |  0.00
Modify  | 2.2263     | 2.2285     | 2.2317     |   0.1 |  3.73
Other   |            | 1.05       |            |       |  1.76

Nlocal:        155.125 ave         159 max         150 min
Histogram: 1 1 0 0 0 1 2 2 0 1
Nghost:        2837.38 ave        2864 max        2818 min
Histogram: 1 1 1 1 1 1 1 0 0 1
Neighs:        23043.1 ave       23835 max       21641 min
Histogram: 1 0 1 0 0 2 0 0 1 3

Total # of neighbors = 184345
Ave neighs/atom = 148.54553
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.22973818
  grid = 18 18 18
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0025132222
  estimated relative force accuracy = 7.5684939e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 972
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.85 | 6.855 | 6.872 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   294.83244      96589082       1089.761       133            116            47480.399    
    105000   296.6584       96589086       1096.5101      137            119            47480.399    
    110000   298.6736       96589080       1103.9587      142            122            47480.399    
    115000   300.36543      96589075       1110.2121      143            127            47480.399    
    120000   303.31941      96589077       1121.1306      149            128            47480.399    
    125000   306.55133      96589078       1133.0764      156            131            47480.399    
    130000   308.15533      96589081       1139.0051      161            134            47480.399    
    135000   310.20325      96589078       1146.5746      166            139            47480.399    
    140000   311.35133      96589073       1150.8182      170            140            47480.399    
    145000   313.30913      96589077       1158.0546      175            142            47480.399    
    150000   315.24704      96589075       1165.2175      179            145            47480.399    
    155000   315.96582      96589073       1167.8743      182            146            47480.399    
    160000   318.73822      96589082       1178.1216      187            151            47480.399    
    165000   321.2434       96589092       1187.3813      192            153            47480.399    
    170000   321.64043      96589092       1188.8488      194            154            47480.399    
    175000   322.76291      96589086       1192.9977      198            155            47480.399    
    180000   323.75998      96589071       1196.6831      203            156            47480.399    
    185000   325.11935      96589077       1201.7076      208            157            47480.399    
    190000   325.69027      96589077       1203.8178      211            160            47480.399    
    195000   326.20453      96589087       1205.7186      215            160            47480.399    
    200000   327.20641      96589087       1209.4218      217            161            47480.399    
Loop time of 72.8742 on 8 procs for 100000 steps with 1370 atoms

Performance: 118.560 ns/day, 0.202 hours/ns, 1372.227 timesteps/s, 1.880 Matom-step/s
89.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 25.803     | 28.36      | 29.398     |  19.2 | 38.92
Bond    | 0.0036073  | 0.0043078  | 0.0051887  |   0.8 |  0.01
Kspace  | 29.686     | 30.812     | 33.431     |  20.6 | 42.28
Neigh   | 0.089745   | 0.095284   | 0.10147    |   1.4 |  0.13
Comm    | 8.9836     | 9.592      | 10.373     |  13.7 | 13.16
Output  | 0.0004789  | 0.00052038 | 0.00062055 |   0.0 |  0.00
Modify  | 2.7898     | 2.7928     | 2.7961     |   0.1 |  3.83
Other   |            | 1.217      |            |       |  1.67

Nlocal:         171.25 ave         175 max         164 min
Histogram: 1 0 1 0 0 0 1 2 0 3
Nghost:         3059.5 ave        3088 max        3036 min
Histogram: 1 1 1 1 1 0 1 1 0 1
Neighs:        28173.5 ave       29340 max       26300 min
Histogram: 1 0 0 1 1 1 0 0 2 2

Total # of neighbors = 225388
Ave neighs/atom = 164.51679
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 217
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 161
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:02:12
