LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 65.0% H₂ / 35.0% CH₄ at 25 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (19.519 19.519 49.1068)
  2 by 1 by 4 MPI processor grid
  reading atoms ...
  436 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.598566 3.976000  # In
pair_coeff 4 4 0.068956 3.261000  # N
pair_coeff 5 5 0.060014 3.118000  # O

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
436 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.653801
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.653801 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23873279
  grid = 12 12 24
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0019938187
  estimated relative force accuracy = 6.0043257e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2717 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 8
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.647 | 6.647 | 6.648 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            49257111       386.40241      0              0              18709.267    
      5000   307.50778      49257107       398.73069      9              5              18709.267    
     10000   316.58557      49257095       410.50143      18             12             18709.267    
     15000   318.28386      49257089       412.70353      21             15             18709.267    
     20000   332.19825      49257085       430.74564      32             23             18709.267    
     25000   338.33848      49257094       438.70739      38             27             18709.267    
     30000   344.63166      49257102       446.86745      44             30             18709.267    
     35000   354.11679      49257110       459.16637      50             31             18709.267    
     40000   360.593        49257099       467.56377      58             34             18709.267    
     45000   364.32412      49257104       472.40174      61             37             18709.267    
     50000   367.01681      49257101       475.89322      63             40             18709.267    
     55000   371.97034      49257095       482.31623      68             44             18709.267    
     60000   374.73911      49257101       485.90635      70             47             18709.267    
     65000   380.05065      49257100       492.79357      75             49             18709.267    
     70000   387.05744      49257098       501.87895      80             54             18709.267    
     75000   390.03801      49257095       505.74371      85             54             18709.267    
     80000   393.02079      49257100       509.61133      88             56             18709.267    
     85000   398.14735      49257097       516.25871      92             60             18709.267    
     90000   401.75995      49257096       520.943        94             60             18709.267    
     95000   401.78959      49257089       520.98143      95             62             18709.267    
    100000   406.14727      49257083       526.63182      102            65             18709.267    
Loop time of 39.0213 on 8 procs for 100000 steps with 603 atoms

Performance: 221.418 ns/day, 0.108 hours/ns, 2562.705 timesteps/s, 1.545 Matom-step/s
91.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.9333     | 10.601     | 13.176     |  45.2 | 27.17
Bond    | 0.0039513  | 0.004096   | 0.0045927  |   0.3 |  0.01
Kspace  | 15.955     | 18.452     | 21.109     |  32.4 | 47.29
Neigh   | 0.039588   | 0.048299   | 0.054464   |   2.4 |  0.12
Comm    | 6.6652     | 6.8873     | 7.1975     |   6.8 | 17.65
Output  | 0.00059399 | 0.00065807 | 0.00087468 |   0.0 |  0.00
Modify  | 2.0968     | 2.1023     | 2.107      |   0.2 |  5.39
Other   |            | 0.9252     |            |       |  2.37

Nlocal:         75.375 ave          86 max          65 min
Histogram: 2 0 0 2 0 1 1 0 0 2
Nghost:        2266.25 ave        2293 max        2239 min
Histogram: 1 0 0 2 1 2 0 1 0 1
Neighs:        13649.8 ave       15823 max       11426 min
Histogram: 1 1 0 1 0 2 1 0 1 1

Total # of neighbors = 109198
Ave neighs/atom = 181.09121
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23873057
  grid = 12 12 24
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0016954668
  estimated relative force accuracy = 5.105848e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2717 432
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.779 | 6.78 | 6.781 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   293.47851      49257083       526.63182      102            65             18709.267    
    105000   295.49584      49257092       530.25182      104            67             18709.267    
    110000   294.7821       49257080       528.97104      105            69             18709.267    
    115000   295.02147      49257080       529.40058      105            70             18709.267    
    120000   294.16244      49257074       527.85909      104            71             18709.267    
    125000   298.4366       49257067       535.52885      107            73             18709.267    
    130000   301.36194      49257077       540.77822      112            75             18709.267    
    135000   303.47624      49257057       544.57223      113            77             18709.267    
    140000   304.73256      49257061       546.82663      116            77             18709.267    
    145000   305.25319      49257061       547.76087      117            77             18709.267    
    150000   305.55458      49257063       548.3017       117            78             18709.267    
    155000   305.87605      49257068       548.87856      118            78             18709.267    
    160000   307.90268      49257067       552.51524      120            80             18709.267    
    165000   309.67145      49257060       555.68921      123            79             18709.267    
    170000   310.32485      49257060       556.8617       124            79             18709.267    
    175000   312.40109      49257053       560.5874       127            79             18709.267    
    180000   314.04381      49257067       563.53518      130            80             18709.267    
    185000   314.04381      49257067       563.53518      130            80             18709.267    
    190000   315.02001      49257064       565.28692      132            81             18709.267    
    195000   315.88115      49257060       566.83218      135            80             18709.267    
    200000   317.36448      49257052       569.49394      137            80             18709.267    
Loop time of 44.7735 on 8 procs for 100000 steps with 653 atoms

Performance: 192.971 ns/day, 0.124 hours/ns, 2233.466 timesteps/s, 1.458 Matom-step/s
92.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 12.864     | 15.833     | 18.23      |  42.5 | 35.36
Bond    | 0.0039163  | 0.0042178  | 0.0048651  |   0.5 |  0.01
Kspace  | 16.044     | 18.319     | 21.251     |  37.3 | 40.91
Neigh   | 0.055028   | 0.064771   | 0.071635   |   2.3 |  0.14
Comm    | 6.7293     | 6.9076     | 7.0457     |   4.6 | 15.43
Output  | 0.00063521 | 0.00067953 | 0.00094226 |   0.0 |  0.00
Modify  | 2.7424     | 2.7475     | 2.7534     |   0.2 |  6.14
Other   |            | 0.8968     |            |       |  2.00

Nlocal:         81.625 ave          91 max          70 min
Histogram: 1 1 0 1 1 1 0 0 1 2
Nghost:           2437 ave        2466 max        2404 min
Histogram: 1 1 1 0 0 0 2 1 1 1
Neighs:        16094.9 ave       17808 max       13938 min
Histogram: 2 0 0 0 0 3 0 0 1 2

Total # of neighbors = 128759
Ave neighs/atom = 197.1807
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 137
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 80
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:23
