LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 65.0% H₂ / 35.0% CH₄ at 25 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (19.6175 19.741 32.326)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  672 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
672 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.653801
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.653801 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = 3.7e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23778982
  grid = 12 12 16
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0024100579
  estimated relative force accuracy = 7.2578177e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 288
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 3 3 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.728 | 6.73 | 6.732 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            3.474509e+17   596.03682      0              0              12518.86     
      5000   301.75316      3.474509e+17   603.54361      6              6              12518.86     
     10000   305.07293      3.474509e+17   610.18354      12             8              12518.86     
     15000   306.63848      3.474509e+17   613.31485      16             8              12518.86     
     20000   309.08132      3.474509e+17   618.20083      20             10             12518.86     
     25000   310.46444      3.474509e+17   620.96723      24             11             12518.86     
     30000   311.83221      3.474509e+17   623.70295      27             12             12518.86     
     35000   313.21988      3.474509e+17   626.47846      30             13             12518.86     
     40000   315.2471       3.474509e+17   630.53314      34             16             12518.86     
     45000   315.5643       3.474509e+17   631.16758      35             16             12518.86     
     50000   318.19206      3.474509e+17   636.42344      36             20             12518.86     
     55000   320.01516      3.474509e+17   640.06986      39             22             12518.86     
     60000   321.89633      3.474509e+17   643.83242      40             23             12518.86     
     65000   322.6426       3.474509e+17   645.32506      43             23             12518.86     
     70000   323.10921      3.474509e+17   646.25835      46             23             12518.86     
     75000   324.38909      3.474509e+17   648.81826      49             24             12518.86     
     80000   328.33356      3.474509e+17   656.70768      53             24             12518.86     
     85000   329.82189      3.474509e+17   659.68452      54             24             12518.86     
     90000   329.99038      3.474509e+17   660.02154      56             24             12518.86     
     95000   329.99038      3.474509e+17   660.02154      56             24             12518.86     
    100000   331.07632      3.474509e+17   662.19354      59             24             12518.86     
Loop time of 72.1141 on 8 procs for 100000 steps with 755 atoms

Performance: 119.810 ns/day, 0.200 hours/ns, 1386.691 timesteps/s, 1.047 Matom-step/s
92.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 25.431     | 34.822     | 43.52      | 118.0 | 48.29
Bond    | 0.0039663  | 0.0043102  | 0.0048095  |   0.5 |  0.01
Kspace  | 14.252     | 22.544     | 31.631     | 139.8 | 31.26
Neigh   | 0.099526   | 0.1221     | 0.14687    |   5.8 |  0.17
Comm    | 9.5606     | 10.043     | 10.518     |  10.1 | 13.93
Output  | 0.00058887 | 0.00065333 | 0.00085824 |   0.0 |  0.00
Modify  | 3.2792     | 3.2846     | 3.2919     |   0.3 |  4.55
Other   |            | 1.294      |            |       |  1.79

Nlocal:         94.375 ave         113 max          77 min
Histogram: 4 0 0 0 0 0 0 0 1 3
Nghost:        3739.12 ave        3767 max        3705 min
Histogram: 1 0 1 1 0 1 2 0 0 2
Neighs:        33123.9 ave       40936 max       24861 min
Histogram: 2 0 2 0 0 0 0 1 1 2

Total # of neighbors = 264991
Ave neighs/atom = 350.98146
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23778974
  grid = 12 12 16
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0022737325
  estimated relative force accuracy = 6.847278e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2197 288
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.858 | 6.861 | 6.863 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   294.63158      3.474509e+17   662.19354      59             24             12518.86     
    105000   295.07171      3.474509e+17   663.18276      60             25             12518.86     
    110000   295.7287       3.474509e+17   664.65936      62             25             12518.86     
    115000   296.92008      3.474509e+17   667.33702      63             25             12518.86     
    120000   297.49733      3.474509e+17   668.6344       64             26             12518.86     
    125000   300.81384      3.474509e+17   676.08837      65             29             12518.86     
    130000   300.81384      3.474509e+17   676.08837      65             29             12518.86     
    135000   300.81384      3.474509e+17   676.08837      65             29             12518.86     
    140000   301.11861      3.474509e+17   676.77334      66             29             12518.86     
    145000   301.80396      3.474509e+17   678.3137       67             30             12518.86     
    150000   303.49895      3.474509e+17   682.12323      68             31             12518.86     
    155000   303.49895      3.474509e+17   682.12323      68             31             12518.86     
    160000   303.55569      3.474509e+17   682.25076      69             31             12518.86     
    165000   304.38043      3.474509e+17   684.10439      70             31             12518.86     
    170000   304.57309      3.474509e+17   684.53739      71             31             12518.86     
    175000   305.05426      3.474509e+17   685.61883      72             32             12518.86     
    180000   306.66062      3.474509e+17   689.22918      75             33             12518.86     
    185000   306.66062      3.474509e+17   689.22918      75             33             12518.86     
    190000   307.38672      3.474509e+17   690.86111      77             33             12518.86     
    195000   307.7222       3.474509e+17   691.61511      78             34             12518.86     
    200000   308.54694      3.474509e+17   693.46874      79             34             12518.86     
Loop time of 81.5637 on 8 procs for 100000 steps with 785 atoms

Performance: 105.930 ns/day, 0.227 hours/ns, 1226.036 timesteps/s, 962.438 katom-step/s
92.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 28.822     | 39.788     | 49.14      | 121.6 | 48.78
Bond    | 0.0040161  | 0.0046253  | 0.0055509  |   0.6 |  0.01
Kspace  | 15.218     | 24.778     | 36.194     | 156.3 | 30.38
Neigh   | 0.10994    | 0.13795    | 0.16475    |   6.5 |  0.17
Comm    | 11.334     | 11.713     | 12.32      |   8.9 | 14.36
Output  | 0.00056546 | 0.00060415 | 0.00075018 |   0.0 |  0.00
Modify  | 3.6813     | 3.6878     | 3.695      |   0.3 |  4.52
Other   |            | 1.453      |            |       |  1.78

Nlocal:         98.125 ave         116 max          78 min
Histogram: 3 1 0 0 0 0 0 0 0 4
Nghost:        3895.75 ave        3915 max        3877 min
Histogram: 3 1 0 0 0 0 0 1 0 3
Neighs:        35740.4 ave       44112 max       26067 min
Histogram: 2 0 0 2 0 0 0 1 1 2

Total # of neighbors = 285923
Ave neighs/atom = 364.23312
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 79
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 34
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:02:33
