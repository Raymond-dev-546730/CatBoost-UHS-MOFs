LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 65.0% H₂ / 35.0% CH₄ at 25 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (27.26 27.26 27.26)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  428 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
428 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.653801
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.653801 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -4.1e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23661756
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0018256076
  estimated relative force accuracy = 5.497763e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 512
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 4 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.518 | 6.527 | 6.533 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            11288535       379.29616      0              0              20257.113    
      5000   307.40043      11288537       391.26108      7              8              20257.113    
     10000   312.8883       11288519       398.24607      17             11             20257.113    
     15000   319.50135      11288512       406.6632       26             18             20257.113    
     20000   329.51669      11288522       419.41079      33             23             20257.113    
     25000   341.61372      11288514       434.80796      39             27             20257.113    
     30000   341.81706      11288506       435.06677      42             28             20257.113    
     35000   350.08707      11288506       445.59288      47             33             20257.113    
     40000   357.90405      11288506       455.54238      56             38             20257.113    
     45000   362.0844       11288509       460.86316      61             40             20257.113    
     50000   368.2218       11288508       468.67488      66             43             20257.113    
     55000   371.77165      11288499       473.19315      68             46             20257.113    
     60000   377.9644       11288511       481.07532      75             48             20257.113    
     65000   381.53119      11288514       485.61515      82             49             20257.113    
     70000   388.40358      11288514       494.36236      86             54             20257.113    
     75000   396.59305      11288511       504.78597      90             59             20257.113    
     80000   404.94909      11288514       515.42159      94             63             20257.113    
     85000   408.60375      11288523       520.07326      98             64             20257.113    
     90000   409.57368      11288503       521.3078       99             66             20257.113    
     95000   411.37004      11288497       523.59421      101            68             20257.113    
    100000   419.344        11288496       533.74351      109            69             20257.113    
Loop time of 35.7025 on 8 procs for 100000 steps with 606 atoms

Performance: 242.000 ns/day, 0.099 hours/ns, 2800.923 timesteps/s, 1.697 Matom-step/s
88.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.8627     | 9.2888     | 11.761     |  44.2 | 26.02
Bond    | 0.0034542  | 0.0037094  | 0.0041664  |   0.3 |  0.01
Kspace  | 15.576     | 18.049     | 19.338     |  29.4 | 50.55
Neigh   | 0.039872   | 0.045683   | 0.050327   |   1.5 |  0.13
Comm    | 5.9822     | 6.2562     | 6.4748     |   6.5 | 17.52
Output  | 0.00047202 | 0.00055006 | 0.0009108  |   0.0 |  0.00
Modify  | 1.3899     | 1.3913     | 1.3947     |   0.1 |  3.90
Other   |            | 0.6671     |            |       |  1.87

Nlocal:          75.75 ave          82 max          67 min
Histogram: 1 0 0 0 1 2 1 1 1 1
Nghost:        2069.75 ave        2128 max        2016 min
Histogram: 1 1 0 1 1 2 0 0 1 1
Neighs:        12739.8 ave       14503 max       11446 min
Histogram: 3 1 0 0 0 1 1 0 0 2

Total # of neighbors = 101918
Ave neighs/atom = 168.18152
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23661321
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0015343684
  estimated relative force accuracy = 4.6207049e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 512
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.65 | 6.66 | 6.666 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   295.96675      11288496       533.74351      109            69             20257.113    
    105000   297.95042      11288498       537.32082      111            71             20257.113    
    110000   302.01895      11288499       544.65797      116            71             20257.113    
    115000   300.94309      11288488       542.71778      115            70             20257.113    
    120000   304.13044      11288500       548.46582      118            72             20257.113    
    125000   305.5518       11288494       551.02908      120            71             20257.113    
    130000   304.34598      11288490       548.85452      118            72             20257.113    
    135000   304.7876       11288494       549.65093      118            74             20257.113    
    140000   305.76839      11288495       551.41967      120            75             20257.113    
    145000   307.92122      11288497       555.30208      121            78             20257.113    
    150000   309.44317      11288499       558.04674      123            79             20257.113    
    155000   309.26586      11288494       557.72698      123            78             20257.113    
    160000   310.72624      11288495       560.36062      125            80             20257.113    
    165000   313.10391      11288496       564.64849      128            80             20257.113    
    170000   313.10391      11288496       564.64849      128            80             20257.113    
    175000   314.11988      11288488       566.48067      131            79             20257.113    
    180000   315.43373      11288483       568.85006      133            79             20257.113    
    185000   315.43373      11288483       568.85006      133            79             20257.113    
    190000   315.48085      11288483       568.93504      134            80             20257.113    
    195000   316.3718       11288489       570.54177      133            82             20257.113    
    200000   318.24125      11288491       573.91311      137            82             20257.113    
Loop time of 44.8899 on 8 procs for 100000 steps with 647 atoms

Performance: 192.471 ns/day, 0.125 hours/ns, 2227.672 timesteps/s, 1.441 Matom-step/s
88.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.634     | 13.859     | 16.694     |  44.1 | 30.87
Bond    | 0.0036899  | 0.0039048  | 0.0043458  |   0.3 |  0.01
Kspace  | 17.232     | 19.637     | 21.88      |  36.9 | 43.75
Neigh   | 0.058912   | 0.063294   | 0.067124   |   0.9 |  0.14
Comm    | 8.1757     | 8.4823     | 8.6603     |   5.6 | 18.90
Output  | 0.00048397 | 0.00053932 | 0.00065926 |   0.0 |  0.00
Modify  | 1.8034     | 1.8056     | 1.8071     |   0.1 |  4.02
Other   |            | 1.038      |            |       |  2.31

Nlocal:         80.875 ave          84 max          77 min
Histogram: 1 2 0 0 0 1 0 1 1 2
Nghost:        2215.38 ave        2247 max        2184 min
Histogram: 1 1 1 0 2 0 1 0 0 2
Neighs:        14567.2 ave       16571 max       12907 min
Histogram: 2 0 1 1 1 0 1 0 1 1

Total # of neighbors = 116538
Ave neighs/atom = 180.12056
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 137
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 82
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:20
