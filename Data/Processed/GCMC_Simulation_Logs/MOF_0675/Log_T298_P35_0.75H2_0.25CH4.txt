LAMMPS (7 Feb 2024 - Update 1)
  using 1 OpenMP thread(s) per MPI task
# GCMC: 75.0% H₂ / 25.0% CH₄ at 35 bar, 298 K
units real
atom_style full
boundary p p p

read_data "structure.data"
Reading data file ...
  orthogonal box = (0 0 0) to (27.26 27.26 27.26)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  428 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

timestep 1.0

pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-5
pair_coeff 1 1 0.104924 3.431000  # C
pair_coeff 2 2 0.043997 2.571000  # H
pair_coeff 3 3 0.068956 3.261000  # N
pair_coeff 4 4 0.060014 3.118000  # O
pair_coeff 5 5 0.123962 2.462000  # Zn

# Gas parameters
pair_coeff 6 6 0.072930 2.958000
pair_coeff 7 7 0.294106 3.730000

pair_modify mix geometric tail yes

# Groups
group framework type 1:5
428 atoms in group framework
group h2 type 6
0 atoms in group h2
group ch4 type 7
0 atoms in group ch4
group gases type 6 7
0 atoms in group gases

# Freeze framework
fix freeze framework setforce 0.0 0.0 0.0

# Counting
compute type_counts all count/type atom
variable n_h2 equal c_type_counts[6]
variable n_ch4 equal c_type_counts[7]

# Temperature monitoring
compute temp_gases gases temp
compute_modify temp_gases dynamic yes

# Chemical potentials
variable mu_h2 equal 1.939543
variable mu_ch4 equal 1.273053

# Initialize framework at target temperature
velocity framework create 298 98765 dist gaussian
velocity framework scale 298

# GCMC
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 ${mu_h2} 0.2
fix gcmc_h2 gases gcmc 1000 5 0 6 54321 298 1.939543 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 ${mu_ch4} 0.2
fix gcmc_ch4 gases gcmc 1000 5 0 7 12345 298 1.273053 0.2

print "[INFO] Equilibration Phase"
[INFO] Equilibration Phase
thermo_style custom step temp pe ke v_n_h2 v_n_ch4 vol
thermo 5000
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
WARNING: System is not charge neutral, net charge = -4.1e-05 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.23661756
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0018256076
  estimated relative force accuracy = 5.497763e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 512
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_h2
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:539)
0 atoms in group FixGCMC:gcmc_exclusion_group:gcmc_ch4
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 4 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.518 | 6.527 | 6.533 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
         0   298            11288535       379.29616      0              0              20257.113    
      5000   307.40043      11288537       391.26108      7              8              20257.113    
     10000   312.8883       11288519       398.24607      17             11             20257.113    
     15000   319.50135      11288512       406.6632       26             18             20257.113    
     20000   329.51669      11288522       419.41079      33             23             20257.113    
     25000   341.61372      11288514       434.80796      39             27             20257.113    
     30000   341.81706      11288506       435.06677      42             28             20257.113    
     35000   350.08707      11288506       445.59288      47             33             20257.113    
     40000   357.90405      11288506       455.54238      56             38             20257.113    
     45000   362.97293      11288516       461.99408      62             40             20257.113    
     50000   369.11033      11288515       469.8058       67             43             20257.113    
     55000   371.77165      11288499       473.19315      68             46             20257.113    
     60000   377.9644       11288511       481.07532      75             48             20257.113    
     65000   381.53119      11288514       485.61515      82             49             20257.113    
     70000   388.40358      11288514       494.36236      86             54             20257.113    
     75000   397.09729      11288516       505.42777      91             59             20257.113    
     80000   405.50432      11288524       516.12828      96             63             20257.113    
     85000   407.64145      11288522       518.84844      98             64             20257.113    
     90000   409.47138      11288513       521.17758      101            66             20257.113    
     95000   411.58036      11288513       523.86191      104            68             20257.113    
    100000   419.55432      11288512       534.01121      112            69             20257.113    
Loop time of 39.6906 on 8 procs for 100000 steps with 609 atoms

Performance: 217.684 ns/day, 0.110 hours/ns, 2519.491 timesteps/s, 1.534 Matom-step/s
87.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.8511     | 9.3458     | 11.817     |  44.0 | 23.55
Bond    | 0.0034314  | 0.0037492  | 0.0040031  |   0.3 |  0.01
Kspace  | 17.799     | 19.92      | 21.513     |  30.4 | 50.19
Neigh   | 0.042138   | 0.046244   | 0.049389   |   1.2 |  0.12
Comm    | 7.7792     | 8.0214     | 8.2079     |   5.4 | 20.21
Output  | 0.00049158 | 0.00053519 | 0.00071853 |   0.0 |  0.00
Modify  | 1.4509     | 1.454      | 1.4577     |   0.2 |  3.66
Other   |            | 0.8987     |            |       |  2.26

Nlocal:         76.125 ave          82 max          67 min
Histogram: 1 0 0 0 0 2 2 1 1 1
Nghost:         2079.5 ave        2140 max        2022 min
Histogram: 1 0 1 1 1 2 0 1 0 1
Neighs:        12872.1 ave       14543 max       11510 min
Histogram: 3 0 1 0 0 1 1 0 0 2

Total # of neighbors = 102977
Ave neighs/atom = 169.09195
Ave special neighs/atom = 0
Neighbor list builds = 1297
Dangerous builds = 0

print "[INFO] Production Phase"
[INFO] Production Phase
run 100000
WARNING: No fixes with time integration, atoms won't move (src/verlet.cpp:60)
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.2366131
  grid = 15 15 15
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0015305876
  estimated relative force accuracy = 4.609319e-06
  using double precision FFTW3
  3d grid and FFT values/proc = 2744 512
Generated 21 of 21 mixed pair_coeff terms from geometric mixing rule
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:651)
Per MPI rank memory allocation (min/avg/max) = 6.659 | 6.666 | 6.682 Mbytes
   Step          Temp          PotEng         KinEng         v_n_h2        v_n_ch4         Volume    
    100000   294.6541       11288512       534.01121      112            69             20257.113    
    105000   296.62797      11288514       537.58852      114            71             20257.113    
    110000   300.08747      11288509       543.85827      119            70             20257.113    
    115000   298.79736      11288494       541.52016      117            69             20257.113    
    120000   301.96898      11288505       547.2682       120            71             20257.113    
    125000   303.15829      11288504       549.42362      123            70             20257.113    
    130000   303.33472      11288510       549.74338      123            71             20257.113    
    135000   304.38721      11288519       551.65084      124            73             20257.113    
    140000   304.75011      11288515       552.30853      125            74             20257.113    
    145000   306.89232      11288517       556.19094      126            77             20257.113    
    150000   308.40676      11288519       558.9356       128            78             20257.113    
    155000   308.35268      11288519       558.83758      129            77             20257.113    
    160000   310.41891      11288520       562.58228      132            79             20257.113    
    165000   312.91083      11288520       567.09847      136            78             20257.113    
    170000   312.06124      11288507       565.55873      134            78             20257.113    
    175000   314.06762      11288510       569.19495      138            78             20257.113    
    180000   315.47582      11288511       571.74709      141            78             20257.113    
    185000   315.47582      11288511       571.74709      141            78             20257.113    
    190000   315.52272      11288510       571.83208      142            79             20257.113    
    195000   316.74283      11288520       574.04333      142            81             20257.113    
    200000   318.08274      11288522       576.47169      144            81             20257.113    
Loop time of 44.9831 on 8 procs for 100000 steps with 653 atoms

Performance: 192.072 ns/day, 0.125 hours/ns, 2223.058 timesteps/s, 1.452 Matom-step/s
88.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 12.065     | 14.137     | 17.011     |  44.1 | 31.43
Bond    | 0.0034635  | 0.0038897  | 0.0048094  |   0.6 |  0.01
Kspace  | 17.511     | 20.15      | 22.328     |  37.1 | 44.79
Neigh   | 0.061114   | 0.064107   | 0.06737    |   0.9 |  0.14
Comm    | 7.8473     | 7.982      | 8.1499     |   3.8 | 17.74
Output  | 0.00045483 | 0.00050322 | 0.00065494 |   0.0 |  0.00
Modify  | 1.7781     | 1.7828     | 1.7867     |   0.2 |  3.96
Other   |            | 0.8633     |            |       |  1.92

Nlocal:         81.625 ave          85 max          76 min
Histogram: 1 0 1 0 0 2 0 0 3 1
Nghost:           2236 ave        2275 max        2197 min
Histogram: 1 1 0 1 2 0 1 0 0 2
Neighs:        14839.2 ave       16709 max       12981 min
Histogram: 2 0 1 0 2 0 0 1 0 2

Total # of neighbors = 118714
Ave neighs/atom = 181.79786
Ave special neighs/atom = 0
Neighbor list builds = 1300
Dangerous builds = 0

print "[INFO] Final H2: ${n_h2}"
[INFO] Final H2: 144
print "[INFO] Final CH4: ${n_ch4}"
[INFO] Final CH4: 81
print "[INFO] Completed"
[INFO] Completed
Total wall time: 0:01:24
